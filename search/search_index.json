{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Getting Started","text":""},{"location":"#getting-started","title":"Getting Started","text":"<p>Welcome to the DevOps Images documentation! This project provides production-ready, multi-architecture container images packed with essential DevOps tools for cloud infrastructure, automation, and platform engineering.</p>"},{"location":"#what-are-these-images","title":"What Are These Images?","text":"<p>DevOps Images are pre-built Docker containers that include a comprehensive toolkit for:</p> <ul> <li>Infrastructure as Code (Terraform, Terragrunt, Packer)</li> <li>Kubernetes Operations (kubectl, Helm, k9s)</li> <li>Configuration Management (Ansible, pre-commit)</li> <li>Security Scanning (Trivy)</li> <li>Cloud Provider CLIs (AWS CLI, gcloud)</li> <li>AI Code Assistants (Claude, Codex, Copilot, Gemini)</li> <li>Database Clients (mongosh, psql, mysql)</li> <li>Development Tools (Python, Node.js, Git, GitHub CLI)</li> </ul> <p>Built on Rocky Linux 9 with support for both AMD64 and ARM64 architectures, these images eliminate the need to install dozens of tools on your local machine or CI/CD runners.</p>"},{"location":"#choose-the-right-image","title":"Choose the Right Image","text":"Image Best For Cloud Tools Size all-devops Multi-cloud teams, platform engineering, one-stop solution AWS CLI + gcloud + Session Manager Largest aws-devops AWS-focused DevOps, smaller footprint than all-devops AWS CLI + Session Manager Medium gcp-devops GCP-focused DevOps, smaller footprint than all-devops gcloud + GKE tools Medium"},{"location":"#common-base-tools-all-images","title":"Common Base Tools (All Images)","text":"<p>Infrastructure as Code:</p> <ul> <li>Terraform with tfswitch for version management</li> <li>Terragrunt for DRY configurations</li> <li>TFLint for linting</li> <li>Packer for image building</li> </ul> <p>Kubernetes &amp; Containers:</p> <ul> <li>kubectl (latest stable)</li> <li>Helm 3</li> <li>k9s terminal UI</li> </ul> <p>Configuration &amp; Automation:</p> <ul> <li>Ansible &amp; ansible-lint</li> <li>pre-commit hooks</li> <li>Task (go-task) runner</li> </ul> <p>Security &amp; Quality:</p> <ul> <li>Trivy vulnerability scanner</li> </ul> <p>Development:</p> <ul> <li>Python 3.12 with pip</li> <li>Node.js LTS with npm</li> <li>Git &amp; GitHub CLI</li> <li>ghorg (GitHub org cloner)</li> </ul> <p>AI Code Assistants:</p> <ul> <li>Claude CLI</li> <li>OpenAI Codex CLI</li> <li>GitHub Copilot CLI</li> <li>Google Gemini CLI</li> </ul> <p>Database Clients:</p> <ul> <li>MongoDB Shell (mongosh) v6.0</li> <li>PostgreSQL (psql) v17</li> <li>MySQL client</li> </ul> <p>Network &amp; Diagnostics:</p> <ul> <li>dig, nslookup, ncat, telnet</li> <li>curl, wget</li> <li>jq JSON processor</li> </ul> <p>Shells:</p> <ul> <li>Zsh (default, with Oh My Zsh)</li> <li>Bash</li> <li>Fish</li> </ul>"},{"location":"#why-use-these-images","title":"Why Use These Images?","text":""},{"location":"#for-individual-developers","title":"For Individual Developers","text":"<p>\u2713 No local tool installation - Everything pre-configured and ready to use \u2713 Consistent environment - Same tools and versions across your team \u2713 Clean host system - Keep development tools isolated in containers \u2713 Multi-version testing - Test against different tool versions easily \u2713 Cross-platform - Works on AMD64 Linux, macOS, and Apple Silicon</p>"},{"location":"#for-teams","title":"For Teams","text":"<p>\u2713 Standardised toolchain - Everyone uses identical tool versions \u2713 Fast onboarding - New team members productive in minutes \u2713 Multi-cloud ready - Single image for AWS, GCP, and Kubernetes \u2713 Version controlled - Pin to specific image tags for reproducibility</p>"},{"location":"#for-cicd-pipelines","title":"For CI/CD Pipelines","text":"<p>\u2713 Pre-built and cached - Faster pipeline execution \u2713 Immutable tags - Reproducible builds with version pinning \u2713 Multi-arch support - Works with ARM and x86 runners \u2713 Regular updates - Weekly automated builds with latest tools</p>"},{"location":"#available-registries","title":"Available Registries","text":"<p>Images are published to three container registries for redundancy and global availability:</p> Registry Image Path Best For GitHub Container Registry (GHCR) <code>ghcr.io/jinalshah/devops/images/&lt;image&gt;:&lt;tag&gt;</code> Primary, recommended for most users GitLab Container Registry <code>registry.gitlab.com/jinal-shah/devops/images/&lt;image&gt;:&lt;tag&gt;</code> GitLab CI/CD pipelines Docker Hub <code>js01/&lt;image&gt;:&lt;tag&gt;</code> Alternative, rate-limit considerations <p>Replace <code>&lt;image&gt;</code> with <code>all-devops</code>, <code>aws-devops</code>, or <code>gcp-devops</code>.</p>"},{"location":"#quick-start-guide","title":"Quick Start Guide","text":""},{"location":"#step-1-pull-an-image","title":"Step 1: Pull an Image","text":"<p>Choose your preferred registry and pull the image:</p> <pre><code># From GHCR (recommended)\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# From GitLab\ndocker pull registry.gitlab.com/jinal-shah/devops/images/all-devops:latest\n\n# From Docker Hub\ndocker pull js01/all-devops:latest\n</code></pre>"},{"location":"#step-2-run-the-container","title":"Step 2: Run the Container","text":"<p>Simple interactive session:</p> <pre><code>docker run -it --rm ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>This drops you into a Zsh shell with all tools available.</p> <p>Production-ready setup with volume mounts:</p> <pre><code>docker run -it --name devops-work \\\n  -v $PWD:/srv \\\n  -v ~/.ssh:/root/.ssh \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.claude:/root/.claude \\\n  -v ~/.codex:/root/.codex \\\n  -v ~/.copilot:/root/.copilot \\\n  -v ~/.gemini:/root/.gemini \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>Volume mount explanations:</p> <ul> <li><code>-v $PWD:/srv</code> - Mount current directory as <code>/srv</code> for accessing your project files</li> <li><code>-v ~/.ssh:/root/.ssh</code> - Mount SSH keys for Git and remote access</li> <li><code>-v ~/.aws:/root/.aws</code> - Mount AWS credentials (for AWS images)</li> <li><code>-v ~/.config/gcloud:/root/.config/gcloud</code> - Mount GCP credentials (for GCP images)</li> <li>AI CLI mounts - Required for authenticated AI assistant access</li> </ul>"},{"location":"#step-3-verify-tools","title":"Step 3: Verify Tools","text":"<p>Once inside the container, verify tools are working:</p> <pre><code># Infrastructure tools\nterraform version\nkubectl version --client\nansible --version\n\n# Cloud CLIs (if using all-devops or cloud-specific images)\naws --version      # AWS images\ngcloud --version   # GCP images\n\n# Security and quality\ntrivy --version\n\n# Development tools\npython3 --version\nnode --version\ngit --version\n</code></pre>"},{"location":"#image-tags-and-versioning","title":"Image Tags and Versioning","text":""},{"location":"#tag-types","title":"Tag Types","text":"<p>The CI pipeline publishes multiple tag types:</p> Tag Type Example Description Use For Version <code>1.0.abc1234</code> Immutable, based on Git commit Production, CI/CD Arch-specific <code>1.0.abc1234-amd64</code> Single architecture Debugging arch issues Latest <code>latest</code> Points to latest main build Development only"},{"location":"#multi-architecture-support","title":"Multi-Architecture Support","text":"<p>All images support both architectures:</p> <ul> <li>linux/amd64 (x86_64) - Traditional Intel/AMD processors</li> <li>linux/arm64 (aarch64) - ARM processors, Apple Silicon (M1/M2/M3)</li> </ul> <p>Docker automatically pulls the correct architecture for your platform.</p>"},{"location":"#best-practices","title":"Best Practices","text":"<p>For CI/CD and Production:</p> <pre><code># \u2705 Good - immutable version tag\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre> <p>For Local Development:</p> <pre><code># \u2705 Acceptable - always get latest tools\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>Avoid in Production:</p> <pre><code># \u274c Avoid - tag changes over time, not reproducible\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"#common-use-cases","title":"Common Use Cases","text":""},{"location":"#use-case-1-interactive-development","title":"Use Case 1: Interactive Development","text":"<p>Perfect for working on infrastructure code without installing tools locally:</p> <pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre> <p>Now you can run <code>terraform</code>, <code>ansible</code>, <code>kubectl</code> commands on your project files.</p>"},{"location":"#use-case-2-cicd-pipeline","title":"Use Case 2: CI/CD Pipeline","text":"<p>Use as a base container in GitHub Actions:</p> <pre><code>jobs:\n  deploy:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    steps:\n      - uses: actions/checkout@v4\n      - run: terraform init\n      - run: terraform apply -auto-approve\n</code></pre>"},{"location":"#use-case-3-one-off-commands","title":"Use Case 3: One-off Commands","text":"<p>Run tools without entering the container:</p> <pre><code># Format Terraform files\ndocker run --rm -v $PWD:/srv \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform fmt -recursive /srv\n\n# Scan for vulnerabilities\ndocker run --rm \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy image nginx:latest\n\n# Run Ansible playbook\ndocker run --rm -v $PWD:/srv \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-playbook /srv/playbook.yml\n</code></pre>"},{"location":"#use-case-4-team-standardization","title":"Use Case 4: Team Standardization","text":"<p>Create a team-specific wrapper script:</p> <pre><code>#!/bin/bash\n# ~/bin/devops\n\ndocker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.ssh:/root/.ssh \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234 \\\n  \"$@\"\n</code></pre> <p>Now team members can run: <code>devops terraform plan</code></p>"},{"location":"#next-steps","title":"Next Steps","text":"<p>Choose your path based on what you want to accomplish:</p>"},{"location":"#i-want-to-use-pre-built-images","title":"I want to use pre-built images","text":"<p>\u2192 Using the Images - Pull, run, and integrate with workflows</p> <ul> <li>All DevOps Image - Multi-cloud usage</li> <li>AWS DevOps Image - AWS-specific usage</li> <li>GCP DevOps Image - GCP-specific usage</li> </ul>"},{"location":"#i-want-to-build-images-locally","title":"I want to build images locally","text":"<p>\u2192 Building Images - Build, customise, and test locally</p> <ul> <li>Building All DevOps</li> <li>Building AWS DevOps</li> <li>Building GCP DevOps</li> <li>Multi-platform Builds - Advanced build workflows</li> </ul>"},{"location":"#i-want-to-learn-about-the-tools","title":"I want to learn about the tools","text":"<p>\u2192 Tool Basics - Comprehensive tool reference</p> <ul> <li>Detailed descriptions of every tool</li> <li>Basic to advanced usage examples</li> <li>Common use cases and patterns</li> </ul>"},{"location":"#im-having-issues","title":"I'm having issues","text":"<p>\u2192 Troubleshooting - Common problems and solutions</p> <ul> <li>Pull and authentication issues</li> <li>Container runtime problems</li> <li>Build failures</li> <li>Platform-specific issues</li> </ul>"},{"location":"#documentation-structure","title":"Documentation Structure","text":"<pre><code>Getting Started (you are here)\n\u251c\u2500\u2500 Using Images\n\u2502   \u251c\u2500\u2500 Overview and common patterns\n\u2502   \u251c\u2500\u2500 All DevOps image\n\u2502   \u251c\u2500\u2500 AWS DevOps image\n\u2502   \u2514\u2500\u2500 GCP DevOps image\n\u251c\u2500\u2500 Building Images\n\u2502   \u251c\u2500\u2500 Local builds\n\u2502   \u251c\u2500\u2500 Build customization\n\u2502   \u251c\u2500\u2500 Multi-platform builds\n\u2502   \u2514\u2500\u2500 Image-specific builds\n\u251c\u2500\u2500 Tool Basics\n\u2502   \u2514\u2500\u2500 Comprehensive tool reference\n\u2514\u2500\u2500 Troubleshooting\n    \u2514\u2500\u2500 Common issues and solutions\n</code></pre>"},{"location":"#getting-help","title":"Getting Help","text":"<ul> <li>Documentation issues: Open an issue on GitHub</li> <li>Tool-specific help: Refer to the Tool Basics section</li> <li>Build problems: Check the Troubleshooting guide</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>GitHub Repository</li> <li>GitHub Container Registry</li> <li>CI/CD Workflows</li> </ul>"},{"location":"choosing-an-image/","title":"Choosing the Right Image","text":""},{"location":"choosing-an-image/#choosing-the-right-image","title":"Choosing the Right Image","text":"<p>Use this guide to select the best DevOps image for your needs.</p>"},{"location":"choosing-an-image/#decision-tree","title":"Decision Tree","text":"<pre><code>flowchart TD\n    START[Which image&lt;br/&gt;should I use?]\n\n    START --&gt; Q1{Working with&lt;br/&gt;multiple clouds?}\n\n    Q1 --&gt;|Yes| ALL[\u2705 Use all-devops&lt;br/&gt;\u2713 AWS + GCP tools&lt;br/&gt;\u2713 All features&lt;br/&gt;\u26a0\ufe0f Larger size ~3.2GB]\n\n    Q1 --&gt;|No| Q2{Which cloud&lt;br/&gt;provider?}\n\n    Q2 --&gt;|AWS| AWS_Q{Need AWS&lt;br/&gt;Session Manager?}\n    Q2 --&gt;|GCP| GCP[\u2705 Use gcp-devops&lt;br/&gt;\u2713 gcloud tools&lt;br/&gt;\u2713 GKE ready&lt;br/&gt;\u2713 Smaller ~2.9GB]\n    Q2 --&gt;|Neither/Local| BASE_Q{Need cloud&lt;br/&gt;CLI later?}\n\n    AWS_Q --&gt;|Yes| AWS[\u2705 Use aws-devops&lt;br/&gt;\u2713 AWS CLI v2&lt;br/&gt;\u2713 Session Manager&lt;br/&gt;\u2713 CloudFormation tools&lt;br/&gt;\u2713 ~2.8GB]\n    AWS_Q --&gt;|No| BASE_Q\n\n    BASE_Q --&gt;|Maybe| ALL\n    BASE_Q --&gt;|No| CONSIDER[Consider building&lt;br/&gt;custom base image&lt;br/&gt;without cloud tools]\n\n    ALL --&gt; SIZE_Q{Concerned about&lt;br/&gt;image size?}\n    AWS --&gt; SIZE_Q\n    GCP --&gt; SIZE_Q\n\n    SIZE_Q --&gt;|Yes| OPT[See Build Images &gt;&lt;br/&gt;Optimization Guide]\n    SIZE_Q --&gt;|No| DONE[\ud83c\udfaf You're all set!&lt;br/&gt;See Use Images guide]\n\n    style START fill:#4A90E2,color:#fff\n    style ALL fill:#FF6B6B,color:#fff\n    style AWS fill:#FF9F43,color:#fff\n    style GCP fill:#5F8D4E,color:#fff\n    style DONE fill:#48C774,color:#fff</code></pre>"},{"location":"choosing-an-image/#quick-comparison","title":"Quick Comparison","text":"Feature all-devops aws-devops gcp-devops Base Tools \u2705 \u2705 \u2705 Terraform &amp; IaC \u2705 \u2705 \u2705 Kubernetes \u2705 \u2705 \u2705 AI CLI Tools \u2705 \u2705 \u2705 AWS CLI \u2705 \u2705 \u274c gcloud \u2705 \u274c \u2705 Session Manager \u2705 \u2705 \u274c docker-credential-gcr \u2705 \u274c \u2705 Size (approx) ~3.2GB ~2.8GB ~2.9GB Best For Multi-cloud teams AWS-first teams GCP-first teams"},{"location":"choosing-an-image/#use-case-scenarios","title":"Use Case Scenarios","text":""},{"location":"choosing-an-image/#solo-developer-local-development","title":"Solo Developer - Local Development","text":"<p>Recommendation: Start with all-devops</p> <ul> <li>\u2705 Maximum flexibility for experimentation</li> <li>\u2705 Try both AWS and GCP without switching images</li> <li>\u2705 All AI CLI tools for productivity</li> <li>\u26a0\ufe0f  Slightly larger, but comprehensive</li> </ul> <pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"choosing-an-image/#team-standardised-aws-environment","title":"Team - Standardised AWS Environment","text":"<p>Recommendation: aws-devops</p> <ul> <li>\u2705 Smaller image for faster CI/CD pulls</li> <li>\u2705 AWS-specific tools (Session Manager for EC2)</li> <li>\u2705 No unnecessary GCP tools</li> <li>\u2705 Team consistency</li> </ul> <pre><code>docker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre>"},{"location":"choosing-an-image/#team-google-cloud-platform","title":"Team - Google Cloud Platform","text":"<p>Recommendation: gcp-devops</p> <ul> <li>\u2705 GCP-optimised with gcloud</li> <li>\u2705 GCR authentication built-in</li> <li>\u2705 Smaller than all-devops</li> <li>\u2705 GKE-ready</li> </ul> <pre><code>docker pull ghcr.io/jinalshah/devops/images/gcp-devops:latest\n</code></pre>"},{"location":"choosing-an-image/#cicd-pipeline-multi-cloud","title":"CI/CD Pipeline - Multi-Cloud","text":"<p>Recommendation: all-devops with version pinning</p> <ul> <li>\u2705 One image for all deployment targets</li> <li>\u2705 Consistent tooling across pipelines</li> <li>\u2705 Version pinning for reproducibility</li> <li>\ud83c\udfaf Use immutable tags</li> </ul> <pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre>"},{"location":"choosing-an-image/#security-conscious-team","title":"Security-Conscious Team","text":"<p>Recommendation: Start with aws-devops or gcp-devops, scan with Trivy</p> <ul> <li>\u2705 Smaller attack surface (fewer tools)</li> <li>\u2705 Trivy included for vulnerability scanning</li> <li>\u2705 Pin specific versions in production</li> <li>\ud83d\udd12 Regular security updates</li> </ul> <pre><code># Pull and scan\ndocker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\ndocker run --rm \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  trivy image ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre>"},{"location":"choosing-an-image/#size-vs-features-trade-off","title":"Size vs Features Trade-off","text":""},{"location":"choosing-an-image/#whats-in-each-image","title":"What's in Each Image?","text":"<pre><code>pie title all-devops Size Breakdown (~3.2GB)\n    \"Rocky Linux Base\" : 500\n    \"System Packages\" : 800\n    \"Python + Packages\" : 600\n    \"Cloud CLIs (AWS + GCP)\" : 900\n    \"IaC Tools\" : 300\n    \"Other Tools\" : 100</code></pre>"},{"location":"choosing-an-image/#size-optimisation-strategies","title":"Size Optimisation Strategies","text":"<p>Reduce Image Size</p> <p>If size is a concern:</p> <ol> <li>Use cloud-specific images - Save ~300-400MB by using aws-devops or gcp-devops instead of all-devops</li> <li>Pin versions - Use immutable tags for Docker layer caching in CI/CD</li> <li>Build custom - Remove tools you don't need (see Customisation Guide)</li> <li>Multi-stage builds - Copy only what you need into final stage</li> </ol>"},{"location":"choosing-an-image/#feature-comparison-matrix","title":"Feature Comparison Matrix","text":""},{"location":"choosing-an-image/#infrastructure-as-code-tools","title":"Infrastructure as Code Tools","text":"Tool all-devops aws-devops gcp-devops Notes Terraform \u2705 \u2705 \u2705 Multi-version via tfswitch Terragrunt \u2705 \u2705 \u2705 Latest stable TFLint \u2705 \u2705 \u2705 Linting and validation Packer \u2705 \u2705 \u2705 Image building"},{"location":"choosing-an-image/#kubernetes-tools","title":"Kubernetes Tools","text":"Tool all-devops aws-devops gcp-devops Notes kubectl \u2705 \u2705 \u2705 Latest stable Helm 3 \u2705 \u2705 \u2705 Package manager k9s \u2705 \u2705 \u2705 Terminal UI"},{"location":"choosing-an-image/#cloud-provider-tools","title":"Cloud Provider Tools","text":"Tool all-devops aws-devops gcp-devops Notes AWS CLI v2 \u2705 \u2705 \u274c AWS service management Session Manager Plugin \u2705 \u2705 \u274c EC2 instance access gcloud \u2705 \u274c \u2705 GCP service management docker-credential-gcr \u2705 \u274c \u2705 GCR authentication"},{"location":"choosing-an-image/#ai-cli-tools","title":"AI CLI Tools","text":"Tool all-devops aws-devops gcp-devops Notes Claude CLI \u2705 \u2705 \u2705 Code review, architecture Codex CLI \u2705 \u2705 \u2705 Code generation Copilot CLI \u2705 \u2705 \u2705 GitHub integration Gemini CLI \u2705 \u2705 \u2705 Multi-modal, GCP-aware"},{"location":"choosing-an-image/#configuration-management","title":"Configuration Management","text":"Tool all-devops aws-devops gcp-devops Notes Ansible \u2705 \u2705 \u2705 Latest stable ansible-lint \u2705 \u2705 \u2705 Playbook validation pre-commit \u2705 \u2705 \u2705 Git hook framework Task \u2705 \u2705 \u2705 Modern task runner"},{"location":"choosing-an-image/#still-not-sure","title":"Still Not Sure?","text":"<p>Need Help Deciding?</p> <ul> <li>Starting fresh? \u2192 Use all-devops for maximum flexibility</li> <li>Existing AWS infrastructure? \u2192 Use aws-devops for optimal size</li> <li>Using GKE/Cloud Run? \u2192 Use gcp-devops for GCP integration</li> <li>CI/CD with multi-cloud deployments? \u2192 Use all-devops with version pinning</li> <li>Want to customise? \u2192 Build your own based on any variant (guide)</li> </ul>"},{"location":"choosing-an-image/#registry-choice","title":"Registry Choice","text":"<p>All images are available in three registries:</p> GitHub Container Registry (Recommended)GitLab Container RegistryDocker Hub <pre><code>ghcr.io/jinalshah/devops/images/{image-name}:latest\n</code></pre> <p>Why GHCR?</p> <ul> <li>\u2705 No rate limits for public images</li> <li>\u2705 Best availability and uptime</li> <li>\u2705 Integrated with GitHub releases</li> <li>\u2705 Fast global CDN</li> </ul> <pre><code>registry.gitlab.com/jinal-shah/devops/images/{image-name}:latest\n</code></pre> <p>Why GitLab?</p> <ul> <li>\u2705 Native GitLab CI integration</li> <li>\u2705 Good for GitLab-first organisations</li> <li>\u2705 Private runner support</li> </ul> <pre><code>js01/{image-name}:latest\n</code></pre> <p>Why Docker Hub?</p> <ul> <li>\u2705 Familiar to most developers</li> <li>\u26a0\ufe0f  Rate limits apply (100 pulls/6h for anonymous)</li> <li>\ud83d\udca1 Best for authenticated users with Pro/Team accounts</li> </ul>"},{"location":"choosing-an-image/#next-steps","title":"Next Steps","text":"<p>Once you've chosen your image:</p> <ol> <li>Get Started: Follow the Quick Start Guide</li> <li>Pull the Image: See Use Images for pull commands</li> <li>Set Up Authentication: Configure credentials and volume mounts</li> <li>Explore Workflows: Check out real-world examples</li> <li>Customise: Learn how to build custom images</li> </ol> <p>Quick Links:</p> <ul> <li>Architecture Overview</li> <li>Tool Basics</li> <li>Troubleshooting</li> </ul>"},{"location":"quick-start/","title":"Quick Start Guide","text":""},{"location":"quick-start/#quick-start-guide","title":"Quick Start Guide","text":"<p>Get up and running with DevOps Images in 5 minutes.</p>"},{"location":"quick-start/#5-minute-quickstart","title":"5-Minute Quickstart","text":"<ul> <li> Step 1: Choose your image</li> <li> Step 2: Pull the image</li> <li> Step 3: Run interactively</li> <li> Step 4: Test a tool</li> <li> Step 5: Set up for real work</li> </ul>"},{"location":"quick-start/#step-1-choose-your-image","title":"Step 1: Choose Your Image","text":"<p>Which image do I need?</p> <p>Quick decision:</p> <ul> <li>Multi-cloud or exploring? \u2192 <code>all-devops</code></li> <li>AWS only? \u2192 <code>aws-devops</code></li> <li>GCP only? \u2192 <code>gcp-devops</code></li> </ul> <p>Need help deciding? See the complete decision guide.</p>"},{"location":"quick-start/#step-2-pull-the-image","title":"Step 2: Pull the Image","text":"all-devops (Recommended)aws-devopsgcp-devops <pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>Contains: AWS + GCP + all base tools (~3.2 GB)</p> <pre><code>docker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre> <p>Contains: AWS + all base tools (~2.8 GB)</p> <pre><code>docker pull ghcr.io/jinalshah/devops/images/gcp-devops:latest\n</code></pre> <p>Contains: GCP + all base tools (~2.9 GB)</p> <p>First pull takes time</p> <p>Initial pull downloads ~3 GB. Subsequent runs are instant. Grab a coffee! \u2615</p>"},{"location":"quick-start/#step-3-run-interactively","title":"Step 3: Run Interactively","text":"<pre><code>docker run -it --rm ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>You should see a <code>zsh</code> prompt with Oh My Zsh configured:</p> <pre><code>\u279c /\n</code></pre> <p>You're in!</p> <p>You're now inside the container with access to all tools.</p>"},{"location":"quick-start/#step-4-test-a-tool","title":"Step 4: Test a Tool","text":"<p>Try a few commands to verify everything works:</p> <pre><code># Check Terraform\nterraform version\n\n# Check kubectl\nkubectl version --client\n\n# Check AWS CLI (all-devops or aws-devops)\naws --version\n\n# Check gcloud (all-devops or gcp-devops)\ngcloud version\n\n# Check AI CLI\nclaude --version\n\n# Exit when done\nexit\n</code></pre> <p>Expected Output</p> <p>You should see version information for each tool, indicating they're installed and working.</p>"},{"location":"quick-start/#step-5-set-up-for-real-work","title":"Step 5: Set Up for Real Work","text":"<p>Now run with your project files and credentials mounted:</p> <pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.ssh:/root/.ssh \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>Ready to work!</p> <p>You can now access your project files in <code>/workspace</code> and use cloud CLIs with your credentials.</p>"},{"location":"quick-start/#what-you-get","title":"What You Get","text":""},{"location":"quick-start/#all-images-include","title":"All Images Include","text":"<p>\u2705 Infrastructure as Code</p> <ul> <li>Terraform (multi-version)</li> <li>Terragrunt</li> <li>TFLint</li> <li>Packer</li> </ul> <p>\u2705 Kubernetes</p> <ul> <li>kubectl</li> <li>Helm 3</li> <li>k9s</li> </ul> <p>\u2705 Configuration &amp; Security</p> <ul> <li>Ansible + ansible-lint</li> <li>Trivy</li> <li>pre-commit</li> </ul> <p>\u2705 AI CLI Tools</p> <ul> <li>Claude CLI (Anthropic)</li> <li>Codex CLI (OpenAI)</li> <li>Copilot CLI (GitHub)</li> <li>Gemini CLI (Google)</li> </ul> <p>\u2705 Development</p> <ul> <li>Python 3.12</li> <li>Node.js LTS</li> <li>Git + GitHub CLI</li> <li>Database clients (mongosh, psql, mysql)</li> </ul> <p>\u2705 Shells &amp; Utils</p> <ul> <li>Zsh (default) with Oh My Zsh</li> <li>Bash, Fish</li> <li>jq, curl, wget, vim</li> </ul>"},{"location":"quick-start/#cloud-specific-tools","title":"Cloud-Specific Tools","text":"all-devopsaws-devopsgcp-devops <p>\u2705 AWS CLI v2 + Session Manager \u2705 gcloud + docker-credential-gcr \u2705 boto3, cfn-lint, s3cmd</p> <p>\u2705 AWS CLI v2 + Session Manager \u2705 boto3, cfn-lint, s3cmd \u274c No GCP tools</p> <p>\u2705 gcloud + docker-credential-gcr \u274c No AWS tools</p>"},{"location":"quick-start/#common-first-tasks","title":"Common First Tasks","text":""},{"location":"quick-start/#task-1-run-terraform","title":"Task 1: Run Terraform","text":"<pre><code># Create a simple test file\ncat &gt; main.tf &lt;&lt;'EOF'\nterraform {\n  required_version = \"&gt;= 1.0\"\n}\n\noutput \"hello\" {\n  value = \"Hello from DevOps Images!\"\n}\nEOF\n\n# Run Terraform\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"terraform init &amp;&amp; terraform apply -auto-approve\"\n</code></pre>"},{"location":"quick-start/#task-2-scan-for-vulnerabilities","title":"Task 2: Scan for Vulnerabilities","text":"<pre><code># Scan current directory\ndocker run --rm -v $PWD:/workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy fs /workspace\n</code></pre>"},{"location":"quick-start/#task-3-validate-kubernetes-manifests","title":"Task 3: Validate Kubernetes Manifests","text":"<pre><code># Assuming you have k8s manifests\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  kubectl apply --dry-run=client -f kubernetes/\n</code></pre>"},{"location":"quick-start/#task-4-use-ai-cli","title":"Task 4: Use AI CLI","text":"<pre><code># First-time setup: authenticate\ndocker run -it --rm \\\n  -v ~/.claude:/root/.claude \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude auth login\n\n# Use Claude for code review\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this Terraform file for security issues\" \\\n  --file main.tf\n</code></pre>"},{"location":"quick-start/#next-steps-by-use-case","title":"Next Steps by Use Case","text":""},{"location":"quick-start/#for-local-development","title":"For Local Development","text":"<ol> <li>Mount your project: Use <code>-v $PWD:/workspace</code></li> <li>Mount credentials: Add <code>-v ~/.aws:/root/.aws</code> and <code>-v ~/.config/gcloud:/root/.config/gcloud</code></li> <li>Named container: Use <code>--name devops-work</code> to easily restart</li> <li>Authentication: Set up cloud credentials and AI CLIs</li> </ol> <p>Full command: </p><pre><code>docker run -it --name devops-work \\\n  -v $PWD:/workspace \\\n  -v ~/.ssh:/root/.ssh \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p>"},{"location":"quick-start/#for-cicd","title":"For CI/CD","text":"<ol> <li>Pin versions: Use immutable tags like <code>1.0.abc1234</code></li> <li>Use secrets: Configure cloud credentials via CI secrets</li> <li>Cache images: Pre-pull during setup phase</li> <li>GHCR registry: Use <code>ghcr.io</code> for best performance</li> </ol> <p>Example (GitHub Actions): </p><pre><code>container:\n  image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre><p></p> <p>Learn more: CI/CD Integration</p>"},{"location":"quick-start/#for-multi-cloud-teams","title":"For Multi-Cloud Teams","text":"<ol> <li>Use all-devops: Maximum flexibility</li> <li>Workflows: Check multi-cloud patterns</li> <li>Authentication: Set up both AWS and GCP</li> <li>Organise: Use subdirectories for cloud-specific configs</li> </ol>"},{"location":"quick-start/#for-security-focused-teams","title":"For Security-Focused Teams","text":"<ol> <li>Scan everything: Use Trivy for containers and IaC</li> <li>Lint configs: TFLint for Terraform, ansible-lint for Ansible</li> <li>AI review: Use Claude for security audits</li> <li>Pin versions: Lock to specific image versions</li> <li>Scan images: Run <code>trivy image</code> on the DevOps Images themselves</li> </ol> <p>Learn more: Security workflows</p>"},{"location":"quick-start/#troubleshooting-first-run","title":"Troubleshooting First Run","text":"Docker: command not found <p>Problem: Docker is not installed</p> <p>Solution: Install Docker Desktop</p> <ul> <li>macOS</li> <li>Windows</li> <li>Linux</li> </ul> Cannot connect to Docker daemon <p>Problem: Docker daemon is not running</p> <p>Solution: Start Docker Desktop or Docker service</p> <pre><code># Linux\nsudo systemctl start docker\n\n# macOS/Windows\n# Start Docker Desktop application\n</code></pre> Permission denied while trying to connect <p>Problem: User doesn't have Docker permissions</p> <p>Solution: Add user to docker group (Linux)</p> <pre><code>sudo usermod -aG docker $USER\n# Log out and back in for changes to take effect\n</code></pre> Image pull is very slow <p>Problem: Large image size or slow internet</p> <p>Solutions:</p> <ol> <li>Use GHCR instead of Docker Hub (faster)</li> <li>Use smaller cloud-specific images</li> <li>Wait for initial pull (only happens once)</li> <li>Use a wired connection if possible</li> </ol> Tools returning 'command not found' <p>Problem: Wrong image or tool not included</p> <p>Solutions:</p> <ol> <li>Verify you pulled the correct image</li> <li>Check tool availability in image comparison</li> <li>For cloud CLIs, ensure you're using the right image variant</li> </ol>"},{"location":"quick-start/#quick-reference-card","title":"Quick Reference Card","text":""},{"location":"quick-start/#essential-commands","title":"Essential Commands","text":"<pre><code># Pull latest image\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Run interactively\ndocker run -it --rm ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Run with project mounted\ndocker run -it --rm \\\n  -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Run single command\ndocker run --rm \\\n  -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform plan\n\n# Check versions\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest terraform version\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest aws --version\n</code></pre>"},{"location":"quick-start/#common-volume-mounts","title":"Common Volume Mounts","text":"Mount Purpose <code>-v $PWD:/workspace</code> Project files <code>-v ~/.aws:/root/.aws</code> AWS credentials <code>-v ~/.config/gcloud:/root/.config/gcloud</code> GCP credentials <code>-v ~/.ssh:/root/.ssh</code> SSH keys <code>-v ~/.kube:/root/.kube</code> Kubernetes config <code>-v ~/.claude:/root/.claude</code> Claude AI credentials"},{"location":"quick-start/#useful-aliases","title":"Useful Aliases","text":"<p>Add to your <code>~/.bashrc</code> or <code>~/.zshrc</code>:</p> <pre><code># Quick access to DevOps container\nalias devops='docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.ssh:/root/.ssh \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest'\n\n# One-off commands\nalias devops-run='docker run --rm \\\n  -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest'\n\n# Example usage:\n# devops                          # Interactive shell\n# devops-run terraform plan       # Single command\n</code></pre>"},{"location":"quick-start/#whats-next","title":"What's Next?","text":"<p>\ud83c\udfaf Ready to go deeper?</p> <p>Learn the Tools:</p> <ul> <li>Tool Basics Guide - Comprehensive tool reference</li> <li>AI CLI Setup - Claude, Codex, Copilot, Gemini</li> </ul> <p>Set Up Credentials:</p> <ul> <li>Authentication Guide - AWS, GCP, SSH, AI CLIs</li> </ul> <p>See Real Examples:</p> <ul> <li>Workflows &amp; Patterns - CI/CD integrations</li> <li>AI-Assisted DevOps - AI workflow examples</li> <li>Multi-Tool Patterns - Combining tools</li> </ul> <p>Understand the Images:</p> <ul> <li>Architecture Overview - What's inside</li> <li>Choosing an Image - Detailed comparison</li> <li>Build &amp; Optimise - Custom builds</li> </ul> <p>Get Help:</p> <ul> <li>Troubleshooting - Common issues</li> <li>GitHub Issues - Report problems</li> </ul> <p>\ud83d\ude80 You're all set! Happy DevOps-ing!</p>"},{"location":"reading-the-docs/","title":"Reading the Documentation","text":""},{"location":"reading-the-docs/#reading-the-documentation","title":"Reading the Documentation","text":""},{"location":"reading-the-docs/#published-documentation","title":"Published Documentation","text":"<p>The docs site is available at:</p> <ul> <li>https://jinalshah.github.io/devops-images/</li> </ul>"},{"location":"reading-the-docs/#preview-locally","title":"Preview Locally","text":"<p>From the repository root:</p> <pre><code>python3 -m pip install --upgrade mkdocs-material\nmkdocs serve\n</code></pre> <p>Then open http://localhost:8000.</p>"},{"location":"reading-the-docs/#preview-using-docker","title":"Preview Using Docker","text":"<pre><code>docker run --rm -it -p 8000:8000 -v \"$PWD\":/srv ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -lc \"cd /srv &amp;&amp; mkdocs serve -a 0.0.0.0:8000\"\n</code></pre>"},{"location":"reading-the-docs/#docs-deployment","title":"Docs Deployment","text":"<p>Docs are deployed by <code>.github/workflows/docs.yml</code> when changes are pushed under <code>docs/**</code>.</p>"},{"location":"reading-the-docs/#common-issues","title":"Common Issues","text":"<ul> <li>Port in use: run <code>mkdocs serve -a 0.0.0.0:8080</code> and open port <code>8080</code></li> <li>Missing Python package: reinstall with <code>python3 -m pip install --upgrade mkdocs-material</code></li> <li>Stale assets: stop and restart <code>mkdocs serve</code></li> </ul>"},{"location":"architecture/","title":"Architecture &amp; Design","text":""},{"location":"architecture/#architecture-design","title":"Architecture &amp; Design","text":""},{"location":"architecture/#overview","title":"Overview","text":"<p>The DevOps Images are built on a layered architecture, starting from a common base layer and extending with cloud-specific tools. All images are multi-architecture, supporting both amd64 and arm64 platforms.</p>"},{"location":"architecture/#base-layer-architecture","title":"Base Layer Architecture","text":"<p>All images start from a common base layer built on Rocky Linux 9:</p> <pre><code>graph TB\n    subgraph \"Base Layer (All Images)\"\n        RL[Rocky Linux 9&lt;br/&gt;Multi-arch: amd64/arm64]\n\n        subgraph \"Infrastructure as Code\"\n            TF[Terraform + tfswitch]\n            TG[Terragrunt]\n            TFL[TFLint]\n            PK[Packer]\n        end\n\n        subgraph \"Kubernetes Tools\"\n            KB[kubectl]\n            HM[Helm 3]\n            K9[k9s]\n        end\n\n        subgraph \"Development\"\n            PY[Python 3.12]\n            ND[Node.js LTS]\n            GT[Git + GitHub CLI]\n        end\n\n        subgraph \"AI Assistants\"\n            CL[Claude CLI]\n            CD[Codex CLI]\n            CP[Copilot CLI]\n            GM[Gemini CLI]\n        end\n\n        subgraph \"Config &amp; Security\"\n            AN[Ansible + ansible-lint]\n            TR[Trivy]\n            PC[pre-commit]\n            TS[Task]\n        end\n\n        subgraph \"Database Clients\"\n            MG[mongosh v6.0]\n            PG[PostgreSQL 17]\n            MY[MySQL client]\n        end\n\n        subgraph \"Shells &amp; Utils\"\n            ZS[Zsh + Oh My Zsh]\n            BS[Bash]\n            FS[Fish]\n            JQ[jq, curl, wget]\n        end\n\n        RL --&gt; TF &amp; KB &amp; PY &amp; CL &amp; AN &amp; MG &amp; ZS\n    end\n\n    style RL fill:#4A90E2,color:#fff\n    style TF fill:#623CE4,color:#fff\n    style KB fill:#326CE5,color:#fff\n    style PY fill:#3776AB,color:#fff</code></pre>"},{"location":"architecture/#image-variants","title":"Image Variants","text":"<p>From the base layer, three specialized variants are built:</p> <pre><code>graph LR\n    BASE[Base Layer&lt;br/&gt;~2.5GB] --&gt; ALL[all-devops&lt;br/&gt;+AWS CLI&lt;br/&gt;+gcloud&lt;br/&gt;~3.2GB]\n    BASE --&gt; AWS[aws-devops&lt;br/&gt;+AWS CLI&lt;br/&gt;+Session Manager&lt;br/&gt;~2.8GB]\n    BASE --&gt; GCP[gcp-devops&lt;br/&gt;+gcloud&lt;br/&gt;+docker-credential-gcr&lt;br/&gt;~2.9GB]\n\n    style BASE fill:#4A90E2,color:#fff\n    style ALL fill:#FF6B6B,color:#fff\n    style AWS fill:#FF9F43,color:#fff\n    style GCP fill:#5F8D4E,color:#fff</code></pre>"},{"location":"architecture/#design-philosophy","title":"Design Philosophy","text":""},{"location":"architecture/#why-rocky-linux-9","title":"Why Rocky Linux 9?","text":"<ul> <li>Enterprise-grade stability: RHEL-compatible, production-ready</li> <li>Long-term support: Extended lifecycle for security updates</li> <li>Multi-architecture support: Native amd64 and arm64 builds</li> <li>Package ecosystem: Robust RPM ecosystem for DevOps tools</li> </ul>"},{"location":"architecture/#why-zsh-as-default","title":"Why Zsh as Default?","text":"<ul> <li>Developer productivity: Better autocomplete and syntax highlighting</li> <li>Oh My Zsh: Rich plugin ecosystem for cloud tools</li> <li>Compatibility: Bash scripts still work in Zsh</li> <li>Modern defaults: Better interactive experience</li> </ul>"},{"location":"architecture/#multi-architecture-strategy","title":"Multi-Architecture Strategy","text":"<p>All images are built for both amd64 (x86_64) and arm64 (aarch64) architectures, ensuring compatibility with:</p> <ul> <li>Intel/AMD machines: Traditional x86_64 servers and workstations</li> <li>Apple Silicon: M1/M2/M3 Mac devices (arm64 native)</li> <li>AWS Graviton: ARM-based EC2 instances</li> <li>Cloud development: Consistent experience across platforms</li> </ul>"},{"location":"architecture/#tool-categories","title":"Tool Categories","text":""},{"location":"architecture/#infrastructure-as-code-iac","title":"Infrastructure as Code (IaC)","text":"Tool Version Strategy Purpose Terraform tfswitch (multi-version) Infrastructure provisioning Terragrunt Latest stable Terraform wrapper for DRY configs TFLint Latest Terraform linting and validation Packer Latest Image building automation"},{"location":"architecture/#kubernetes-container-orchestration","title":"Kubernetes &amp; Container Orchestration","text":"Tool Version Purpose kubectl Latest stable Kubernetes cluster management Helm 3 Latest Kubernetes package manager k9s Latest Terminal UI for Kubernetes"},{"location":"architecture/#cloud-provider-clis","title":"Cloud Provider CLIs","text":"Tool Availability Purpose AWS CLI v2 all-devops, aws-devops AWS service management AWS Session Manager all-devops, aws-devops EC2 instance access gcloud all-devops, gcp-devops GCP service management docker-credential-gcr all-devops, gcp-devops GCR authentication"},{"location":"architecture/#configuration-management","title":"Configuration Management","text":"Tool Purpose Ansible Configuration automation ansible-lint Playbook validation pre-commit Git hook framework Task Modern task runner (Make alternative)"},{"location":"architecture/#security-scanning","title":"Security &amp; Scanning","text":"Tool Purpose Trivy Vulnerability scanning for containers and IaC"},{"location":"architecture/#ai-powered-development","title":"AI-Powered Development","text":"<p>All images include four AI CLI assistants for code generation, review, and troubleshooting:</p> Tool Provider Best For Claude CLI Anthropic Code review, architecture, long context Codex CLI OpenAI Code generation, quick snippets Copilot CLI GitHub IDE integration, GitHub workflows Gemini CLI Google GCP-specific tasks, multi-modal"},{"location":"architecture/#development-tools","title":"Development Tools","text":"Tool Version Purpose Python 3 3.12 Scripting, tooling Node.js LTS JavaScript tooling Git Latest Version control GitHub CLI (gh) Latest GitHub automation"},{"location":"architecture/#database-clients","title":"Database Clients","text":"Client Version Purpose mongosh v6.0 MongoDB shell psql PostgreSQL 17 PostgreSQL client mysql Latest MySQL client"},{"location":"architecture/#network-utilities","title":"Network &amp; Utilities","text":"<ul> <li>dig, nslookup - DNS troubleshooting</li> <li>ncat, telnet - Network connectivity testing</li> <li>curl, wget - HTTP clients</li> <li>jq - JSON processing</li> <li>tree - Directory visualisation</li> <li>vim, less - Text editors/pagers</li> </ul>"},{"location":"architecture/#build-process","title":"Build Process","text":""},{"location":"architecture/#multi-stage-build-strategy","title":"Multi-Stage Build Strategy","text":"<pre><code>graph TD\n    START[Dockerfile] --&gt; BASE_BUILD[Base Stage: Rocky Linux 9]\n    BASE_BUILD --&gt; TOOLS[Install Base Tools]\n    TOOLS --&gt; BRANCH{Target?}\n\n    BRANCH --&gt;|all-devops| AWS_TOOLS[Install AWS Tools]\n    BRANCH --&gt;|aws-devops| AWS_TOOLS\n    BRANCH --&gt;|gcp-devops| GCP_TOOLS[Install GCP Tools]\n\n    AWS_TOOLS --&gt; GCP_TOOLS_ALL{all-devops?}\n    GCP_TOOLS_ALL --&gt;|Yes| GCP_TOOLS\n    GCP_TOOLS_ALL --&gt;|No| FINAL_AWS[aws-devops Final]\n\n    GCP_TOOLS --&gt; FINAL_CHECK{all-devops?}\n    FINAL_CHECK --&gt;|Yes| FINAL_ALL[all-devops Final]\n    FINAL_CHECK --&gt;|No| FINAL_GCP[gcp-devops Final]\n\n    style START fill:#4A90E2,color:#fff\n    style FINAL_ALL fill:#FF6B6B,color:#fff\n    style FINAL_AWS fill:#FF9F43,color:#fff\n    style FINAL_GCP fill:#5F8D4E,color:#fff</code></pre>"},{"location":"architecture/#layer-optimization","title":"Layer Optimization","text":"<p>The build process is optimized for layer caching:</p> <ol> <li>Base OS packages - Changes rarely</li> <li>Binary downloads - Version updates occasionally</li> <li>Python/Node packages - Moderate update frequency</li> <li>Configuration files - Most frequently changed</li> </ol> <p>This ordering minimizes rebuild time and maximizes cache hits.</p>"},{"location":"architecture/#size-comparison","title":"Size Comparison","text":"<p>Approximate compressed image sizes:</p> Image Size Base + Cloud Tools Use Case base ~2.5GB Base only Single-cloud or custom all-devops ~3.2GB AWS + GCP Multi-cloud teams aws-devops ~2.8GB AWS only AWS-first teams gcp-devops ~2.9GB GCP only GCP-first teams <p>Size Optimisation</p> <p>If you only need a subset of tools, consider building a custom image. See Build Images &gt; Customisation for details.</p>"},{"location":"architecture/#next-steps","title":"Next Steps","text":"<ul> <li>Choose the right image for your use case</li> <li>Understand base layer tools in detail</li> <li>Explore cloud-specific additions</li> <li>Compare all variants side-by-side</li> </ul>"},{"location":"architecture/base-layer/","title":"Base Layer Architecture","text":""},{"location":"architecture/base-layer/#base-layer-architecture","title":"Base Layer Architecture","text":"<p>The base layer provides a comprehensive DevOps toolkit built on Rocky Linux 9, serving as the foundation for all image variants (all-devops, aws-devops, gcp-devops).</p>"},{"location":"architecture/base-layer/#design-philosophy","title":"Design Philosophy","text":""},{"location":"architecture/base-layer/#why-rocky-linux-9","title":"Why Rocky Linux 9?","text":"<p>Key Benefits</p> <ul> <li>Enterprise-grade stability: RHEL-compatible, production-ready</li> <li>Long-term support: 10-year lifecycle (until 2032)</li> <li>Multi-architecture: Native amd64 and arm64 support</li> <li>Package availability: Rich ecosystem via dnf/yum</li> <li>Security: SELinux support, regular security updates</li> </ul> <p>Alternatives considered:</p> Distro Why Not Chosen Ubuntu Shorter LTS cycles, less enterprise focus Alpine Musl libc compatibility issues with some tools Debian Older package versions in stable releases"},{"location":"architecture/base-layer/#why-zsh-as-default-shell","title":"Why Zsh as Default Shell?","text":"<ul> <li>Better UX: Enhanced tab completion, syntax highlighting</li> <li>Oh-My-Zsh ready: Easy customisation for users</li> <li>Backwards compatible: Bash scripts still work</li> <li>Interactive features: Better history search, glob patterns</li> </ul>"},{"location":"architecture/base-layer/#tool-categories","title":"Tool Categories","text":""},{"location":"architecture/base-layer/#infrastructure-as-code","title":"Infrastructure as Code","text":"Tool Version Purpose Size Impact Terraform Latest Multi-cloud IaC ~50 MB Terragrunt Latest Terraform wrapper for DRY configs ~20 MB TFLint Latest Terraform linter ~15 MB Packer Latest Image building ~40 MB tfswitch Latest Terraform version manager ~5 MB <p>Why these tools?</p> <ul> <li>Terraform: Industry-standard IaC for cloud resources</li> <li>Terragrunt: Essential for managing multi-environment Terraform</li> <li>TFLint: Catch errors before deployment</li> <li>Packer: Build consistent machine images across clouds</li> <li>tfswitch: Support multiple Terraform versions per project</li> </ul>"},{"location":"architecture/base-layer/#kubernetes-ecosystem","title":"Kubernetes Ecosystem","text":"Tool Version Purpose Size Impact kubectl Latest Kubernetes CLI ~45 MB Helm 3.x Package manager for Kubernetes ~15 MB k9s Latest Terminal UI for Kubernetes ~30 MB kustomize Latest Kubernetes configuration management ~20 MB <p>Why these tools?</p> <ul> <li>kubectl: Required for any Kubernetes interaction</li> <li>Helm 3: De facto standard for K8s package management</li> <li>k9s: Dramatically improves K8s troubleshooting speed</li> <li>kustomize: Configuration overlays without templating</li> </ul>"},{"location":"architecture/base-layer/#configuration-management","title":"Configuration Management","text":"Tool Version Purpose Size Impact Ansible Latest Agentless automation ~80 MB ansible-lint Latest Playbook validation ~15 MB <p>Why Ansible?</p> <ul> <li>Agentless: SSH-based, no agents to manage</li> <li>YAML-based: Easy to read and write</li> <li>Large module library: Pre-built modules for common tasks</li> <li>Cloud support: Native AWS, GCP, Azure modules</li> </ul>"},{"location":"architecture/base-layer/#security-scanning","title":"Security &amp; Scanning","text":"Tool Version Purpose Size Impact Trivy Latest Vulnerability scanner ~40 MB trivy-db Auto-updated Vulnerability database ~200 MB <p>Why Trivy?</p> <ul> <li>Multi-target: Scans containers, filesystems, IaC configs</li> <li>Fast: Parallel scanning, efficient database</li> <li>Comprehensive: CVEs, misconfigurations, secrets</li> <li>CI/CD friendly: Exit codes, JSON output</li> </ul>"},{"location":"architecture/base-layer/#development-tools","title":"Development Tools","text":"Python EcosystemNode.js EcosystemAI CLI Tools Tool Version Purpose Size Impact Python 3.12 Scripting, automation ~100 MB pip Latest Package manager Included pipx Latest Isolated CLI tools ~10 MB <p>Pre-installed Python packages: - <code>requests</code> - HTTP library - <code>pyyaml</code> - YAML parsing - <code>jinja2</code> - Templating</p> Tool Version Purpose Size Impact Node.js 20 LTS JavaScript runtime ~40 MB npm Latest Package manager Included npx Latest Package runner Included <p>Why Node.js 20 LTS? - Long-term support until 2026-04-30 - Required for AI CLI tools (claude, codex, copilot) - Modern JavaScript features</p> Tool Provider Purpose Size Impact claude Anthropic Code review, generation ~25 MB codex OpenAI Code completion ~20 MB copilot GitHub IDE integration ~30 MB gemini Google Multi-modal AI ~25 MB <p>Total AI tooling: ~100 MB (Node.js + CLIs)</p>"},{"location":"architecture/base-layer/#version-control-cicd","title":"Version Control &amp; CI/CD","text":"Tool Version Purpose Size Impact Git Latest Version control ~30 MB gh Latest GitHub CLI ~20 MB <p>Why gh CLI?</p> <ul> <li>GitHub integration: Issues, PRs, workflows from terminal</li> <li>Authentication: Manage tokens and SSH keys</li> <li>CI/CD: Trigger workflows, check status</li> </ul>"},{"location":"architecture/base-layer/#utilities","title":"Utilities","text":"Tool Version Purpose Size Impact jq Latest JSON processor ~2 MB yq Latest YAML processor ~5 MB Task Latest Task runner (Makefile alternative) ~10 MB vim Latest Text editor ~5 MB curl Latest HTTP client ~1 MB wget Latest File downloader ~1 MB unzip Latest Archive extraction ~1 MB tar Latest Archive management Included openssh-client Latest SSH operations ~10 MB"},{"location":"architecture/base-layer/#installation-order","title":"Installation Order","text":"<p>The tools are installed in a specific order to optimise Docker layer caching and minimise rebuild times:</p> <pre><code>graph TD\n    A[Rocky Linux 9 Base] --&gt; B[System Packages]\n    B --&gt; C[Python 3.12]\n    B --&gt; D[Node.js 20 LTS]\n    C --&gt; E[Python Packages]\n    D --&gt; F[AI CLI Tools]\n    B --&gt; G[IaC Tools]\n    B --&gt; H[Kubernetes Tools]\n    B --&gt; I[Security Tools]\n    B --&gt; J[Config Management]\n    G --&gt; K[Terraform Suite]\n    H --&gt; L[kubectl + Helm]\n    I --&gt; M[Trivy + DB]\n    J --&gt; N[Ansible + lint]\n    E --&gt; O[Final Base Layer]\n    F --&gt; O\n    K --&gt; O\n    L --&gt; O\n    M --&gt; O\n    N --&gt; O</code></pre>"},{"location":"architecture/base-layer/#layer-strategy","title":"Layer Strategy","text":"<ol> <li>System packages first: Rarely change, heavily cached</li> <li>Runtime environments: Python, Node.js (change quarterly)</li> <li>Core tools: Terraform, kubectl, etc. (change monthly)</li> <li>Language packages: pip/npm packages (change weekly)</li> <li>Final configuration: User setup, entrypoint</li> </ol> <p>Benefits: - Faster rebuilds (cached layers reused) - Smaller layer deltas (only changed tools rebuild) - Predictable build times</p>"},{"location":"architecture/base-layer/#size-breakdown","title":"Size Breakdown","text":"<p>Total base layer size: ~2.0 GB</p> <pre><code>pie title Base Layer Size Distribution\n    \"Rocky Linux Base\" : 500\n    \"IaC Tools (Terraform, Packer)\" : 125\n    \"Kubernetes Tools\" : 110\n    \"Python Ecosystem\" : 150\n    \"Node.js + AI CLIs\" : 140\n    \"Ansible + Config Mgmt\" : 95\n    \"Security (Trivy + DB)\" : 240\n    \"System Packages\" : 300\n    \"Development Tools\" : 100\n    \"Utilities &amp; Misc\" : 240</code></pre>"},{"location":"architecture/base-layer/#optimisation-techniques","title":"Optimisation Techniques","text":"<p>How We Keep Size Down</p> <ol> <li>Multi-stage builds: Compile tools in builder stage, copy binaries</li> <li>No build artifacts: Remove compilers, headers after builds</li> <li>Minimal dependencies: Only install required packages</li> <li>Single-layer cleanup: Combine install + cleanup in one RUN command</li> <li>Trivy DB sharing: Reuse database across all variants</li> </ol>"},{"location":"architecture/base-layer/#package-installation-details","title":"Package Installation Details","text":""},{"location":"architecture/base-layer/#system-packages-dnfyum","title":"System Packages (dnf/yum)","text":"<p>Categories installed:</p> <ul> <li>Core utilities: <code>coreutils</code>, <code>findutils</code>, <code>grep</code>, <code>sed</code>, <code>awk</code></li> <li>Network tools: <code>curl</code>, <code>wget</code>, <code>net-tools</code>, <code>bind-utils</code></li> <li>Archive tools: <code>tar</code>, <code>gzip</code>, <code>bzip2</code>, <code>xz</code>, <code>unzip</code></li> <li>Development: <code>gcc</code>, <code>g++</code>, <code>make</code>, <code>pkg-config</code> (build-time only)</li> <li>Python deps: <code>python3-devel</code>, <code>python3-pip</code></li> <li>SSL/TLS: <code>ca-certificates</code>, <code>openssl</code></li> </ul> <p>Cleanup strategy: </p><pre><code>dnf install -y &lt;packages&gt; &amp;&amp; \\\ndnf clean all &amp;&amp; \\\nrm -rf /var/cache/dnf/*\n</code></pre><p></p>"},{"location":"architecture/base-layer/#binary-downloads","title":"Binary Downloads","text":"<p>Many tools are downloaded as pre-compiled binaries for efficiency:</p> Tool Source Method Terraform releases.hashicorp.com Direct binary download kubectl dl.k8s.io Direct binary download Helm get.helm.sh Install script Trivy GitHub releases Binary download k9s GitHub releases Binary download gh GitHub releases Binary download <p>Benefits: - No compilation time - Smaller final image (no build tools) - Reproducible builds</p>"},{"location":"architecture/base-layer/#configuration-files","title":"Configuration Files","text":""},{"location":"architecture/base-layer/#shell-configuration","title":"Shell Configuration","text":"<p><code>/root/.zshrc</code>: - Oh-My-Zsh framework - Plugins: git, docker, terraform, kubectl - Custom aliases for common operations - Auto-completion enabled</p>"},{"location":"architecture/base-layer/#tool-defaults","title":"Tool Defaults","text":"<p>Terraform: - Plugin cache enabled: <code>~/.terraform.d/plugin-cache</code> - Provider mirror configured for faster downloads</p> <p>kubectl: - Context switching aliases: <code>kx</code>, <code>kn</code> - Default namespace support</p> <p>Ansible: - Host key checking disabled (for automation) - Coloured output enabled</p>"},{"location":"architecture/base-layer/#entrypoint-cmd","title":"Entrypoint &amp; CMD","text":""},{"location":"architecture/base-layer/#default-entrypoint","title":"Default Entrypoint","text":"<pre><code>ENTRYPOINT [\"/bin/zsh\"]\nCMD [\"-l\"]\n</code></pre> <p>Why <code>-l</code> (login shell)? - Sources <code>/root/.zshrc</code> automatically - Loads Oh-My-Zsh configuration - Activates custom aliases and completions</p>"},{"location":"architecture/base-layer/#override-examples","title":"Override Examples","text":"<pre><code># Custom command\ndocker run --rm &lt;image&gt; terraform version\n\n# Interactive bash instead of zsh\ndocker run -it --rm &lt;image&gt; /bin/bash\n\n# Run script\ndocker run --rm &lt;image&gt; sh -c \"terraform init &amp;&amp; terraform plan\"\n</code></pre>"},{"location":"architecture/base-layer/#environment-variables","title":"Environment Variables","text":""},{"location":"architecture/base-layer/#built-in-variables","title":"Built-in Variables","text":"Variable Value Purpose <code>PATH</code> Includes all tool binaries Ensure tools are executable <code>TERM</code> <code>xterm-256color</code> Colour support in terminal <code>LANG</code> <code>en_US.UTF-8</code> UTF-8 encoding <code>TF_PLUGIN_CACHE_DIR</code> <code>~/.terraform.d/plugin-cache</code> Speed up Terraform"},{"location":"architecture/base-layer/#user-configurable-variables","title":"User-Configurable Variables","text":"<p>Users can set these at runtime:</p> <ul> <li>Cloud credentials (see Authentication)</li> <li>Tool-specific settings</li> <li>CI/CD environment variables</li> </ul>"},{"location":"architecture/base-layer/#multi-architecture-support","title":"Multi-Architecture Support","text":"<p>The base layer is built for both architectures:</p> Architecture Support Level Notes linux/amd64 Full x86_64, most common linux/arm64 Full Apple Silicon, AWS Graviton <p>Build strategy: - Docker Buildx with QEMU emulation - Native builds on each architecture (faster) - Manifest list for auto-selection</p> <p>Tool compatibility: - All tools have arm64 binaries - No emulation needed at runtime - Performance equivalent to native</p>"},{"location":"architecture/base-layer/#security-hardening","title":"Security Hardening","text":"<p>Security Measures</p> <ol> <li>No root password: Root account locked by default</li> <li>Minimal attack surface: Only required packages installed</li> <li>Updated regularly: Base image rebuilt weekly</li> <li>Trivy scanning: Self-scan during build process</li> <li>No secrets: No API keys or credentials baked in</li> </ol>"},{"location":"architecture/base-layer/#recommended-practices","title":"Recommended Practices","text":"<ul> <li>Run as non-root user in production (use <code>--user</code> flag)</li> <li>Mount secrets as files, not environment variables</li> <li>Use read-only filesystem where possible</li> <li>Scan images before deployment</li> </ul>"},{"location":"architecture/base-layer/#version-pinning-strategy","title":"Version Pinning Strategy","text":""},{"location":"architecture/base-layer/#pinned-versions","title":"Pinned Versions","text":"<p>Rocky Linux: Pinned to <code>9.x</code> (major version) - Receives security updates - No breaking changes within major version</p> <p>Node.js: Pinned to <code>20.x</code> LTS - LTS until 2026-04-30 - Stable, production-ready</p>"},{"location":"architecture/base-layer/#latest-versions","title":"Latest Versions","text":"<p>Most tools use <code>latest</code> to ensure users get: - Security fixes - Bug fixes - New features</p> <p>Trade-off: - \u2705 Always up-to-date security - \u274c Potential breaking changes (mitigated by semantic versioning)</p>"},{"location":"architecture/base-layer/#version-lock-recommendations","title":"Version Lock Recommendations","text":"<p>For CI/CD, use specific image tags: </p><pre><code># Not recommended for production\nghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Recommended for production\nghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre><p></p>"},{"location":"architecture/base-layer/#next-steps","title":"Next Steps","text":"<ul> <li>Cloud Layers - AWS and GCP additions</li> <li>Image Comparison - Tool matrix across variants</li> <li>Building Images - Customise your own</li> </ul>"},{"location":"architecture/cloud-layers/","title":"Cloud Layers Architecture","text":""},{"location":"architecture/cloud-layers/#cloud-layers-architecture","title":"Cloud Layers Architecture","text":"<p>The cloud-specific layers extend the base image with AWS and/or GCP tools, creating specialized variants optimised for single-cloud or multi-cloud workflows.</p>"},{"location":"architecture/cloud-layers/#layer-strategy","title":"Layer Strategy","text":"<pre><code>graph TD\n    A[Base Layer ~2.0 GB] --&gt; B[AWS Layer +800 MB]\n    A --&gt; C[GCP Layer +900 MB]\n    A --&gt; D[All DevOps +1.2 GB]\n    B --&gt; E[aws-devops ~2.8 GB]\n    C --&gt; F[gcp-devops ~2.9 GB]\n    D --&gt; G[all-devops ~3.2 GB]\n\n    style A fill:#90EE90\n    style B fill:#FF9900\n    style C fill:#4285F4\n    style D fill:#FFA500\n    style E fill:#FF9900\n    style F fill:#4285F4\n    style G fill:#FFA500</code></pre>"},{"location":"architecture/cloud-layers/#design-rationale","title":"Design Rationale","text":"<p>Why Separate Layers?</p> <ul> <li>Smaller images: AWS-only teams don't need GCP tools (save 400 MB)</li> <li>Faster pulls: Less data to download in CI/CD pipelines</li> <li>Cleaner dependencies: No cross-cloud conflicts</li> <li>Better caching: Cloud-specific layers cached independently</li> </ul>"},{"location":"architecture/cloud-layers/#aws-layer","title":"AWS Layer","text":""},{"location":"architecture/cloud-layers/#tools-added","title":"Tools Added","text":"Tool Version Purpose Size Impact AWS CLI v2 Latest Core AWS operations ~180 MB AWS Session Manager Latest EC2 instance access ~20 MB boto3 Latest Python AWS SDK ~50 MB cfn-lint Latest CloudFormation validation ~30 MB s3cmd Latest Advanced S3 operations ~10 MB crcmod Latest CRC32c for uploads ~5 MB <p>Total AWS layer: ~800 MB</p>"},{"location":"architecture/cloud-layers/#detailed-breakdown","title":"Detailed Breakdown","text":"AWS CLI v2AWS Session Manager PluginPython AWS Libraries <p>Installation method: Binary download from official AWS source</p> <pre><code>curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\nunzip awscliv2.zip\n./aws/install --bin-dir /usr/local/bin --install-dir /usr/local/aws-cli\n</code></pre> <p>Size: ~180 MB (includes Python runtime, bundled dependencies)</p> <p>Why CLI v2? - \u2705 Standalone binary (no system Python conflicts) - \u2705 Faster performance - \u2705 Better error messages - \u2705 Auto-completion built-in - \u2705 Official AWS support</p> <p>Includes: - All AWS services (200+ service commands) - SSO support - S3 transfer acceleration - CloudFormation stack management</p> <p>Installation method: RPM package</p> <pre><code>dnf install -y \\\n  https://s3.amazonaws.com/session-manager-downloads/plugin/latest/linux_64bit/session-manager-plugin.rpm\n</code></pre> <p>Size: ~20 MB</p> <p>Why include this? - \u2705 SSH-like access to EC2 instances without SSH keys - \u2705 Audit logging to CloudWatch - \u2705 No need for bastion hosts - \u2705 Port forwarding support - \u2705 Session recording</p> <p>Common use cases: </p><pre><code># Connect to EC2 instance\naws ssm start-session --target i-1234567890abcdef0\n\n# Port forwarding\naws ssm start-session --target i-1234567890abcdef0 \\\n  --document-name AWS-StartPortForwardingSession \\\n  --parameters \"portNumber=3306,localPortNumber=3306\"\n</code></pre><p></p> <p>Installation method: pip</p> <pre><code>pip3 install --no-cache-dir \\\n  boto3 \\\n  cfn-lint \\\n  s3cmd \\\n  crcmod\n</code></pre> <p>Total size: ~95 MB</p> <p>boto3 (~50 MB): - AWS SDK for Python - Programmatic access to all AWS services - Widely used in automation scripts</p> <p>cfn-lint (~30 MB): - CloudFormation template validation - Catches errors before deployment - CI/CD integration ready</p> <p>s3cmd (~10 MB): - Advanced S3 operations - Batch operations - Better performance for large transfers</p> <p>crcmod (~5 MB): - CRC32c checksums - Data integrity verification - Required for reliable S3 uploads</p>"},{"location":"architecture/cloud-layers/#aws-specific-configurations","title":"AWS-Specific Configurations","text":"<p>Environment variables set: </p><pre><code>AWS_DEFAULT_REGION=us-east-1  # Default region\nAWS_PAGER=\"\"                  # Disable pager for automation\n</code></pre><p></p> <p>Configuration files: - AWS CLI config location: <code>~/.aws/config</code> - Credentials location: <code>~/.aws/credentials</code> - Session Manager plugin: Auto-configured</p>"},{"location":"architecture/cloud-layers/#gcp-layer","title":"GCP Layer","text":""},{"location":"architecture/cloud-layers/#tools-added_1","title":"Tools Added","text":"Tool Version Purpose Size Impact Google Cloud SDK Latest Core GCP operations ~700 MB - <code>gcloud</code> Included CLI for all GCP services - - <code>gsutil</code> Included Cloud Storage operations - - <code>bq</code> Included BigQuery CLI - docker-credential-gcr Latest GCR authentication ~10 MB <p>Total GCP layer: ~900 MB</p>"},{"location":"architecture/cloud-layers/#detailed-breakdown_1","title":"Detailed Breakdown","text":"Google Cloud SDKdocker-credential-gcr <p>Installation method: Official install script</p> <pre><code>curl https://sdk.cloud.google.com | bash -s -- --disable-prompts \\\n  --install-dir=/usr/local\n</code></pre> <p>Size: ~700 MB (includes Python runtime, all components)</p> <p>Why so large? - Includes Python 3.11 bundled runtime (~100 MB) - All GCP service modules (~400 MB) - Authentication components (~50 MB) - Beta/Alpha components (~100 MB) - Documentation and samples (~50 MB)</p> <p>Components included:</p> Component Purpose <code>gcloud</code> Core SDK, all GCP services <code>gsutil</code> Cloud Storage (S3-like operations) <code>bq</code> BigQuery data warehouse <code>gcloud alpha</code> Preview features <code>gcloud beta</code> Beta features <p>Why include alpha/beta? - Cutting-edge features for early adopters - GKE autopilot, Cloud Run revisions - Easily disabled if not needed</p> <p>Installation method: Binary download</p> <pre><code>curl -fsSL \"https://github.com/GoogleCloudPlatform/docker-credential-gcr/releases/download/v2.1.18/docker-credential-gcr_linux_amd64-2.1.18.tar.gz\" | \\\n  tar xz -C /usr/local/bin\n</code></pre> <p>Size: ~10 MB</p> <p>Why include this? - \u2705 Automatic GCR authentication - \u2705 No manual docker login needed - \u2705 Uses gcloud credentials - \u2705 Supports Artifact Registry</p> <p>Configuration: </p><pre><code>docker-credential-gcr configure-docker --registries=gcr.io,us-docker.pkg.dev\n</code></pre><p></p>"},{"location":"architecture/cloud-layers/#gcp-specific-configurations","title":"GCP-Specific Configurations","text":"<p>Environment variables set: </p><pre><code>CLOUDSDK_CORE_DISABLE_PROMPTS=1  # Automation-friendly\nCLOUDSDK_PYTHON_SITEPACKAGES=1   # Allow system packages\n</code></pre><p></p> <p>Configuration files: - gcloud config location: <code>~/.config/gcloud/</code> - Credentials: Application Default Credentials (ADC) - Docker config: <code>~/.docker/config.json</code></p>"},{"location":"architecture/cloud-layers/#size-optimisation-attempts","title":"Size Optimisation Attempts","text":"<p>Why not trim components?</p> <p>We considered installing only specific components: </p><pre><code>gcloud components install gcloud gsutil bq --quiet\n</code></pre><p></p> <p>Issues: - Minimal size savings (~50 MB, only 7% reduction) - Breaks future component installations - Missing dependencies for some features - Complexity not worth the trade-off</p> <p>Decision: Include full SDK for maximum compatibility.</p>"},{"location":"architecture/cloud-layers/#all-devops-layer-multi-cloud","title":"All-DevOps Layer (Multi-Cloud)","text":"<p>The <code>all-devops</code> image combines both AWS and GCP layers.</p>"},{"location":"architecture/cloud-layers/#architecture","title":"Architecture","text":"<pre><code>FROM base-layer\n# Install AWS layer (~800 MB)\nRUN install-aws-tools.sh\n# Install GCP layer (~900 MB)\nRUN install-gcp-tools.sh\n</code></pre>"},{"location":"architecture/cloud-layers/#size-optimisation","title":"Size Optimisation","text":"<p>Without optimisation: 2.0 GB + 800 MB + 900 MB = 3.7 GB</p> <p>With optimisation: 3.2 GB (save 500 MB)</p> <p>Optimisation techniques:</p> <ol> <li> <p>Shared dependencies: Both AWS and GCP use Python    </p><pre><code># Share Python packages\npip3 install --no-cache-dir boto3 google-cloud-storage\n</code></pre><p></p> </li> <li> <p>Single layer cleanup: Combine installs, clean once    </p><pre><code>RUN install-aws &amp;&amp; install-gcp &amp;&amp; \\\n    dnf clean all &amp;&amp; \\\n    rm -rf /var/cache/* /tmp/*\n</code></pre><p></p> </li> <li> <p>Deduplicated binaries: Some tools overlap</p> </li> <li>Both use <code>python3</code> (don't install twice)</li> <li> <p>Both use <code>curl</code>, <code>unzip</code> (already in base)</p> </li> <li> <p>Trivy database reuse: Single vulnerability DB for all scanning</p> </li> </ol>"},{"location":"architecture/cloud-layers/#comparison-table","title":"Comparison Table","text":"Feature Base AWS Layer GCP Layer All-DevOps Size 2.0 GB +800 MB +900 MB +1.2 GB Total 2.0 GB 2.8 GB 2.9 GB 3.2 GB Build Time 15 min +3 min +4 min +6 min AWS CLI \u274c \u2705 \u274c \u2705 gcloud \u274c \u274c \u2705 \u2705 boto3 \u274c \u2705 \u274c \u2705 gsutil \u274c \u274c \u2705 \u2705 Multi-cloud \u274c \u274c \u274c \u2705"},{"location":"architecture/cloud-layers/#layer-caching-strategy","title":"Layer Caching Strategy","text":""},{"location":"architecture/cloud-layers/#build-order-for-maximum-caching","title":"Build Order for Maximum Caching","text":"<pre><code>graph LR\n    A[Base Layer&lt;br/&gt;Changes: Quarterly] --&gt; B[AWS Layer&lt;br/&gt;Changes: Monthly]\n    A --&gt; C[GCP Layer&lt;br/&gt;Changes: Monthly]\n    A --&gt; D[All-DevOps&lt;br/&gt;Changes: Monthly]</code></pre> <p>Benefits: - Base layer cached for months (rarely changes) - Cloud layers rebuild independently - Parallel builds possible (AWS + GCP simultaneously) - Faster CI/CD (only changed layers rebuild)</p>"},{"location":"architecture/cloud-layers/#example-aws-cli-update","title":"Example: AWS CLI Update","text":"<p>When AWS CLI updates:</p> <ol> <li>Base layer: \u2705 Cached (unchanged)</li> <li>AWS layer: \u274c Rebuilds (~3 minutes)</li> <li>GCP layer: \u2705 Cached (unchanged)</li> <li>All-DevOps: \u26a0\ufe0f Partial rebuild (AWS portion only)</li> </ol> <p>Total rebuild time: ~6 minutes (instead of ~25 minutes full rebuild)</p>"},{"location":"architecture/cloud-layers/#size-vs-features-trade-off","title":"Size vs Features Trade-off","text":"<pre><code>graph LR\n    A[Base&lt;br/&gt;2.0 GB&lt;br/&gt;Platform Tools] --&gt; B[AWS&lt;br/&gt;+800 MB&lt;br/&gt;AWS Tools]\n    A --&gt; C[GCP&lt;br/&gt;+900 MB&lt;br/&gt;GCP Tools]\n    A --&gt; D[All-DevOps&lt;br/&gt;+1.2 GB&lt;br/&gt;Both Clouds]\n\n    style A fill:#90EE90\n    style B fill:#FFD700\n    style C fill:#FFD700\n    style D fill:#FFA500</code></pre>"},{"location":"architecture/cloud-layers/#decision-framework","title":"Decision Framework","text":"<p>Which image should I use?</p> <p>Use base layer if: - No cloud-specific tools needed - Building custom image - Kubernetes-only workflows</p> <p>Use aws-devops if: - AWS-exclusive environment - Want smaller image size - CI/CD speed matters</p> <p>Use gcp-devops if: - GCP-exclusive environment - GKE-focused workflows - Don't need AWS tools</p> <p>Use all-devops if: - Multi-cloud architecture - Team uses both AWS and GCP - Unified tooling needed</p>"},{"location":"architecture/cloud-layers/#multi-architecture-considerations","title":"Multi-Architecture Considerations","text":""},{"location":"architecture/cloud-layers/#size-by-architecture","title":"Size by Architecture","text":"Image amd64 arm64 Notes Base 2.0 GB 2.0 GB Identical AWS 2.8 GB 2.8 GB AWS CLI has native arm64 GCP 2.9 GB 2.9 GB gcloud SDK has native arm64 All-DevOps 3.2 GB 3.2 GB Both have arm64 support"},{"location":"architecture/cloud-layers/#build-time-by-architecture","title":"Build Time by Architecture","text":"Architecture Build Speed Notes amd64 Baseline Most common, well-optimised arm64 10-20% slower Fewer cached layers initially <p>Apple Silicon: Use arm64 native for best performance</p> <p>AWS Graviton: Use arm64 native (30% faster than emulated amd64)</p>"},{"location":"architecture/cloud-layers/#security-considerations","title":"Security Considerations","text":""},{"location":"architecture/cloud-layers/#attack-surface-by-layer","title":"Attack Surface by Layer","text":"Layer Added Attack Surface Mitigation Base Standard Linux tools Regular updates, minimal packages AWS AWS CLI, boto3 Official sources, signed binaries GCP gcloud SDK (large) Official SDK, regular updates"},{"location":"architecture/cloud-layers/#vulnerability-scanning-results","title":"Vulnerability Scanning Results","text":"<p>Typical Trivy scan (as of Jan 2025):</p> Image Critical High Medium Low Base 0 2 15 45 AWS 0 3 18 52 GCP 0 4 22 58 All-DevOps 0 5 25 65 <p>Note: Most vulnerabilities are in dependencies, not direct threats.</p> <p>Mitigation: - Weekly automatic rebuilds - Security patches applied immediately - Trivy scans in CI/CD pipeline</p>"},{"location":"architecture/cloud-layers/#maintenance-strategy","title":"Maintenance Strategy","text":""},{"location":"architecture/cloud-layers/#update-frequency","title":"Update Frequency","text":"Component Update Frequency Trigger Rocky Linux base Weekly Security patches System packages Weekly Security patches Cloud CLIs Monthly Version releases Python packages Monthly Version releases IaC tools Weekly Frequent releases"},{"location":"architecture/cloud-layers/#automated-rebuilds","title":"Automated Rebuilds","text":"<p>GitHub Actions workflow: </p><pre><code>schedule:\n  - cron: '0 2 * * 1'  # Weekly, Monday 2 AM UTC\n\njobs:\n  build-base:\n    # Build base layer\n  build-aws:\n    needs: build-base\n    # Build AWS variant\n  build-gcp:\n    needs: build-base\n    # Build GCP variant\n  build-all:\n    needs: build-base\n    # Build all-devops\n</code></pre><p></p> <p>Benefits: - Always up-to-date - Security patches applied automatically - Minimal manual intervention</p>"},{"location":"architecture/cloud-layers/#next-steps","title":"Next Steps","text":"<ul> <li>Image Comparison - Detailed tool matrix</li> <li>Base Layer Details - Platform tools breakdown</li> <li>Building Custom Images - Extend these images</li> </ul>"},{"location":"architecture/comparison/","title":"Image Comparison Matrix","text":""},{"location":"architecture/comparison/#image-comparison-matrix","title":"Image Comparison Matrix","text":"<p>Complete comparison of all image variants with detailed tool versions, sizes, and use case recommendations.</p>"},{"location":"architecture/comparison/#quick-comparison","title":"Quick Comparison","text":"Spec Base aws-devops gcp-devops all-devops Size ~2.0 GB ~2.8 GB (+800 MB) ~2.9 GB (+900 MB) ~3.2 GB (+1.2 GB) Build Time 15 min 18 min 19 min 21 min Platform Tools \u2705 Full \u2705 Full \u2705 Full \u2705 Full AWS Tools \u274c None \u2705 Full \u274c None \u2705 Full GCP Tools \u274c None \u274c None \u2705 Full \u2705 Full Use Case Platform-only AWS workflows GCP workflows Multi-cloud"},{"location":"architecture/comparison/#complete-tool-matrix","title":"Complete Tool Matrix","text":""},{"location":"architecture/comparison/#infrastructure-as-code","title":"Infrastructure as Code","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose Terraform \u2705 \u2705 \u2705 \u2705 Latest Multi-cloud IaC Terragrunt \u2705 \u2705 \u2705 \u2705 Latest Terraform wrapper TFLint \u2705 \u2705 \u2705 \u2705 Latest Terraform linter Packer \u2705 \u2705 \u2705 \u2705 Latest Image builder tfswitch \u2705 \u2705 \u2705 \u2705 Latest TF version manager <p>All variants include: Full Terraform ecosystem for infrastructure as code.</p>"},{"location":"architecture/comparison/#kubernetes-tools","title":"Kubernetes Tools","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose kubectl \u2705 \u2705 \u2705 \u2705 Latest Kubernetes CLI Helm \u2705 \u2705 \u2705 \u2705 3.x K8s package manager k9s \u2705 \u2705 \u2705 \u2705 Latest Terminal UI for K8s kustomize \u2705 \u2705 \u2705 \u2705 Latest K8s config management <p>All variants include: Complete Kubernetes toolchain for cluster management.</p>"},{"location":"architecture/comparison/#configuration-management","title":"Configuration Management","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose Ansible \u2705 \u2705 \u2705 \u2705 Latest Configuration automation ansible-lint \u2705 \u2705 \u2705 \u2705 Latest Playbook validation <p>All variants include: Ansible for agentless configuration management.</p>"},{"location":"architecture/comparison/#security-scanning","title":"Security &amp; Scanning","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose Trivy \u2705 \u2705 \u2705 \u2705 Latest Vulnerability scanner trivy-db \u2705 \u2705 \u2705 \u2705 Auto-updated Vuln database <p>All variants include: Trivy for container and IaC security scanning.</p>"},{"location":"architecture/comparison/#aws-specific-tools","title":"AWS-Specific Tools","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose AWS CLI v2 \u274c \u2705 \u274c \u2705 Latest AWS operations AWS Session Manager \u274c \u2705 \u274c \u2705 Latest EC2 access boto3 \u274c \u2705 \u274c \u2705 Latest Python AWS SDK cfn-lint \u274c \u2705 \u274c \u2705 Latest CloudFormation linter s3cmd \u274c \u2705 \u274c \u2705 Latest S3 operations crcmod \u274c \u2705 \u274c \u2705 Latest CRC verification <p>Available in: <code>aws-devops</code>, <code>all-devops</code> only</p> <p>AWS Workflows</p> <p>Choose <code>aws-devops</code> for AWS-only projects to save 400 MB compared to <code>all-devops</code>.</p>"},{"location":"architecture/comparison/#gcp-specific-tools","title":"GCP-Specific Tools","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose gcloud \u274c \u274c \u2705 \u2705 Latest GCP CLI gsutil \u274c \u274c \u2705 \u2705 Latest Cloud Storage bq \u274c \u274c \u2705 \u2705 Latest BigQuery CLI docker-credential-gcr \u274c \u274c \u2705 \u2705 Latest GCR auth <p>Available in: <code>gcp-devops</code>, <code>all-devops</code> only</p> <p>GCP Workflows</p> <p>Choose <code>gcp-devops</code> for GCP-only projects to save 300 MB compared to <code>all-devops</code>.</p>"},{"location":"architecture/comparison/#development-tools","title":"Development Tools","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose Python \u2705 \u2705 \u2705 \u2705 3.12 Scripting pip \u2705 \u2705 \u2705 \u2705 Latest Python packages pipx \u2705 \u2705 \u2705 \u2705 Latest Isolated CLIs Node.js \u2705 \u2705 \u2705 \u2705 20 LTS JavaScript runtime npm \u2705 \u2705 \u2705 \u2705 Latest Node packages <p>All variants include: Python 3.12 and Node.js 20 LTS for scripting and automation.</p>"},{"location":"architecture/comparison/#ai-cli-tools","title":"AI CLI Tools","text":"Tool Base aws-devops gcp-devops all-devops Provider Purpose claude \u2705 \u2705 \u2705 \u2705 Anthropic Code review, generation codex \u2705 \u2705 \u2705 \u2705 OpenAI Code completion copilot \u2705 \u2705 \u2705 \u2705 GitHub IDE integration gemini \u2705 \u2705 \u2705 \u2705 Google Multi-modal AI <p>All variants include: Complete AI CLI toolkit for AI-assisted DevOps workflows.</p> <p>Unique Feature</p> <p>All images include AI CLI tools for code review, generation, and troubleshooting.</p>"},{"location":"architecture/comparison/#version-control-cicd","title":"Version Control &amp; CI/CD","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose Git \u2705 \u2705 \u2705 \u2705 Latest Version control gh \u2705 \u2705 \u2705 \u2705 Latest GitHub CLI <p>All variants include: Git and GitHub CLI for version control workflows.</p>"},{"location":"architecture/comparison/#utilities","title":"Utilities","text":"Tool Base aws-devops gcp-devops all-devops Version Purpose jq \u2705 \u2705 \u2705 \u2705 Latest JSON processor yq \u2705 \u2705 \u2705 \u2705 Latest YAML processor Task \u2705 \u2705 \u2705 \u2705 Latest Task runner vim \u2705 \u2705 \u2705 \u2705 Latest Text editor curl \u2705 \u2705 \u2705 \u2705 Latest HTTP client wget \u2705 \u2705 \u2705 \u2705 Latest Downloader zsh \u2705 \u2705 \u2705 \u2705 Latest Default shell <p>All variants include: Essential command-line utilities.</p>"},{"location":"architecture/comparison/#size-breakdown-by-category","title":"Size Breakdown by Category","text":""},{"location":"architecture/comparison/#base-image-20-gb","title":"Base Image (~2.0 GB)","text":"<pre><code>pie title Base Image Components\n    \"Rocky Linux Base\" : 500\n    \"IaC Tools\" : 125\n    \"Kubernetes Tools\" : 110\n    \"Python + Node.js\" : 240\n    \"Security (Trivy)\" : 240\n    \"Ansible\" : 95\n    \"System Packages\" : 300\n    \"Utilities\" : 390</code></pre>"},{"location":"architecture/comparison/#aws-layer-800-mb","title":"AWS Layer (+800 MB)","text":"Component Size Percentage AWS CLI v2 (with Python runtime) 180 MB 22.5% boto3 Python SDK 50 MB 6.3% cfn-lint 30 MB 3.8% AWS Session Manager Plugin 20 MB 2.5% s3cmd + crcmod 15 MB 1.9% Dependencies &amp; overhead 505 MB 63.0% Total 800 MB 100%"},{"location":"architecture/comparison/#gcp-layer-900-mb","title":"GCP Layer (+900 MB)","text":"Component Size Percentage Google Cloud SDK (bundled Python) 700 MB 77.8% - gcloud core 400 MB - - Python runtime 100 MB - - Beta/Alpha components 100 MB - - Documentation 50 MB - - Other components 50 MB - docker-credential-gcr 10 MB 1.1% Dependencies &amp; overhead 190 MB 21.1% Total 900 MB 100%"},{"location":"architecture/comparison/#all-devops-12-gb","title":"All-DevOps (+1.2 GB)","text":"<p>Not simply AWS + GCP (would be 1.7 GB)</p> <p>Optimisations: - Shared Python runtime: Save ~50 MB - Shared dependencies: Save ~100 MB - Single-layer cleanup: Save ~150 MB</p> <p>Actual addition: 1.2 GB (save 500 MB through optimisation)</p>"},{"location":"architecture/comparison/#performance-comparison","title":"Performance Comparison","text":""},{"location":"architecture/comparison/#build-times","title":"Build Times","text":"Image Cold Build Warm Build (cached base) Multi-arch Build Base 15 min 15 min 30 min aws-devops 18 min 3 min 35 min gcp-devops 19 min 4 min 38 min all-devops 21 min 6 min 42 min <p>Notes: - Warm builds benefit from cached base layer - Multi-arch builds run sequentially (amd64, then arm64) - Can parallelize multi-arch builds with multiple runners</p>"},{"location":"architecture/comparison/#pull-times-1-gbps-network","title":"Pull Times (1 Gbps network)","text":"Image amd64 arm64 Base ~16 seconds ~16 seconds aws-devops ~22 seconds ~22 seconds gcp-devops ~23 seconds ~23 seconds all-devops ~26 seconds ~26 seconds <p>Factors affecting pull time: - Network speed - Registry location (GHCR generally faster from GitHub Actions) - Layer caching (subsequent pulls are faster)</p>"},{"location":"architecture/comparison/#startup-times","title":"Startup Times","text":"Image Interactive Shell One-off Command Base ~1.2 seconds ~0.8 seconds aws-devops ~1.5 seconds ~1.0 seconds gcp-devops ~1.6 seconds ~1.1 seconds all-devops ~1.8 seconds ~1.2 seconds <p>Note: Startup times measured on M2 MacBook Pro (arm64). Times may vary by host.</p>"},{"location":"architecture/comparison/#use-case-recommendations","title":"Use Case Recommendations","text":""},{"location":"architecture/comparison/#platform-only-workflows","title":"Platform-Only Workflows","text":"<p>Choose Base Image If</p> <ul> <li>Building your own custom image</li> <li>Kubernetes-only (no cloud CLIs needed)</li> <li>CI/CD for platform tools only</li> <li>Want smallest possible image</li> </ul> <p>Typical usage: </p><pre><code># Base is a local Dockerfile target (not a published registry image)\ndocker build --target base -t devops-base:local .\ndocker run -it --rm devops-base:local\n</code></pre><p></p>"},{"location":"architecture/comparison/#aws-centric-workflows","title":"AWS-Centric Workflows","text":"<p>Choose aws-devops If</p> <ul> <li>AWS-exclusive infrastructure</li> <li>CloudFormation or Terraform on AWS</li> <li>EKS cluster management</li> <li>EC2 automation with Session Manager</li> <li>Python scripts using boto3</li> </ul> <p>Typical usage: </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre><p></p> <p>Benefits over all-devops: - 400 MB smaller (13% reduction) - Faster pulls and builds - No unused GCP tools</p>"},{"location":"architecture/comparison/#gcp-centric-workflows","title":"GCP-Centric Workflows","text":"<p>Choose gcp-devops If</p> <ul> <li>GCP-exclusive infrastructure</li> <li>GKE cluster management</li> <li>Cloud Run or Cloud Functions deployments</li> <li>Cloud Storage operations</li> <li>BigQuery workflows</li> </ul> <p>Typical usage: </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/gcp-devops:latest\n</code></pre><p></p> <p>Benefits over all-devops: - 300 MB smaller (9% reduction) - Faster pulls and builds - No unused AWS tools</p>"},{"location":"architecture/comparison/#multi-cloud-workflows","title":"Multi-Cloud Workflows","text":"<p>Choose all-devops If</p> <ul> <li>Hybrid cloud architecture (AWS + GCP)</li> <li>Team uses multiple cloud providers</li> <li>Cross-cloud disaster recovery</li> <li>Cloud migration projects</li> <li>Need both AWS and GCP CLIs</li> </ul> <p>Typical usage: </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p> <p>Trade-offs: - Largest image (3.2 GB) - Complete toolset for both clouds - Unified image across teams</p>"},{"location":"architecture/comparison/#architecture-support","title":"Architecture Support","text":""},{"location":"architecture/comparison/#multi-architecture-matrix","title":"Multi-Architecture Matrix","text":"Image linux/amd64 linux/arm64 Notes Base \u2705 Full \u2705 Full Identical functionality aws-devops \u2705 Full \u2705 Full AWS CLI has native arm64 gcp-devops \u2705 Full \u2705 Full gcloud SDK has native arm64 all-devops \u2705 Full \u2705 Full Both clouds fully supported <p>Docker automatically selects the correct architecture based on your platform.</p> <p>Manifest list: </p><pre><code>docker manifest inspect ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p> <p>Shows available architectures for automatic selection.</p>"},{"location":"architecture/comparison/#registry-availability","title":"Registry Availability","text":""},{"location":"architecture/comparison/#image-availability-by-registry","title":"Image Availability by Registry","text":"Registry Base aws-devops gcp-devops all-devops GHCR (ghcr.io) \u2705 \u2705 \u2705 \u2705 GitLab (registry.gitlab.com) \u2705 \u2705 \u2705 \u2705 Docker Hub (docker.io) \u2705 \u2705 \u2705 \u2705 <p>Recommended: Use GHCR (GitHub Container Registry) for: - No rate limits on public images - Better performance from GitHub Actions - Built-in security scanning</p>"},{"location":"architecture/comparison/#decision-tree","title":"Decision Tree","text":"<pre><code>graph TD\n    A[Which image?] --&gt; B{Need cloud&lt;br/&gt;CLIs?}\n    B --&gt;|No| C[Base Image&lt;br/&gt;~2.0 GB]\n    B --&gt;|Yes| D{Which&lt;br/&gt;cloud?}\n    D --&gt;|AWS only| E[aws-devops&lt;br/&gt;~2.8 GB]\n    D --&gt;|GCP only| F[gcp-devops&lt;br/&gt;~2.9 GB]\n    D --&gt;|Both| G[all-devops&lt;br/&gt;~3.2 GB]\n    D --&gt;|Unsure| G\n\n    style C fill:#90EE90\n    style E fill:#FFD700\n    style F fill:#FFD700\n    style G fill:#FFA500</code></pre>"},{"location":"architecture/comparison/#cost-considerations","title":"Cost Considerations","text":""},{"location":"architecture/comparison/#storage-costs","title":"Storage Costs","text":"<p>Assuming $0.10/GB/month for container registry storage:</p> Image Storage Cost Annual Cost Base $0.20/month $2.40/year aws-devops $0.28/month $3.36/year gcp-devops $0.29/month $3.48/year all-devops $0.32/month $3.84/year <p>For 10 developers pulling daily: - Bandwidth: ~10 GB/day per image - Monthly bandwidth: ~300 GB - Bandwidth cost: ~$30/month (varies by registry)</p> <p>Optimisation tip: Use smaller images (aws-devops or gcp-devops) to reduce bandwidth costs.</p>"},{"location":"architecture/comparison/#cicd-pipeline-costs","title":"CI/CD Pipeline Costs","text":"<p>GitHub Actions (2,000 free minutes/month):</p> Image Pull Time Builds/Month Minutes Used aws-devops 22s 100 37 minutes gcp-devops 23s 100 38 minutes all-devops 26s 100 43 minutes <p>Savings: Using aws-devops vs all-devops saves ~6 minutes/month per 100 builds.</p>"},{"location":"architecture/comparison/#migration-guide","title":"Migration Guide","text":""},{"location":"architecture/comparison/#from-docker-hub-to-ghcr","title":"From Docker Hub to GHCR","text":"<p>Old: </p><pre><code>docker pull js01/all-devops:latest\n</code></pre><p></p> <p>New: </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p> <p>CI/CD update: </p><pre><code># .github/workflows/ci.yml\ncontainer:\n  image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre><p></p>"},{"location":"architecture/comparison/#from-all-devops-to-cloud-specific","title":"From all-devops to Cloud-Specific","text":"<p>Step 1: Determine cloud usage </p><pre><code># Check if AWS CLI is used\ngrep -r \"aws \" .github/\n\n# Check if gcloud is used\ngrep -r \"gcloud \" .github/\n</code></pre><p></p> <p>Step 2: Update image </p><pre><code># If only AWS found\ncontainer:\n  image: ghcr.io/jinalshah/devops/images/aws-devops:1.0.abc1234\n\n# If only GCP found\ncontainer:\n  image: ghcr.io/jinalshah/devops/images/gcp-devops:1.0.abc1234\n</code></pre><p></p> <p>Step 3: Test and measure - Verify all workflows pass - Measure pull time improvement - Monitor build duration</p>"},{"location":"architecture/comparison/#next-steps","title":"Next Steps","text":"<ul> <li>Base Layer Details - Tool breakdown</li> <li>Cloud Layer Details - AWS and GCP additions</li> <li>Building Images - Customise your own</li> <li>Use Images Guide - Get started</li> </ul>"},{"location":"build-images/","title":"Building Images","text":""},{"location":"build-images/#building-images","title":"Building Images","text":"<p>Complete guide to building DevOps Images locally, including benchmarks, optimisation strategies, and troubleshooting.</p>"},{"location":"build-images/#when-to-build-vs-pull","title":"When to Build vs Pull","text":""},{"location":"build-images/#pull-from-registry-recommended","title":"Pull from Registry (Recommended)","text":"<p>Pull if you need</p> <ul> <li>\u2705 Standard tooling: Official builds have everything most teams need</li> <li>\u2705 Fast setup: Pull in seconds vs build in minutes</li> <li>\u2705 Tested builds: CI/CD tested and scanned for vulnerabilities</li> <li>\u2705 Multi-arch support: Automatic architecture selection</li> <li>\u2705 Regular updates: Weekly rebuilds with latest security patches</li> </ul> <p>Quick pull: </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p>"},{"location":"build-images/#build-locally","title":"Build Locally","text":"<p>Build if you need</p> <ul> <li>\ud83d\udd27 Custom tools: Add proprietary or internal tools</li> <li>\ud83d\udd27 Specific versions: Pin tool versions for compliance</li> <li>\ud83d\udd27 Size optimisation: Remove unused tools</li> <li>\ud83d\udd27 Custom base: Different Linux distro or base image</li> <li>\ud83d\udd27 Air-gapped: No internet access for pulls</li> </ul>"},{"location":"build-images/#prerequisites","title":"Prerequisites","text":""},{"location":"build-images/#system-requirements","title":"System Requirements","text":"Requirement Minimum Recommended Notes Docker 20.10+ 24.0+ BuildKit required Disk Space 10 GB free 20 GB free Build cache + layers RAM 4 GB 8 GB Parallel builds benefit CPU 2 cores 4+ cores Faster builds Network 10 Mbps 100 Mbps Package downloads"},{"location":"build-images/#enable-buildkit","title":"Enable BuildKit","text":"Docker CLIDocker DesktopVerify <pre><code># Enable for single build\nDOCKER_BUILDKIT=1 docker build .\n\n# Enable permanently\necho 'export DOCKER_BUILDKIT=1' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\n</code></pre> <ol> <li>Open Docker Desktop settings</li> <li>Go to \"Docker Engine\"</li> <li>Add to configuration:    <pre><code>{\n  \"features\": {\n    \"buildkit\": true\n  }\n}\n</code></pre></li> <li>Click \"Apply &amp; Restart\"</li> </ol> <pre><code>docker version | grep BuildKit\n# Should show: BuildKit: true\n</code></pre>"},{"location":"build-images/#quick-start","title":"Quick Start","text":""},{"location":"build-images/#build-single-image","title":"Build Single Image","text":"all-devopsaws-devopsgcp-devops <pre><code>docker build \\\n  --target all-devops \\\n  --tag all-devops:local \\\n  .\n</code></pre> <p>Build time: ~21 minutes (cold), ~3 minutes (warm)</p> <pre><code>docker build \\\n  --target aws-devops \\\n  --tag aws-devops:local \\\n  .\n</code></pre> <p>Build time: ~18 minutes (cold), ~2 minutes (warm)</p> <pre><code>docker build \\\n  --target gcp-devops \\\n  --tag gcp-devops:local \\\n  .\n</code></pre> <p>Build time: ~19 minutes (cold), ~2.5 minutes (warm)</p>"},{"location":"build-images/#build-all-images","title":"Build All Images","text":"<pre><code>#!/bin/bash\n# build-all.sh\n\nfor target in all-devops aws-devops gcp-devops; do\n  echo \"Building $target...\"\n  docker build \\\n    --target \"$target\" \\\n    --tag \"$target:local\" \\\n    .\ndone\n</code></pre> <p>Total build time: ~60 minutes (cold), ~8 minutes (warm with cache)</p>"},{"location":"build-images/#build-time-benchmarks","title":"Build Time Benchmarks","text":""},{"location":"build-images/#cold-build-no-cache","title":"Cold Build (No Cache)","text":"Image amd64 arm64 Notes Base layer 15 min 17 min Rocky Linux + tools aws-devops 18 min 20 min +AWS CLI installation gcp-devops 19 min 21 min +gcloud SDK (larger) all-devops 21 min 23 min +both cloud CLIs"},{"location":"build-images/#warm-build-cached-layers","title":"Warm Build (Cached Layers)","text":"Image Build Time Layers Rebuilt Layers Cached aws-devops 2-3 min AWS layer only Base layer (15 min saved) gcp-devops 2.5-3.5 min GCP layer only Base layer (15 min saved) all-devops 3-4 min Cloud layers only Base layer (15 min saved)"},{"location":"build-images/#cicd-build-times","title":"CI/CD Build Times","text":"Platform Cold Build Warm Build Cache Strategy GitHub Actions 20-25 min 4-6 min Layer caching enabled GitLab CI 22-27 min 5-7 min Registry cache Jenkins 18-23 min 3-5 min Persistent volumes Local (M2 Mac) 15-20 min 2-4 min BuildKit cache"},{"location":"build-images/#build-cache-strategies","title":"Build Cache Strategies","text":""},{"location":"build-images/#strategy-1-layer-caching-default","title":"Strategy 1: Layer Caching (Default)","text":"<p>Docker automatically caches unchanged layers:</p> <pre><code># Layer 1: Base (rarely changes) - CACHED\nFROM rockylinux:9\n\n# Layer 2: System packages (monthly) - CACHED\nRUN dnf install -y python3 nodejs\n\n# Layer 3: IaC tools (weekly) - REBUILT\nRUN install-terraform.sh\n\n# Layer 4: Cloud CLIs (monthly) - REBUILT\nRUN install-aws-cli.sh\n</code></pre> <p>Optimise Layer Order</p> <p>Place frequently changing layers at the end to maximise cache hits.</p>"},{"location":"build-images/#strategy-2-buildkit-cache-mount","title":"Strategy 2: BuildKit Cache Mount","text":"<pre><code># Use cache mount for package managers\ndocker build \\\n  --target all-devops \\\n  --cache-from type=local,src=/tmp/buildkit-cache \\\n  --cache-to type=local,dest=/tmp/buildkit-cache \\\n  -t all-devops:local .\n</code></pre> <p>Benefits: - Persistent cache across builds - Shared cache between projects - Faster package manager operations</p>"},{"location":"build-images/#strategy-3-registry-cache","title":"Strategy 3: Registry Cache","text":"<pre><code># Pull previous build as cache\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Build using registry cache\ndocker build \\\n  --target all-devops \\\n  --cache-from ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  -t all-devops:local .\n</code></pre> <p>Benefits: - Works in CI/CD without local cache - Team shares cache via registry - Consistent across environments</p>"},{"location":"build-images/#build-args-reference","title":"Build Args Reference","text":""},{"location":"build-images/#common-build-args","title":"Common Build Args","text":"Arg Default Purpose Example <code>GCLOUD_VERSION</code> <code>501.0.0</code> Google Cloud SDK version <code>501.0.0</code> <code>PACKER_VERSION</code> <code>1.11.2</code> Packer version <code>1.11.2</code> <code>TERRAGRUNT_VERSION</code> <code>0.68.14</code> Terragrunt version <code>0.68.14</code> <code>TFLINT_VERSION</code> <code>0.50.3</code> TFLint version <code>0.50.3</code> <code>K9S_VERSION</code> <code>0.32.7</code> k9s version <code>0.32.7</code> <code>PYTHON_VERSION</code> <code>3.12.4</code> Python source version to compile <code>3.11.10</code>, <code>3.12.4</code> <code>PYTHON_VERSION_TO_USE</code> <code>python3.12</code> Python binary selected via alternatives <code>python3.11</code>, <code>python3.12</code> <code>GHORG_VERSION</code> <code>1.9.10</code> ghorg version <code>1.9.10</code> <code>MONGODB_VERSION</code> <code>6.0</code> MongoDB shell repository major version <code>6.0</code>, <code>7.0</code>"},{"location":"build-images/#using-build-args","title":"Using Build Args","text":"<pre><code>docker build \\\n  --target all-devops \\\n  --build-arg GCLOUD_VERSION=500.0.0 \\\n  --build-arg PACKER_VERSION=1.11.2 \\\n  --build-arg PYTHON_VERSION=3.11 \\\n  -t all-devops:custom .\n</code></pre>"},{"location":"build-images/#pin-all-versions","title":"Pin All Versions","text":"<pre><code># versions.env\nGCLOUD_VERSION=501.0.0\nPACKER_VERSION=1.11.2\nTERRAGRUNT_VERSION=0.68.14\nTFLINT_VERSION=0.50.3\nK9S_VERSION=0.32.7\n\n# Build with pinned versions\ndocker build \\\n  --target all-devops \\\n  --build-arg GCLOUD_VERSION=501.0.0 \\\n  --build-arg PACKER_VERSION=1.10.0 \\\n  --build-arg TERRAGRUNT_VERSION=0.68.14 \\\n  --build-arg TFLINT_VERSION=0.50.0 \\\n  --build-arg K9S_VERSION=0.32.0 \\\n  -t all-devops:pinned .\n</code></pre>"},{"location":"build-images/#validate-builds","title":"Validate Builds","text":""},{"location":"build-images/#quick-validation","title":"Quick Validation","text":"<pre><code># Verify all-devops\ndocker run --rm all-devops:local terraform version\ndocker run --rm all-devops:local aws --version\ndocker run --rm all-devops:local gcloud --version\n\n# Verify aws-devops\ndocker run --rm aws-devops:local terraform version\ndocker run --rm aws-devops:local aws --version\n\n# Verify gcp-devops\ndocker run --rm gcp-devops:local terraform version\ndocker run --rm gcp-devops:local gcloud --version\n</code></pre>"},{"location":"build-images/#comprehensive-validation","title":"Comprehensive Validation","text":"<pre><code>#!/bin/bash\n# validate-build.sh\n\nIMAGE=$1\n\necho \"Validating $IMAGE...\"\n\n# Check base tools\ndocker run --rm $IMAGE terraform version || exit 1\ndocker run --rm $IMAGE kubectl version --client || exit 1\ndocker run --rm $IMAGE helm version || exit 1\ndocker run --rm $IMAGE ansible --version || exit 1\ndocker run --rm $IMAGE trivy --version || exit 1\ndocker run --rm $IMAGE python3 --version || exit 1\ndocker run --rm $IMAGE node --version || exit 1\n\n# Check cloud tools (if present)\ndocker run --rm $IMAGE aws --version 2&gt;/dev/null &amp;&amp; echo \"AWS CLI: OK\"\ndocker run --rm $IMAGE gcloud --version 2&gt;/dev/null &amp;&amp; echo \"gcloud: OK\"\n\necho \"\u2705 Validation complete!\"\n</code></pre> <p>Usage: </p><pre><code>./validate-build.sh all-devops:local\n</code></pre><p></p>"},{"location":"build-images/#repository-test-scripts","title":"Repository Test Scripts","text":"<p>If building from the repository, additional test scripts are available:</p> <pre><code># Test network tools\n./test_network_tools.sh all-devops:local\n\n# Test DNS resolution\n./test_dns_tools.sh all-devops:local\n\n# Test ncat (network cat)\n./test_ncat_tool.sh all-devops:local\n</code></pre>"},{"location":"build-images/#optimisation-techniques","title":"Optimisation Techniques","text":""},{"location":"build-images/#reduce-build-time","title":"Reduce Build Time","text":"Parallel BuildsBuildKit ParallelismFast Package Manager <pre><code># Build multiple images in parallel\ndocker build --target aws-devops -t aws-devops:local . &amp;\ndocker build --target gcp-devops -t gcp-devops:local . &amp;\nwait\n</code></pre> <pre><code># Enable parallel layer builds\nBUILDKIT_STEP_LOG_MAX_SIZE=10000000 \\\nBUILDKIT_STEP_LOG_MAX_SPEED=10000000 \\\ndocker build --target all-devops -t all-devops:local .\n</code></pre> <pre><code># Use faster mirrors\nRUN sed -i 's|^mirrorlist=|#mirrorlist=|g' /etc/yum.repos.d/Rocky-*.repo &amp;&amp; \\\n    sed -i 's|^#baseurl=http://dl.rockylinux.org|baseurl=https://mirror.example.com|g' /etc/yum.repos.d/Rocky-*.repo\n</code></pre>"},{"location":"build-images/#reduce-image-size","title":"Reduce Image Size","text":"<p>See Optimisation Guide for detailed size reduction techniques.</p>"},{"location":"build-images/#troubleshooting","title":"Troubleshooting","text":"Build fails with 'No space left on device' <p>Problem: Insufficient disk space for build layers</p> <p>Solutions:</p> <ol> <li> <p>Clean up Docker system:    </p><pre><code>docker system prune -a --volumes\n</code></pre><p></p> </li> <li> <p>Check available space:    </p><pre><code>df -h /var/lib/docker\n</code></pre><p></p> </li> <li> <p>Increase Docker Desktop disk size:</p> </li> <li>Settings \u2192 Resources \u2192 Disk image size \u2192 60 GB</li> </ol> Build takes extremely long (&gt;1 hour) <p>Problem: Network issues or no layer caching</p> <p>Solutions:</p> <ol> <li> <p>Check network speed:    </p><pre><code>curl -o /dev/null https://dl.k8s.io/release/v1.29.0/bin/linux/amd64/kubectl\n</code></pre><p></p> </li> <li> <p>Enable BuildKit (faster):    </p><pre><code>export DOCKER_BUILDKIT=1\n</code></pre><p></p> </li> <li> <p>Use cache from registry:    </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\ndocker build --cache-from ghcr.io/jinalshah/devops/images/all-devops:latest -t all-devops:local .\n</code></pre><p></p> </li> </ol> Cannot download packages (404 errors) <p>Problem: Package repositories unreachable or versions unavailable</p> <p>Solutions:</p> <ol> <li> <p>Check internet connectivity:    </p><pre><code>ping -c 3 dl.k8s.io\n</code></pre><p></p> </li> <li> <p>Use build arg to pin working version:    </p><pre><code>docker build --build-arg TERRAGRUNT_VERSION=0.67.0 -t all-devops:local .\n</code></pre><p></p> </li> <li> <p>Check Rocky Linux mirrors:    </p><pre><code>docker run --rm rockylinux:9 dnf repolist\n</code></pre><p></p> </li> </ol> Build fails on M1/M2 Mac <p>Problem: Architecture mismatch or emulation issues</p> <p>Solutions:</p> <ol> <li> <p>Build for native architecture:    </p><pre><code>docker build --platform linux/arm64 --target all-devops -t all-devops:local .\n</code></pre><p></p> </li> <li> <p>Disable Rosetta emulation in Docker Desktop:</p> </li> <li> <p>Settings \u2192 Features in development \u2192 Uncheck \"Use Rosetta\"</p> </li> <li> <p>Use native arm64 builders:    </p><pre><code>docker buildx create --name arm-builder --platform linux/arm64\ndocker buildx use arm-builder\n</code></pre><p></p> </li> </ol> Python or Node.js version errors <p>Problem: Incompatible Python/Node.js version</p> <p>Solutions:</p> <ol> <li> <p>Specify version with build arg:    </p><pre><code>docker build --build-arg PYTHON_VERSION=3.11 -t all-devops:local .\n</code></pre><p></p> </li> <li> <p>Check available versions in Dockerfile:    </p><pre><code>grep \"PYTHON_VERSION\" Dockerfile\n</code></pre><p></p> </li> </ol> gcloud SDK installation fails <p>Problem: Large download, network timeout</p> <p>Solutions:</p> <ol> <li> <p>Increase build timeout (CI/CD):    </p><pre><code># GitHub Actions\ntimeout-minutes: 60\n</code></pre><p></p> </li> <li> <p>Use cached layer:    </p><pre><code>docker build --cache-from ghcr.io/jinalshah/devops/images/gcp-devops:latest .\n</code></pre><p></p> </li> <li> <p>Download manually and add to build context:    </p><pre><code>curl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-501.0.0-linux-x86_64.tar.gz\n</code></pre><p></p> </li> </ol>"},{"location":"build-images/#platform-specific-builds","title":"Platform-Specific Builds","text":""},{"location":"build-images/#macos-apple-silicon","title":"macOS (Apple Silicon)","text":"<pre><code># Build for native arm64\ndocker build \\\n  --platform linux/arm64 \\\n  --target all-devops \\\n  -t all-devops:local .\n</code></pre> <p>Notes: - Faster than emulated amd64 - All tools have native arm64 support - No compatibility issues</p>"},{"location":"build-images/#windows-wsl2","title":"Windows (WSL2)","text":"<pre><code># From WSL2 terminal\nexport DOCKER_BUILDKIT=1\ndocker build --target all-devops -t all-devops:local .\n</code></pre> <p>Notes: - Use WSL2 for best performance - Avoid Docker Desktop with Hyper-V (slower) - Ensure WSL2 has enough memory (Settings \u2192 WSL)</p>"},{"location":"build-images/#linux","title":"Linux","text":"<pre><code># Standard build\ndocker build --target all-devops -t all-devops:local .\n</code></pre> <p>Notes: - Best performance (native) - No emulation overhead - Fastest build times</p>"},{"location":"build-images/#advanced-build-topics","title":"Advanced Build Topics","text":""},{"location":"build-images/#multi-platform-builds","title":"Multi-Platform Builds","text":"<p>Build for both amd64 and arm64:</p> <pre><code>docker buildx build \\\n  --platform linux/amd64,linux/arm64 \\\n  --target all-devops \\\n  -t all-devops:multiarch \\\n  --load .\n</code></pre> <p>See Multi-Platform Images for complete guide.</p>"},{"location":"build-images/#custom-builds","title":"Custom Builds","text":"<p>Extend images with custom tools:</p> <pre><code># Create custom Dockerfile\nFROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add custom tools\nRUN pip3 install custom-package\nRUN curl -o /usr/local/bin/custom-tool https://example.com/tool\n\n# Build\ndocker build -f Dockerfile.custom -t all-devops:custom .\n</code></pre> <p>See Customisation Guide for detailed examples.</p>"},{"location":"build-images/#automated-builds","title":"Automated Builds","text":"<p>Set up CI/CD to build automatically:</p> <ul> <li>GitHub Actions build workflow - Example in repository</li> <li>GitLab CI - Build pipeline</li> <li>Jenkins - Declarative pipeline</li> </ul>"},{"location":"build-images/#cloud-specific-build-guides","title":"Cloud-Specific Build Guides","text":"<p>Detailed build instructions for each variant:</p> <ul> <li>Building all-devops - Multi-cloud image</li> <li>Building aws-devops - AWS-optimised image</li> <li>Building gcp-devops - GCP-optimised image</li> </ul>"},{"location":"build-images/#best-practices","title":"Best Practices","text":"<p>Build Recommendations</p> <ol> <li>Use cache: Always enable <code>--cache-from</code> in CI/CD</li> <li>Pin versions: Use build args to lock versions for reproducibility</li> <li>Test locally first: Validate builds before CI/CD</li> <li>Monitor build times: Track and optimise slow stages</li> <li>Clean regularly: Run <code>docker system prune</code> weekly</li> </ol> <p>Common Mistakes</p> <ul> <li>\u274c Building without BuildKit (slower)</li> <li>\u274c No layer caching (rebuilds everything)</li> <li>\u274c Not pinning versions (non-reproducible)</li> <li>\u274c Building on low-spec machines (slow)</li> <li>\u274c Not validating after build (broken images)</li> </ul>"},{"location":"build-images/#next-steps","title":"Next Steps","text":"<ul> <li>Optimisation Guide - Reduce size and build time</li> <li>Customisation Guide - Extend with custom tools</li> <li>Multi-Platform Guide - Build for amd64 and arm64</li> <li>Architecture Overview - Understand image layers</li> </ul>"},{"location":"build-images/all-devops/","title":"Build: All DevOps","text":""},{"location":"build-images/all-devops/#build-all-devops","title":"Build: All DevOps","text":""},{"location":"build-images/all-devops/#local-build","title":"Local Build","text":"<pre><code>docker build --target all-devops -t all-devops:local .\n</code></pre>"},{"location":"build-images/all-devops/#run","title":"Run","text":"<pre><code>docker run -it --rm all-devops:local\n</code></pre>"},{"location":"build-images/all-devops/#quick-verification","title":"Quick Verification","text":"<pre><code>docker run --rm all-devops:local terraform version\ndocker run --rm all-devops:local aws --version\ndocker run --rm all-devops:local gcloud --version\ndocker run --rm all-devops:local trivy --version\n</code></pre>"},{"location":"build-images/all-devops/#custom-build-example","title":"Custom Build Example","text":"<pre><code>docker build \\\n  --target all-devops \\\n  --build-arg PYTHON_VERSION=3.12.4 \\\n  --build-arg K9S_VERSION=0.32.7 \\\n  -t all-devops:custom .\n</code></pre>"},{"location":"build-images/aws-devops/","title":"Build: AWS DevOps","text":""},{"location":"build-images/aws-devops/#build-aws-devops","title":"Build: AWS DevOps","text":""},{"location":"build-images/aws-devops/#local-build","title":"Local Build","text":"<pre><code>docker build --target aws-devops -t aws-devops:local .\n</code></pre>"},{"location":"build-images/aws-devops/#run","title":"Run","text":"<pre><code>docker run -it --rm aws-devops:local\n</code></pre>"},{"location":"build-images/aws-devops/#quick-verification","title":"Quick Verification","text":"<pre><code>docker run --rm aws-devops:local aws --version\ndocker run --rm aws-devops:local terragrunt --version\ndocker run --rm aws-devops:local cfn-lint --version\n</code></pre>"},{"location":"build-images/aws-devops/#example-with-local-aws-credentials","title":"Example With Local AWS Credentials","text":"<pre><code>docker run -it --rm -v ~/.aws:/root/.aws aws-devops:local aws sts get-caller-identity\n</code></pre>"},{"location":"build-images/customization/","title":"Customising Images","text":""},{"location":"build-images/customization/#customising-images","title":"Customising Images","text":"<p>Comprehensive guide to extending DevOps Images with custom tools, packages, and configurations tailored to your team's specific needs.</p>"},{"location":"build-images/customization/#why-customise","title":"Why Customise?","text":"<p>Common Customisation Reasons</p> <ul> <li>\ud83d\udd27 Proprietary tools: Add internal or licensed software</li> <li>\ud83d\udd27 Specific versions: Lock tool versions for compliance</li> <li>\ud83d\udd27 Additional languages: Add Ruby, Go, Rust, etc.</li> <li>\ud83d\udd27 Custom scripts: Include team-specific automation</li> <li>\ud83d\udd27 Organisation standards: Enforce coding standards, linters</li> <li>\ud83d\udd27 Size optimisation: Remove unused tools</li> </ul>"},{"location":"build-images/customization/#customisation-approaches","title":"Customisation Approaches","text":""},{"location":"build-images/customization/#approach-1-extend-existing-image-recommended","title":"Approach 1: Extend Existing Image (Recommended)","text":"<p>Fastest and simplest - build on top of official images:</p> <pre><code># Dockerfile.custom\nFROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add your custom tools here\nRUN pip3 install custom-package\n</code></pre> <p>Pros: - \u2705 Minimal build time (~2-5 minutes) - \u2705 Inherits all updates from base image - \u2705 Easy to maintain</p> <p>Cons: - \u274c Cannot remove base tools - \u274c Slight size overhead</p>"},{"location":"build-images/customization/#approach-2-fork-and-modify-dockerfile","title":"Approach 2: Fork and Modify Dockerfile","text":"<p>Clone repository and modify the main Dockerfile:</p> <pre><code>git clone https://github.com/jinalshah/devops-images\ncd devops-images\n# Edit Dockerfile\ndocker build --target all-devops -t my-devops:latest .\n</code></pre> <p>Pros: - \u2705 Full control over all layers - \u2705 Can remove unwanted tools - \u2705 Maximum optimisation</p> <p>Cons: - \u274c Longer build time (~20+ minutes) - \u274c Must manually merge upstream updates - \u274c More complex maintenance</p>"},{"location":"build-images/customization/#approach-3-multi-stage-with-base","title":"Approach 3: Multi-Stage with Base","text":"<p>Use base image as builder, copy what you need:</p> <pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest AS base\n\nFROM rockylinux:9\n# Copy only specific tools from base\nCOPY --from=base /usr/local/bin/terraform /usr/local/bin/\nCOPY --from=base /usr/local/bin/kubectl /usr/local/bin/\n# Add your custom setup\n</code></pre> <p>Pros: - \u2705 Minimal final image size - \u2705 Pick and choose tools</p> <p>Cons: - \u274c Complex dependency management - \u274c May miss library dependencies - \u274c Higher maintenance</p>"},{"location":"build-images/customization/#quick-customisation-examples","title":"Quick Customisation Examples","text":""},{"location":"build-images/customization/#add-python-packages","title":"Add Python Packages","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add Python packages\nRUN pip3 install --no-cache-dir \\\n    requests==2.31.0 \\\n    pydantic==2.5.0 \\\n    black==23.12.1 \\\n    pytest==7.4.3\n</code></pre>"},{"location":"build-images/customization/#add-nodejs-packages","title":"Add Node.js Packages","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add Node.js global packages\nRUN npm install -g \\\n    prettier@3.1.1 \\\n    eslint@8.56.0 \\\n    typescript@5.3.3\n</code></pre>"},{"location":"build-images/customization/#add-system-tools","title":"Add System Tools","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add system packages\nRUN dnf install -y \\\n    httpd-tools \\\n    nmap \\\n    tcpdump \\\n    &amp;&amp; dnf clean all\n</code></pre>"},{"location":"build-images/customization/#add-binary-tools","title":"Add Binary Tools","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add custom binary\nRUN curl -fsSL https://example.com/tool -o /usr/local/bin/tool &amp;&amp; \\\n    chmod +x /usr/local/bin/tool\n</code></pre>"},{"location":"build-images/customization/#complete-customisation-examples","title":"Complete Customisation Examples","text":""},{"location":"build-images/customization/#example-1-development-team-image","title":"Example 1: Development Team Image","text":"<p>Add linters, formatters, and quality tools:</p> <pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Python development tools\nRUN pip3 install --no-cache-dir \\\n    black \\\n    pylint \\\n    mypy \\\n    pytest \\\n    pytest-cov \\\n    pre-commit\n\n# Node.js development tools\nRUN npm install -g \\\n    prettier \\\n    eslint \\\n    @typescript-eslint/parser \\\n    @typescript-eslint/eslint-plugin\n\n# Add shellcheck for bash linting\nRUN dnf install -y ShellCheck &amp;&amp; dnf clean all\n\n# Install hadolint for Dockerfile linting\nRUN curl -fsSL https://github.com/hadolint/hadolint/releases/download/v2.12.0/hadolint-Linux-x86_64 \\\n    -o /usr/local/bin/hadolint &amp;&amp; \\\n    chmod +x /usr/local/bin/hadolint\n\nLABEL maintainer=\"devops@company.com\"\nLABEL version=\"1.0\"\n</code></pre> <p>Build: </p><pre><code>docker build -f Dockerfile.dev -t company/devops-dev:latest .\n</code></pre><p></p>"},{"location":"build-images/customization/#example-2-security-focused-image","title":"Example 2: Security-Focused Image","text":"<p>Add security scanning and hardening tools:</p> <pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Security scanning tools\nRUN pip3 install --no-cache-dir \\\n    safety \\\n    bandit \\\n    checkov\n\n# Add Snyk CLI\nRUN npm install -g snyk\n\n# Add Syft for SBOM generation\nRUN curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin\n\n# Add Grype for vulnerability scanning\nRUN curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin\n\n# Configure automated scans\nCOPY scan-scripts/ /opt/security-scripts/\nENV PATH=\"/opt/security-scripts:${PATH}\"\n\nLABEL purpose=\"security-scanning\"\n</code></pre>"},{"location":"build-images/customization/#example-3-compliance-audit-image","title":"Example 3: Compliance &amp; Audit Image","text":"<p>Pin all tool versions for regulatory compliance:</p> <pre><code># Build args for version pinning\nARG TERRAFORM_VERSION=1.6.6\nARG PACKER_VERSION=1.10.0\nARG PYTHON_VERSION=3.12\n\nFROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Install specific versions\nRUN curl -fsSL \"https://releases.hashicorp.com/terraform/${TERRAFORM_VERSION}/terraform_${TERRAFORM_VERSION}_linux_amd64.zip\" -o terraform.zip &amp;&amp; \\\n    unzip terraform.zip &amp;&amp; \\\n    mv terraform /usr/local/bin/ &amp;&amp; \\\n    rm terraform.zip\n\nRUN curl -fsSL \"https://releases.hashicorp.com/packer/${PACKER_VERSION}/packer_${PACKER_VERSION}_linux_amd64.zip\" -o packer.zip &amp;&amp; \\\n    unzip packer.zip &amp;&amp; \\\n    mv packer /usr/local/bin/ &amp;&amp; \\\n    rm packer.zip\n\n# Pin Python packages\nCOPY requirements.txt /tmp/\nRUN pip3 install --no-cache-dir -r /tmp/requirements.txt\n\n# Add compliance metadata\nLABEL compliance=\"sox-compliant\"\nLABEL audit.terraform=\"${TERRAFORM_VERSION}\"\nLABEL audit.packer=\"${PACKER_VERSION}\"\n</code></pre> <p>requirements.txt: </p><pre><code>boto3==1.34.12\nansible==9.1.0\ncfn-lint==0.85.0\n</code></pre><p></p>"},{"location":"build-images/customization/#example-4-multi-language-image","title":"Example 4: Multi-Language Image","text":"<p>Add support for additional programming languages:</p> <pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Install Go\nARG GO_VERSION=1.21.5\nRUN curl -fsSL \"https://go.dev/dl/go${GO_VERSION}.linux-amd64.tar.gz\" | tar -C /usr/local -xz\nENV PATH=\"/usr/local/go/bin:${PATH}\"\n\n# Install Rust\nRUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\nENV PATH=\"/root/.cargo/bin:${PATH}\"\n\n# Install Ruby\nRUN dnf install -y ruby ruby-devel &amp;&amp; dnf clean all\nRUN gem install bundler\n\n# Install Java (OpenJDK)\nRUN dnf install -y java-17-openjdk-devel &amp;&amp; dnf clean all\nENV JAVA_HOME=/usr/lib/jvm/java-17-openjdk\n\n# Verify installations\nRUN go version &amp;&amp; \\\n    rustc --version &amp;&amp; \\\n    ruby --version &amp;&amp; \\\n    java -version\n</code></pre>"},{"location":"build-images/customization/#example-5-minimal-image-size-optimised","title":"Example 5: Minimal Image (Size-Optimised)","text":"<p>Remove unnecessary tools to minimise size:</p> <pre><code># Start from scratch with only what you need\nFROM rockylinux:9 AS builder\n\n# Copy only specific tools from official image\nFROM ghcr.io/jinalshah/devops/images/all-devops:latest AS source\n\nFROM rockylinux:9\n\n# Copy only Terraform and kubectl\nCOPY --from=source /usr/local/bin/terraform /usr/local/bin/\nCOPY --from=source /usr/local/bin/kubectl /usr/local/bin/\nCOPY --from=source /usr/local/bin/helm /usr/local/bin/\n\n# Add minimal Python\nRUN dnf install -y python3 &amp;&amp; dnf clean all\n\nCMD [\"/bin/bash\"]\n</code></pre>"},{"location":"build-images/customization/#adding-custom-scripts","title":"Adding Custom Scripts","text":""},{"location":"build-images/customization/#single-script","title":"Single Script","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add custom deployment script\nCOPY deploy.sh /usr/local/bin/deploy\nRUN chmod +x /usr/local/bin/deploy\n</code></pre>"},{"location":"build-images/customization/#script-directory","title":"Script Directory","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Add script directory\nCOPY scripts/ /opt/company-scripts/\nRUN chmod +x /opt/company-scripts/*.sh\n\n# Add to PATH\nENV PATH=\"/opt/company-scripts:${PATH}\"\n</code></pre> <p>Project structure: </p><pre><code>.\n\u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500 scripts/\n    \u251c\u2500\u2500 deploy-app.sh\n    \u251c\u2500\u2500 backup-db.sh\n    \u2514\u2500\u2500 security-scan.sh\n</code></pre><p></p>"},{"location":"build-images/customization/#configuration-management","title":"Configuration Management","text":""},{"location":"build-images/customization/#environment-variables","title":"Environment Variables","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Set company-specific defaults\nENV COMPANY_NAME=\"Acme Corp\"\nENV DEFAULT_AWS_REGION=\"us-west-2\"\nENV DEFAULT_GCP_PROJECT=\"acme-prod\"\nENV TERRAFORM_BACKEND=\"s3://acme-terraform-state\"\n</code></pre>"},{"location":"build-images/customization/#configuration-files","title":"Configuration Files","text":"<pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Copy configuration files\nCOPY configs/.terraformrc /root/.terraformrc\nCOPY configs/.ansible.cfg /root/.ansible.cfg\nCOPY configs/.gitconfig /root/.gitconfig\n\n# Copy custom shell config\nCOPY configs/.zshrc.custom /root/.zshrc.d/company.zsh\n</code></pre>"},{"location":"build-images/customization/#build-args-for-flexibility","title":"Build Args for Flexibility","text":""},{"location":"build-images/customization/#define-build-args","title":"Define Build Args","text":"<pre><code>ARG BASE_IMAGE=ghcr.io/jinalshah/devops/images/all-devops:latest\nARG PYTHON_PACKAGES=\"requests pyyaml\"\nARG NODE_PACKAGES=\"prettier eslint\"\n\nFROM ${BASE_IMAGE}\n\nRUN pip3 install --no-cache-dir ${PYTHON_PACKAGES}\nRUN npm install -g ${NODE_PACKAGES}\n</code></pre>"},{"location":"build-images/customization/#build-with-custom-args","title":"Build with Custom Args","text":"<pre><code>docker build \\\n  --build-arg BASE_IMAGE=ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  --build-arg PYTHON_PACKAGES=\"boto3 requests\" \\\n  --build-arg NODE_PACKAGES=\"serverless webpack\" \\\n  -t my-custom-devops:latest \\\n  .\n</code></pre>"},{"location":"build-images/customization/#best-practices","title":"Best Practices","text":""},{"location":"build-images/customization/#layer-optimisation","title":"Layer Optimisation","text":"<p>Minimise Layers</p> <p>Combine RUN commands to reduce layers:</p> <p>Bad (3 layers): </p><pre><code>RUN pip3 install requests\nRUN pip3 install pyyaml\nRUN pip3 install boto3\n</code></pre><p></p> <p>Good (1 layer): </p><pre><code>RUN pip3 install --no-cache-dir \\\n    requests \\\n    pyyaml \\\n    boto3\n</code></pre><p></p>"},{"location":"build-images/customization/#cache-busting","title":"Cache Busting","text":"<pre><code># Add this to force rebuild from this point\nARG CACHE_BUST=1\n\n# Subsequent layers will rebuild\nCOPY requirements.txt /tmp/\nRUN pip3 install -r /tmp/requirements.txt\n</code></pre>"},{"location":"build-images/customization/#version-pinning","title":"Version Pinning","text":"<p>Always Pin Versions</p> <p>Bad (unpredictable): </p><pre><code>RUN pip3 install requests\n</code></pre><p></p> <p>Good (reproducible): </p><pre><code>RUN pip3 install requests==2.31.0\n</code></pre><p></p>"},{"location":"build-images/customization/#cleanup-after-install","title":"Cleanup After Install","text":"<pre><code>RUN dnf install -y httpd-tools &amp;&amp; \\\n    dnf clean all &amp;&amp; \\\n    rm -rf /var/cache/dnf/*\n</code></pre>"},{"location":"build-images/customization/#use-dockerignore","title":"Use .dockerignore","text":"<p><code>.dockerignore</code>: </p><pre><code>.git\n.github\n*.md\ntests/\ndocs/\n.env\n.DS_Store\n</code></pre><p></p>"},{"location":"build-images/customization/#testing-custom-images","title":"Testing Custom Images","text":""},{"location":"build-images/customization/#validation-script","title":"Validation Script","text":"<pre><code>#!/bin/bash\n# test-custom-image.sh\n\nIMAGE=$1\n\necho \"Testing $IMAGE...\"\n\n# Test base tools\ndocker run --rm $IMAGE terraform version || exit 1\ndocker run --rm $IMAGE kubectl version --client || exit 1\n\n# Test custom additions\ndocker run --rm $IMAGE python3 -c \"import requests; print(requests.__version__)\" || exit 1\ndocker run --rm $IMAGE node -e \"console.log(require('prettier').version)\" || exit 1\n\n# Test custom scripts\ndocker run --rm $IMAGE which deploy || exit 1\n\necho \"\u2705 All tests passed!\"\n</code></pre>"},{"location":"build-images/customization/#run-tests","title":"Run Tests","text":"<pre><code>docker build -t my-devops:test .\n./test-custom-image.sh my-devops:test\n</code></pre>"},{"location":"build-images/customization/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"build-images/customization/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Build Custom Image\n\non:\n  push:\n    branches: [main]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Build custom image\n        run: |\n          docker build -t company/devops-custom:${{ github.sha }} .\n\n      - name: Test image\n        run: |\n          ./test-custom-image.sh company/devops-custom:${{ github.sha }}\n\n      - name: Push to registry\n        run: |\n          echo \"${{ secrets.GITHUB_TOKEN }}\" | docker login ghcr.io -u ${{ github.actor }} --password-stdin\n          docker push company/devops-custom:${{ github.sha }}\n</code></pre>"},{"location":"build-images/customization/#gitlab-ci","title":"GitLab CI","text":"<pre><code>build-custom:\n  stage: build\n  image: docker:latest\n  services:\n    - docker:dind\n  script:\n    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA .\n    - docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA\n</code></pre>"},{"location":"build-images/customization/#security-considerations","title":"Security Considerations","text":""},{"location":"build-images/customization/#scan-custom-images","title":"Scan Custom Images","text":"<pre><code># Scan with Trivy\ndocker run --rm \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  aquasec/trivy image my-devops:latest\n</code></pre>"},{"location":"build-images/customization/#sign-images","title":"Sign Images","text":"<pre><code># Sign with Docker Content Trust\nexport DOCKER_CONTENT_TRUST=1\ndocker push my-devops:latest\n</code></pre>"},{"location":"build-images/customization/#use-secrets-properly","title":"Use Secrets Properly","text":"<p>Never Bake Secrets</p> <p>Never do this: </p><pre><code>ENV API_KEY=\"secret-key-here\"\n</code></pre><p></p> <p>Instead, pass at runtime: </p><pre><code>docker run -e API_KEY=\"$API_KEY\" my-devops:latest\n</code></pre><p></p>"},{"location":"build-images/customization/#maintenance-strategy","title":"Maintenance Strategy","text":""},{"location":"build-images/customization/#automated-rebuilds","title":"Automated Rebuilds","text":"<pre><code># .github/workflows/rebuild.yml\nname: Rebuild Custom Image\n\non:\n  schedule:\n    - cron: '0 2 * * 1'  # Weekly, Monday 2 AM\n  workflow_dispatch:\n\njobs:\n  rebuild:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Pull latest base\n        run: docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n\n      - name: Build custom image\n        run: docker build -t my-devops:latest .\n\n      - name: Test\n        run: ./test-custom-image.sh my-devops:latest\n\n      - name: Push\n        run: docker push my-devops:latest\n</code></pre>"},{"location":"build-images/customization/#version-tracking","title":"Version Tracking","text":"<p>Add labels: </p><pre><code>LABEL base.image=\"ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\"\nLABEL custom.version=\"1.2.0\"\nLABEL custom.build-date=\"2025-01-15\"\nLABEL custom.maintainer=\"devops@company.com\"\n</code></pre><p></p> <p>Check labels: </p><pre><code>docker inspect my-devops:latest | jq '.[0].Config.Labels'\n</code></pre><p></p>"},{"location":"build-images/customization/#troubleshooting","title":"Troubleshooting","text":"Custom package installation fails <p>Problem: Package not found or version incompatible</p> <p>Solutions:</p> <ol> <li> <p>Check package exists:    </p><pre><code>docker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  pip3 search package-name\n</code></pre><p></p> </li> <li> <p>Try different version:    </p><pre><code>RUN pip3 install package-name==1.2.3\n</code></pre><p></p> </li> <li> <p>Install from source:    </p><pre><code>RUN pip3 install git+https://github.com/user/package.git@v1.2.3\n</code></pre><p></p> </li> </ol> Image size too large <p>Problem: Custom image exceeds expected size</p> <p>Solutions:</p> <ol> <li> <p>Check layer sizes:    </p><pre><code>docker history my-devops:latest\n</code></pre><p></p> </li> <li> <p>Use multi-stage builds:    </p><pre><code>FROM builder AS build\n# Build steps\n\nFROM ghcr.io/jinalshah/devops/images/all-devops:latest\nCOPY --from=build /app /app\n</code></pre><p></p> </li> <li> <p>Clean up in same layer:    </p><pre><code>RUN pip3 install package &amp;&amp; \\\n    rm -rf /root/.cache/pip\n</code></pre><p></p> </li> </ol> Build fails with permission errors <p>Problem: Cannot write files or install packages</p> <p>Solutions:</p> <ol> <li> <p>Run as root (default in Dockerfile):    </p><pre><code>USER root\nRUN dnf install -y package\n</code></pre><p></p> </li> <li> <p>Fix ownership after:    </p><pre><code>RUN chown -R root:root /opt/custom-dir\n</code></pre><p></p> </li> </ol>"},{"location":"build-images/customization/#example-repository-structure","title":"Example Repository Structure","text":"<pre><code>custom-devops-image/\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 Dockerfile.dev\n\u251c\u2500\u2500 Dockerfile.prod\n\u251c\u2500\u2500 .dockerignore\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 build.yml\n\u251c\u2500\u2500 configs/\n\u2502   \u251c\u2500\u2500 .terraformrc\n\u2502   \u251c\u2500\u2500 .ansible.cfg\n\u2502   \u2514\u2500\u2500 .gitconfig\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 deploy.sh\n\u2502   \u251c\u2500\u2500 backup.sh\n\u2502   \u2514\u2500\u2500 security-scan.sh\n\u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 test-image.sh\n\u251c\u2500\u2500 requirements.txt\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"build-images/customization/#next-steps","title":"Next Steps","text":"<ul> <li>Build Images Guide - Building from source</li> <li>Optimisation Guide - Reduce image size</li> <li>Multi-Platform Images - Build for multiple architectures</li> <li>Architecture Overview - Understand image layers</li> </ul>"},{"location":"build-images/gcp-devops/","title":"Build: GCP DevOps","text":""},{"location":"build-images/gcp-devops/#build-gcp-devops","title":"Build: GCP DevOps","text":""},{"location":"build-images/gcp-devops/#local-build","title":"Local Build","text":"<pre><code>docker build --target gcp-devops -t gcp-devops:local .\n</code></pre>"},{"location":"build-images/gcp-devops/#run","title":"Run","text":"<pre><code>docker run -it --rm gcp-devops:local\n</code></pre>"},{"location":"build-images/gcp-devops/#quick-verification","title":"Quick Verification","text":"<pre><code>docker run --rm gcp-devops:local gcloud --version\ndocker run --rm gcp-devops:local kubectl version --client\ndocker run --rm gcp-devops:local helm version\n</code></pre>"},{"location":"build-images/gcp-devops/#example-with-local-gcp-credentials","title":"Example With Local GCP Credentials","text":"<pre><code>docker run -it --rm -v ~/.config/gcloud:/root/.config/gcloud gcp-devops:local gcloud auth list\n</code></pre>"},{"location":"build-images/multi-platform-images/","title":"Multi-platform Images","text":""},{"location":"build-images/multi-platform-images/#multi-platform-images","title":"Multi-platform Images","text":"<p>The CI workflow publishes multi-arch images for <code>linux/amd64</code> and <code>linux/arm64</code>. This page shows how to reproduce that locally.</p>"},{"location":"build-images/multi-platform-images/#create-and-use-a-buildx-builder","title":"Create and Use a Buildx Builder","text":"<pre><code>docker buildx create --name devops-multiarch --use --driver docker-container\ndocker buildx inspect --bootstrap\n</code></pre>"},{"location":"build-images/multi-platform-images/#build-and-load-a-single-platform-locally","title":"Build and Load a Single Platform Locally","text":"<p>Use this when you want a fast local test on your current architecture.</p> <pre><code>docker buildx build \\\n  --platform linux/amd64 \\\n  --target all-devops \\\n  -t all-devops:amd64-local \\\n  --load .\n</code></pre>"},{"location":"build-images/multi-platform-images/#build-and-push-multi-arch-to-a-registry","title":"Build and Push Multi-arch to a Registry","text":"<pre><code>export IMAGE=\"ghcr.io/jinalshah/devops/images/all-devops\"\nexport VERSION=\"1.0.$(git rev-parse --short HEAD)\"\n\ndocker buildx build \\\n  --platform linux/amd64,linux/arm64 \\\n  --target all-devops \\\n  -t \"$IMAGE:$VERSION\" \\\n  -t \"$IMAGE:latest\" \\\n  --push .\n</code></pre> <p>Repeat the same pattern for:</p> <ul> <li><code>ghcr.io/jinalshah/devops/images/aws-devops</code></li> <li><code>ghcr.io/jinalshah/devops/images/gcp-devops</code></li> <li><code>registry.gitlab.com/jinal-shah/devops/images/&lt;image&gt;</code></li> <li><code>js01/&lt;image&gt;</code></li> </ul>"},{"location":"build-images/multi-platform-images/#verify-manifest-and-platforms","title":"Verify Manifest and Platforms","text":"<pre><code>docker buildx imagetools inspect ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"build-images/multi-platform-images/#notes","title":"Notes","text":"<ul> <li><code>--load</code> supports single-platform output into local Docker engine.</li> <li>Multi-platform output generally requires <code>--push</code> (registry output).</li> <li>Prefer immutable version tags in automation.</li> </ul>"},{"location":"build-images/optimization/","title":"Image Size Optimisation","text":""},{"location":"build-images/optimization/#image-size-optimisation","title":"Image Size Optimisation","text":"<p>Learn how to optimise DevOps Image builds for faster pulls, reduced storage, and improved performance.</p>"},{"location":"build-images/optimization/#size-breakdown","title":"Size Breakdown","text":"<p>Understanding where the size comes from helps identify optimisation opportunities:</p> <pre><code>pie title all-devops Size Breakdown (~3.2GB)\n    \"Rocky Linux Base\" : 500\n    \"System Packages (yum)\" : 800\n    \"Python + pip Packages\" : 600\n    \"Cloud CLIs (AWS + GCP)\" : 900\n    \"IaC Tools (Terraform, etc)\" : 300\n    \"Other Tools &amp; Utils\" : 100</code></pre>"},{"location":"build-images/optimization/#component-sizes","title":"Component Sizes","text":"Component Approximate Size Optimisation Potential Rocky Linux 9 Base ~500 MB \u274c Minimal (required base) System Packages ~800 MB \u26a0\ufe0f  Moderate (clean cache) Python + Packages ~600 MB \u2705 High (reduce packages) AWS CLI + gcloud ~900 MB \u2705 High (use single-cloud image) Terraform &amp; IaC Tools ~300 MB \u26a0\ufe0f  Moderate (pin versions) Other Tools ~100 MB \u26a0\ufe0f  Low (essential utils)"},{"location":"build-images/optimization/#quick-wins-reduce-image-size","title":"Quick Wins: Reduce Image Size","text":""},{"location":"build-images/optimization/#1-use-cloud-specific-images","title":"1. Use Cloud-Specific Images","text":"<p>Savings: ~300-400 MB</p> <p>Instead of <code>all-devops</code>, use <code>aws-devops</code> or <code>gcp-devops</code> if you only need one cloud provider.</p> Image Size Cloud Tools Savings all-devops ~3.2 GB AWS + GCP Baseline aws-devops ~2.8 GB AWS only -400 MB gcp-devops ~2.9 GB GCP only -300 MB <pre><code># Instead of\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Use\ndocker pull ghcr.io/jinalshah/devops/images/aws-devops:latest  # If AWS-only\n</code></pre>"},{"location":"build-images/optimization/#2-multi-stage-builds-for-custom-images","title":"2. Multi-Stage Builds for Custom Images","text":"<p>Savings: Variable, can be 500+ MB</p> <p>Build a custom image with only the tools you need:</p> <pre><code># Build stage - includes build tools\nFROM ghcr.io/jinalshah/devops/images/all-devops:latest AS builder\n\n# Install additional tools or build artifacts\nRUN pip3 install --no-cache-dir custom-package\n\n# Final stage - minimal runtime\nFROM rockylinux:9-minimal\n\n# Copy only what you need from builder\nCOPY --from=builder /usr/local/bin/custom-tool /usr/local/bin/\nCOPY --from=builder /usr/bin/terraform /usr/bin/\nCOPY --from=builder /usr/bin/kubectl /usr/bin/\n\n# Your application code\nWORKDIR /workspace\nCMD [\"zsh\"]\n</code></pre>"},{"location":"build-images/optimization/#3-remove-unused-python-packages","title":"3. Remove Unused Python Packages","text":"<p>Savings: ~100-200 MB</p> <pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Remove packages you don't use\nRUN pip3 uninstall -y ansible &amp;&amp; \\\n    yum remove -y ansible &amp;&amp; \\\n    yum clean all\n</code></pre>"},{"location":"build-images/optimization/#4-clean-package-manager-caches","title":"4. Clean Package Manager Caches","text":"<p>Savings: ~50-100 MB</p> <p>Already done in base images, but verify in custom builds:</p> <pre><code>RUN yum install -y package-name &amp;&amp; \\\n    yum clean all &amp;&amp; \\\n    rm -rf /var/cache/yum\n</code></pre>"},{"location":"build-images/optimization/#layer-optimisation-strategies","title":"Layer Optimisation Strategies","text":""},{"location":"build-images/optimization/#order-dockerfile-instructions-by-change-frequency","title":"Order Dockerfile Instructions by Change Frequency","text":"<p>Layers that change less frequently should come first:</p> <p>\u2705 Good: Maximise cache hits</p> <pre><code># 1. Base OS (changes almost never)\nFROM rockylinux:9\n\n# 2. System packages (changes rarely)\nRUN yum install -y git curl wget\n\n# 3. Binary downloads (version updates occasionally)\nRUN curl -LO https://releases.hashicorp.com/terraform/1.7.0/terraform_1.7.0_linux_amd64.zip\n\n# 4. Python packages (moderate change frequency)\nRUN pip3 install ansible\n\n# 5. Application code (changes frequently)\nCOPY scripts/ /usr/local/bin/\n</code></pre> <p>\u274c Bad: Frequent cache invalidation</p> <pre><code>FROM rockylinux:9\n\n# Application code changes frequently, invalidates all subsequent layers\nCOPY scripts/ /usr/local/bin/\n\n# These get rebuilt every time even though they don't change\nRUN yum install -y git curl wget\nRUN pip3 install ansible\n</code></pre>"},{"location":"build-images/optimization/#combine-run-commands","title":"Combine RUN Commands","text":"<p>\u2705 Good: Fewer layers</p> <pre><code>RUN yum install -y \\\n      git \\\n      curl \\\n      wget &amp;&amp; \\\n    yum clean all &amp;&amp; \\\n    rm -rf /var/cache/yum\n</code></pre> <p>\u274c Bad: More layers</p> <pre><code>RUN yum install -y git\nRUN yum install -y curl\nRUN yum install -y wget\nRUN yum clean all\n</code></pre>"},{"location":"build-images/optimization/#use-dockerignore","title":"Use .dockerignore","text":"<p>Prevent unnecessary files from being added to the build context:</p> <pre><code># .dockerignore\n.git\n.github\n*.md\ntests/\n.env\n.env.*\n*.log\n.DS_Store\nnode_modules/\n__pycache__/\n*.pyc\n.terraform/\n*.tfstate\n*.tfstate.backup\n</code></pre> <p>Savings: Faster builds, no impact on image size but improves build performance</p>"},{"location":"build-images/optimization/#build-argument-optimisation","title":"Build Argument Optimisation","text":""},{"location":"build-images/optimization/#pin-versions-for-reproducibility","title":"Pin Versions for Reproducibility","text":"<pre><code># Good - consistent builds\ndocker build \\\n  --build-arg PACKER_VERSION=1.11.2 \\\n  --build-arg PYTHON_VERSION=3.12 \\\n  -t custom-devops:1.0.0 .\n\n# Avoid - unpredictable builds\ndocker build -t custom-devops:latest .\n</code></pre>"},{"location":"build-images/optimization/#use-buildkit-cache-mounts","title":"Use BuildKit Cache Mounts","text":"<p>Savings: Faster rebuilds (not smaller images, but faster iteration)</p> <pre><code># syntax=docker/dockerfile:1\n\nFROM rockylinux:9\n\n# Cache pip downloads across builds\nRUN --mount=type=cache,target=/root/.cache/pip \\\n    pip3 install ansible boto3 requests\n\n# Cache yum packages\nRUN --mount=type=cache,target=/var/cache/yum \\\n    yum install -y git curl wget &amp;&amp; \\\n    yum clean all\n</code></pre> <p>Build with BuildKit:</p> <pre><code>DOCKER_BUILDKIT=1 docker build -t custom-devops:latest .\n</code></pre>"},{"location":"build-images/optimization/#compression-and-export-optimisation","title":"Compression and Export Optimisation","text":""},{"location":"build-images/optimization/#export-and-compress-for-distribution","title":"Export and Compress for Distribution","text":"<pre><code># Save image to tar\ndocker save ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  -o all-devops.tar\n\n# Compress with gzip\ngzip all-devops.tar\n# Result: all-devops.tar.gz (~1.2 GB compressed from ~3.2 GB)\n\n# Or use better compression with zstd\ndocker save ghcr.io/jinalshah/devops/images/all-devops:latest | \\\n  zstd -19 -o all-devops.tar.zst\n# Result: ~1.0 GB with better compression\n</code></pre>"},{"location":"build-images/optimization/#squash-layers-use-with-caution","title":"Squash Layers (Use with Caution)","text":"<p>Savings: Can reduce size by eliminating intermediate layers</p> <pre><code>docker build --squash -t custom-devops:latest .\n</code></pre> <p>Squash Trade-offs</p> <p>Pros:</p> <ul> <li>Single layer = smaller total size</li> <li>Simpler layer structure</li> </ul> <p>Cons:</p> <ul> <li>Loses layer caching benefits</li> <li>Slower rebuilds</li> <li>Harder to debug</li> </ul> <p>Recommendation: Only squash final production images, not development images</p>"},{"location":"build-images/optimization/#build-performance-optimisation","title":"Build Performance Optimisation","text":""},{"location":"build-images/optimization/#parallel-builds","title":"Parallel Builds","text":"<p>Build multiple images simultaneously:</p> <pre><code># Build all variants in parallel\ndocker build --target all-devops -t all-devops:latest . &amp;\ndocker build --target aws-devops -t aws-devops:latest . &amp;\ndocker build --target gcp-devops -t gcp-devops:latest . &amp;\nwait\n</code></pre>"},{"location":"build-images/optimization/#use-buildkit-for-better-performance","title":"Use BuildKit for Better Performance","text":"<p>BuildKit provides:</p> <ul> <li>\u2705 Parallel build stage execution</li> <li>\u2705 Better caching</li> <li>\u2705 Faster builds</li> </ul> <pre><code># Enable BuildKit globally\nexport DOCKER_BUILDKIT=1\n\n# Or per-build\nDOCKER_BUILDKIT=1 docker build -t custom-devops:latest .\n</code></pre>"},{"location":"build-images/optimization/#beforeafter-optimisation-examples","title":"Before/After Optimisation Examples","text":""},{"location":"build-images/optimization/#example-1-aws-only-deployment","title":"Example 1: AWS-Only Deployment","text":"<p>Before: Using <code>all-devops</code></p> <pre><code># Pull time: ~2-3 minutes (3.2 GB)\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>After: Using <code>aws-devops</code></p> <pre><code># Pull time: ~1.5-2 minutes (2.8 GB)\ndocker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre> <p>Savings: ~400 MB, ~30% faster pulls</p>"},{"location":"build-images/optimization/#example-2-custom-build-with-minimal-tools","title":"Example 2: Custom Build with Minimal Tools","text":"<p>Before: Using base image with all tools (~3.2 GB)</p> <p>After: Custom multi-stage build with only Terraform + kubectl</p> <pre><code>FROM ghcr.io/jinalshah/devops/images/all-devops:latest AS base\n\nFROM rockylinux:9-minimal\nCOPY --from=base /usr/bin/terraform /usr/bin/\nCOPY --from=base /usr/bin/kubectl /usr/bin/\nCOPY --from=base /usr/bin/zsh /usr/bin/\nCOPY --from=base /root/.oh-my-zsh /root/.oh-my-zsh\nRUN dnf install -y git curl &amp;&amp; dnf clean all\nWORKDIR /workspace\nCMD [\"zsh\"]\n</code></pre> <p>Result: ~800 MB (75% reduction)</p>"},{"location":"build-images/optimization/#cicd-optimisation","title":"CI/CD Optimisation","text":""},{"location":"build-images/optimization/#1-use-image-caching-in-pipelines","title":"1. Use Image Caching in Pipelines","text":"GitHub ActionsGitLab CI <pre><code>- name: Set up Docker Buildx\n  uses: docker/setup-buildx-action@v3\n\n- name: Build and push\n  uses: docker/build-push-action@v5\n  with:\n    context: .\n    push: true\n    cache-from: type=gha\n    cache-to: type=gha,mode=max\n</code></pre> <pre><code>build:\n  image: docker:latest\n  services:\n    - docker:dind\n  variables:\n    DOCKER_DRIVER: overlay2\n    DOCKER_BUILDKIT: 1\n  script:\n    - docker build --cache-from $CI_REGISTRY_IMAGE:latest -t $CI_REGISTRY_IMAGE:latest .\n</code></pre>"},{"location":"build-images/optimization/#2-pin-image-versions","title":"2. Pin Image Versions","text":"<pre><code># Good - immutable, cacheable\ncontainer:\n  image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n# Avoid - unpredictable, cache invalidation\ncontainer:\n  image: ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"build-images/optimization/#3-pre-pull-images-in-setup","title":"3. Pre-pull Images in Setup","text":"<pre><code># GitHub Actions example\n- name: Pre-pull image\n  run: docker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n- name: Run deployment\n  run: |\n    docker run --rm \\\n      -v $PWD:/workspace \\\n      ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234 \\\n      terraform apply -auto-approve\n</code></pre>"},{"location":"build-images/optimization/#monitoring-image-size","title":"Monitoring Image Size","text":""},{"location":"build-images/optimization/#check-layer-sizes","title":"Check Layer Sizes","text":"<pre><code># View all layers\ndocker history ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# View sizes sorted\ndocker history ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  --no-trunc \\\n  --format \"table {{.Size}}\\t{{.CreatedBy}}\" | \\\n  sort -h -r\n</code></pre>"},{"location":"build-images/optimization/#compare-images","title":"Compare Images","text":"<pre><code># Get image sizes\ndocker images --format \"table {{.Repository}}:{{.Tag}}\\t{{.Size}}\" | \\\n  grep devops\n\n# Expected output:\n# ghcr.io/jinalshah/devops/images/all-devops:latest    3.2GB\n# ghcr.io/jinalshah/devops/images/aws-devops:latest    2.8GB\n# ghcr.io/jinalshah/devops/images/gcp-devops:latest    2.9GB\n</code></pre>"},{"location":"build-images/optimization/#dive-tool-analysis","title":"Dive Tool Analysis","text":"<p>Use dive to analyze layers:</p> <pre><code># Install dive\ndocker pull wagoodman/dive\n\n# Analyze image\ndocker run --rm -it \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  wagoodman/dive:latest \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"build-images/optimization/#optimisation-checklist","title":"Optimisation Checklist","text":"<ul> <li> \u2705 Use cloud-specific image if possible (<code>aws-devops</code> or <code>gcp-devops</code>)</li> <li> \u2705 Remove unused Python packages in custom builds</li> <li> \u2705 Combine RUN commands to reduce layers</li> <li> \u2705 Order Dockerfile by change frequency (base \u2192 app code)</li> <li> \u2705 Use <code>.dockerignore</code> to exclude unnecessary files</li> <li> \u2705 Clean package manager caches (<code>yum clean all</code>)</li> <li> \u2705 Pin versions for reproducible builds</li> <li> \u2705 Use BuildKit cache mounts for faster rebuilds</li> <li> \u2705 Enable DOCKER_BUILDKIT=1</li> <li> \u2705 Use multi-stage builds for custom images</li> <li> \u2705 Pin image versions in CI/CD pipelines</li> <li> \u2705 Pre-pull images in CI/CD setup phase</li> <li> \u2705 Monitor layer sizes with <code>docker history</code></li> </ul>"},{"location":"build-images/optimization/#next-steps","title":"Next Steps","text":"<ul> <li>Customisation Guide - Build your own custom image</li> <li>Build Images Overview - General build instructions</li> <li>Architecture - Understand image composition</li> <li>Choosing an Image - Select the right base image</li> </ul>"},{"location":"build-images/optimization/#additional-resources","title":"Additional Resources","text":"<ul> <li>Docker Best Practices</li> <li>BuildKit Documentation</li> <li>Multi-stage Builds</li> <li>Dive Tool - Layer analysis</li> </ul>"},{"location":"tool-basics/","title":"Tool Basics","text":""},{"location":"tool-basics/#tool-basics","title":"Tool Basics","text":"<p>This comprehensive guide covers all tools included in the images, from basic to advanced usage. Each tool includes a description, common use cases, and practical examples.</p>"},{"location":"tool-basics/#infrastructure-as-code-iac","title":"Infrastructure as Code (IaC)","text":""},{"location":"tool-basics/#terraform","title":"Terraform","text":"<p>What it does: Terraform is an infrastructure as code tool that lets you define and provision infrastructure across cloud providers using declarative configuration files.</p> <p>Available in: All images</p> <p>Common use cases: - Provisioning cloud infrastructure (VMs, networks, storage) - Managing Kubernetes clusters - Multi-cloud deployments - Infrastructure versioning and collaboration</p> <p>Basic usage:</p> <pre><code># Initialize Terraform working directory\nterraform init\n\n# Validate configuration files\nterraform validate\n\n# Preview changes without applying\nterraform plan\n\n# Apply changes to infrastructure\nterraform apply\n\n# Destroy managed infrastructure\nterraform destroy\n\n# Format configuration files\nterraform fmt\n\n# Show current state\nterraform show\n</code></pre> <p>Advanced usage:</p> <pre><code># Use a specific workspace\nterraform workspace select production\nterraform workspace new staging\n\n# Plan with variable file\nterraform plan -var-file=\"prod.tfvars\"\n\n# Apply with auto-approval (CI/CD)\nterraform apply -auto-approve\n\n# Target specific resources\nterraform apply -target=aws_instance.example\n\n# Import existing infrastructure\nterraform import aws_instance.example i-1234567890abcdef0\n</code></pre> <p>Switching Terraform versions:</p> <p>The images include <code>tfswitch</code> for managing Terraform versions:</p> <pre><code># Install and use latest Terraform version\ntfswitch --latest\n\n# Install specific version\ntfswitch 1.7.0\n\n# Use version from .terraform-version file\ntfswitch\n</code></pre>"},{"location":"tool-basics/#terragrunt","title":"Terragrunt","text":"<p>What it does: Terragrunt is a thin wrapper for Terraform that provides extra tools for keeping configurations DRY, managing remote state, and working with multiple modules.</p> <p>Available in: All images</p> <p>Common use cases: - Managing multiple Terraform modules - Keeping backend configuration DRY - Executing commands across multiple modules - Managing dependencies between modules</p> <p>Basic usage:</p> <pre><code># Initialize with Terragrunt\nterragrunt init\n\n# Plan across all modules\nterragrunt run-all plan\n\n# Apply across all modules\nterragrunt run-all apply\n\n# Destroy across all modules\nterragrunt run-all destroy\n</code></pre> <p>Advanced usage:</p> <pre><code># Run plan with specific terragrunt variables\nterragrunt plan --terragrunt-non-interactive\n\n# Execute across modules with dependency awareness\nterragrunt run-all apply --terragrunt-include-external-dependencies\n\n# Validate all configurations\nterragrunt run-all validate\n\n# Show dependency graph\nterragrunt graph-dependencies\n</code></pre>"},{"location":"tool-basics/#tflint","title":"TFLint","text":"<p>What it does: TFLint is a Terraform linter that finds possible errors, warns about deprecated syntax, and enforces best practices.</p> <p>Available in: All images</p> <p>Common use cases: - Catching errors before terraform plan - Enforcing naming conventions - Detecting deprecated syntax - Validating module usage</p> <p>Basic usage:</p> <pre><code># Initialize TFLint (install plugins)\ntflint --init\n\n# Lint current directory\ntflint\n\n# Show all available rules\ntflint --list-rules\n</code></pre> <p>Advanced usage:</p> <pre><code># Lint with specific config file\ntflint --config=.tflint.hcl\n\n# Lint recursively\ntflint --recursive\n\n# Output in different formats\ntflint --format=json\ntflint --format=compact\n\n# Enable specific rule\ntflint --enable-rule=terraform_naming_convention\n</code></pre>"},{"location":"tool-basics/#packer","title":"Packer","text":"<p>What it does: Packer automates the creation of machine images across multiple platforms from a single source configuration.</p> <p>Available in: All images</p> <p>Common use cases: - Building AMIs for AWS - Creating GCP images - Building Docker containers - Creating multi-platform images from one template</p> <p>Basic usage:</p> <pre><code># Initialize Packer configuration (install plugins)\npacker init .\n\n# Validate Packer template\npacker validate .\n\n# Build images\npacker build .\n\n# Build with variable file\npacker build -var-file=\"variables.pkrvars.hcl\" .\n</code></pre> <p>Advanced usage:</p> <pre><code># Build only specific builders\npacker build -only=amazon-ebs.ubuntu .\n\n# Enable debug mode\npacker build -debug .\n\n# Use variables from command line\npacker build -var 'region=us-west-2' -var 'instance_type=t3.micro' .\n\n# Force rebuild\npacker build -force .\n</code></pre>"},{"location":"tool-basics/#kubernetes-and-container-orchestration","title":"Kubernetes and Container Orchestration","text":""},{"location":"tool-basics/#kubectl","title":"kubectl","text":"<p>What it does: kubectl is the command-line tool for interacting with Kubernetes clusters, allowing you to deploy applications, inspect resources, and manage cluster operations.</p> <p>Available in: All images</p> <p>Common use cases: - Managing Kubernetes deployments - Troubleshooting pods and services - Viewing logs and events - Applying manifests</p> <p>Basic usage:</p> <pre><code># Get cluster information\nkubectl cluster-info\n\n# List all contexts\nkubectl config get-contexts\n\n# Switch context\nkubectl config use-context my-cluster\n\n# Get pods in all namespaces\nkubectl get pods -A\n\n# Get specific resource types\nkubectl get deployments\nkubectl get services\nkubectl get nodes\n\n# Describe resource details\nkubectl describe pod &lt;pod-name&gt;\n\n# View logs\nkubectl logs &lt;pod-name&gt;\nkubectl logs &lt;pod-name&gt; -f  # Follow logs\n\n# Execute command in pod\nkubectl exec -it &lt;pod-name&gt; -- /bin/bash\n</code></pre> <p>Advanced usage:</p> <pre><code># Apply configuration from file\nkubectl apply -f deployment.yaml\n\n# Apply all manifests in directory\nkubectl apply -f ./manifests/\n\n# Delete resources\nkubectl delete pod &lt;pod-name&gt;\nkubectl delete -f deployment.yaml\n\n# Scale deployments\nkubectl scale deployment/nginx --replicas=5\n\n# Port forward to pod\nkubectl port-forward pod/&lt;pod-name&gt; 8080:80\n\n# Get resource usage\nkubectl top nodes\nkubectl top pods\n\n# Label and select resources\nkubectl label pods &lt;pod-name&gt; env=production\nkubectl get pods -l env=production\n\n# View events\nkubectl get events --sort-by='.lastTimestamp'\n\n# Create resources imperatively\nkubectl create deployment nginx --image=nginx:latest\nkubectl expose deployment nginx --port=80 --type=LoadBalancer\n</code></pre>"},{"location":"tool-basics/#helm","title":"Helm","text":"<p>What it does: Helm is the package manager for Kubernetes, helping you define, install, and upgrade complex Kubernetes applications using charts.</p> <p>Available in: All images</p> <p>Common use cases: - Installing third-party applications on Kubernetes - Managing application releases and rollbacks - Templating Kubernetes manifests - Sharing application packages</p> <p>Basic usage:</p> <pre><code># Add a chart repository\nhelm repo add bitnami https://charts.bitnami.com/bitnami\nhelm repo add stable https://charts.helm.sh/stable\n\n# Update repository index\nhelm repo update\n\n# Search for charts\nhelm search repo nginx\n\n# Install a chart\nhelm install my-release bitnami/nginx\n\n# List installed releases\nhelm list\nhelm list -A  # All namespaces\n\n# Upgrade a release\nhelm upgrade my-release bitnami/nginx\n\n# Uninstall a release\nhelm uninstall my-release\n</code></pre> <p>Advanced usage:</p> <pre><code># Install with custom values\nhelm install my-release bitnami/nginx -f custom-values.yaml\nhelm install my-release bitnami/nginx --set replicaCount=3\n\n# Show chart values\nhelm show values bitnami/nginx\n\n# Dry-run installation\nhelm install my-release bitnami/nginx --dry-run --debug\n\n# Rollback to previous release\nhelm rollback my-release 1\n\n# Get release history\nhelm history my-release\n\n# Create your own chart\nhelm create my-chart\n\n# Package a chart\nhelm package my-chart\n\n# Lint chart\nhelm lint my-chart\n</code></pre>"},{"location":"tool-basics/#k9s","title":"k9s","text":"<p>What it does: k9s is a terminal-based UI for managing Kubernetes clusters, providing a faster and more intuitive way to observe and interact with your clusters.</p> <p>Available in: All images</p> <p>Common use cases: - Real-time cluster monitoring - Quick resource navigation - Interactive log viewing - Pod management and troubleshooting</p> <p>Basic usage:</p> <pre><code># Launch k9s\nk9s\n\n# Launch in specific namespace\nk9s -n kube-system\n\n# Launch with specific context\nk9s --context my-cluster\n</code></pre> <p>Interactive commands (within k9s): - <code>:pods</code> - View pods - <code>:svc</code> - View services - <code>:deploy</code> - View deployments - <code>:ns</code> - View namespaces - <code>/</code> - Filter resources - <code>l</code> - View logs - <code>d</code> - Describe resource - <code>e</code> - Edit resource - <code>?</code> - Help</p>"},{"location":"tool-basics/#cloud-provider-clis","title":"Cloud Provider CLIs","text":""},{"location":"tool-basics/#aws-cli-aws-devops-and-all-devops","title":"AWS CLI (<code>aws-devops</code> and <code>all-devops</code>)","text":"<p>What it does: The AWS Command Line Interface is a unified tool to manage AWS services from the command line.</p> <p>Available in: <code>aws-devops</code>, <code>all-devops</code></p> <p>Common use cases: - Managing EC2 instances and security groups - Working with S3 buckets - Deploying CloudFormation stacks - Managing IAM users and roles - Querying AWS resources</p> <p>Basic usage:</p> <pre><code># Verify authentication\naws sts get-caller-identity\n\n# List S3 buckets\naws s3 ls\n\n# List EC2 instances\naws ec2 describe-instances\n\n# List available regions\naws ec2 describe-regions\n\n# Get account information\naws iam get-user\n\n# Configure profile\naws configure\n</code></pre> <p>Advanced usage:</p> <pre><code># S3 operations\naws s3 cp file.txt s3://my-bucket/\naws s3 sync ./local-folder s3://my-bucket/remote-folder\naws s3 mb s3://my-new-bucket\n\n# EC2 management\naws ec2 run-instances --image-id ami-12345 --instance-type t3.micro\naws ec2 describe-instances --filters \"Name=tag:Name,Values=MyInstance\"\naws ec2 stop-instances --instance-ids i-1234567890abcdef0\n\n# CloudFormation\naws cloudformation create-stack --stack-name my-stack --template-body file://template.yaml\naws cloudformation describe-stacks --stack-name my-stack\naws cloudformation update-stack --stack-name my-stack --template-body file://template.yaml\n\n# SSM Parameter Store\naws ssm get-parameter --name /my/parameter --with-decryption\naws ssm put-parameter --name /my/parameter --value \"secret\" --type SecureString\n\n# Query with JMESPath\naws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId,State.Name,Tags[?Key==`Name`].Value|[0]]' --output table\n\n# Use different profiles\naws s3 ls --profile production\n\n# Output formats\naws ec2 describe-instances --output json\naws ec2 describe-instances --output table\naws ec2 describe-instances --output yaml\n</code></pre>"},{"location":"tool-basics/#aws-session-manager-plugin-aws-devops-and-all-devops","title":"AWS Session Manager Plugin (<code>aws-devops</code> and <code>all-devops</code>)","text":"<p>What it does: The Session Manager plugin enables you to start interactive sessions with EC2 instances without requiring SSH access or bastion hosts.</p> <p>Available in: <code>aws-devops</code>, <code>all-devops</code></p> <p>Common use cases: - Secure shell access to EC2 instances - Port forwarding to private resources - Session auditing and logging - Bastion-less architecture</p> <p>Basic usage:</p> <pre><code># Start interactive session\naws ssm start-session --target i-1234567890abcdef0\n\n# Port forwarding\naws ssm start-session --target i-1234567890abcdef0 \\\n  --document-name AWS-StartPortForwardingSession \\\n  --parameters '{\"portNumber\":[\"80\"],\"localPortNumber\":[\"8080\"]}'\n\n# Run commands\naws ssm send-command --instance-ids i-1234567890abcdef0 \\\n  --document-name \"AWS-RunShellScript\" \\\n  --parameters 'commands=[\"uptime\"]'\n</code></pre>"},{"location":"tool-basics/#google-cloud-cli-gcp-devops-and-all-devops","title":"Google Cloud CLI (<code>gcp-devops</code> and <code>all-devops</code>)","text":"<p>What it does: The Google Cloud CLI (gcloud) is the primary command-line tool for interacting with Google Cloud Platform services.</p> <p>Available in: <code>gcp-devops</code>, <code>all-devops</code></p> <p>Common use cases: - Managing Compute Engine instances - Working with Cloud Storage - Managing GKE clusters - Deploying Cloud Functions - Managing IAM policies</p> <p>Basic usage:</p> <pre><code># Authenticate\ngcloud auth login\n\n# List authenticated accounts\ngcloud auth list\n\n# Set project\ngcloud config set project my-project-id\n\n# View current configuration\ngcloud config list\n\n# List projects\ngcloud projects list\n\n# List compute instances\ngcloud compute instances list\n\n# List GKE clusters\ngcloud container clusters list\n</code></pre> <p>Advanced usage:</p> <pre><code># Compute Engine operations\ngcloud compute instances create my-instance \\\n  --machine-type=e2-medium \\\n  --zone=us-central1-a \\\n  --image-family=debian-11 \\\n  --image-project=debian-cloud\n\ngcloud compute instances stop my-instance --zone=us-central1-a\ngcloud compute ssh my-instance --zone=us-central1-a\n\n# Cloud Storage operations\ngcloud storage buckets create gs://my-bucket --location=us-central1\ngcloud storage cp file.txt gs://my-bucket/\ngcloud storage ls gs://my-bucket/\n\n# GKE cluster management\ngcloud container clusters create my-cluster --zone=us-central1-a\ngcloud container clusters get-credentials my-cluster --zone=us-central1-a\n\n# IAM management\ngcloud projects get-iam-policy my-project-id\ngcloud projects add-iam-policy-binding my-project-id \\\n  --member='user:email@example.com' \\\n  --role='roles/viewer'\n\n# Cloud Functions\ngcloud functions deploy my-function \\\n  --runtime=python39 \\\n  --trigger-http \\\n  --entry-point=main\n\n# Use different configurations\ngcloud config configurations create production\ngcloud config configurations activate production\n</code></pre>"},{"location":"tool-basics/#configuration-management-and-automation","title":"Configuration Management and Automation","text":""},{"location":"tool-basics/#ansible","title":"Ansible","text":"<p>What it does: Ansible is an agentless automation tool for configuration management, application deployment, and task automation using simple YAML playbooks.</p> <p>Available in: All images</p> <p>Common use cases: - Server configuration and provisioning - Application deployment - Multi-tier orchestration - Cloud resource provisioning</p> <p>Basic usage:</p> <pre><code># Check version\nansible --version\n\n# Ping all hosts\nansible all -m ping -i inventory.ini\n\n# Run ad-hoc command\nansible webservers -a \"uptime\" -i inventory.ini\n\n# Run playbook\nansible-playbook playbook.yml\n\n# Run with inventory file\nansible-playbook -i production.ini playbook.yml\n\n# Check syntax\nansible-playbook --syntax-check playbook.yml\n\n# Dry run\nansible-playbook --check playbook.yml\n</code></pre> <p>Advanced usage:</p> <pre><code># Run with extra variables\nansible-playbook playbook.yml -e \"version=1.2.3 env=production\"\n\n# Limit to specific hosts\nansible-playbook playbook.yml --limit webserver01\n\n# Use vault for secrets\nansible-playbook playbook.yml --ask-vault-pass\nansible-vault encrypt secrets.yml\nansible-vault decrypt secrets.yml\n\n# Tags\nansible-playbook playbook.yml --tags \"configuration,deploy\"\nansible-playbook playbook.yml --skip-tags \"testing\"\n\n# Verbose output\nansible-playbook playbook.yml -v    # verbose\nansible-playbook playbook.yml -vvv  # more verbose\n</code></pre>"},{"location":"tool-basics/#ansible-lint","title":"ansible-lint","text":"<p>What it does: ansible-lint checks Ansible playbooks for best practices, potential errors, and style guidelines.</p> <p>Available in: All images</p> <p>Common use cases: - Validating playbook syntax - Enforcing best practices - Pre-commit checks - CI/CD quality gates</p> <p>Basic usage:</p> <pre><code># Lint a playbook\nansible-lint playbook.yml\n\n# Lint all YAML files in directory\nansible-lint .\n\n# List all rules\nansible-lint -L\n\n# Exclude specific rules\nansible-lint -x 301,302 playbook.yml\n</code></pre>"},{"location":"tool-basics/#pre-commit","title":"pre-commit","text":"<p>What it does: pre-commit is a framework for managing and maintaining multi-language pre-commit hooks, ensuring code quality before commits.</p> <p>Available in: All images</p> <p>Common use cases: - Running linters before commit - Formatting code automatically - Preventing bad commits - Enforcing team standards</p> <p>Basic usage:</p> <pre><code># Install git hook scripts\npre-commit install\n\n# Run all hooks on all files\npre-commit run --all-files\n\n# Run specific hook\npre-commit run terraform-fmt --all-files\n\n# Update hooks to latest versions\npre-commit autoupdate\n\n# Uninstall hooks\npre-commit uninstall\n</code></pre>"},{"location":"tool-basics/#security-and-compliance","title":"Security and Compliance","text":""},{"location":"tool-basics/#trivy","title":"Trivy","text":"<p>What it does: Trivy is a comprehensive security scanner for containers, filesystems, and IaC configurations, detecting vulnerabilities, misconfigurations, and secrets.</p> <p>Available in: All images</p> <p>Common use cases: - Scanning container images for vulnerabilities - Detecting misconfigurations in IaC files - Finding exposed secrets in code - CI/CD security gates</p> <p>Basic usage:</p> <pre><code># Scan container image\ntrivy image nginx:latest\ntrivy image ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Scan filesystem\ntrivy fs /path/to/project\n\n# Scan IaC configurations\ntrivy config ./terraform/\n\n# Scan for secrets\ntrivy fs --scanners secret ./\n</code></pre> <p>Advanced usage:</p> <pre><code># Filter by severity\ntrivy image --severity HIGH,CRITICAL nginx:latest\n\n# Output formats\ntrivy image --format json nginx:latest\ntrivy image --format table nginx:latest\ntrivy image --format sarif nginx:latest\n\n# Ignore unfixed vulnerabilities\ntrivy image --ignore-unfixed nginx:latest\n\n# Use custom policy\ntrivy config --policy ./policy ./terraform/\n\n# Generate compliance report\ntrivy image --compliance docker-cis nginx:latest\n\n# Cache management\ntrivy image --clear-cache\n</code></pre>"},{"location":"tool-basics/#development-and-collaboration","title":"Development and Collaboration","text":""},{"location":"tool-basics/#github-cli-gh","title":"GitHub CLI (gh)","text":"<p>What it does: gh is the official GitHub command-line tool for working with GitHub features like pull requests, issues, and repositories.</p> <p>Available in: All images</p> <p>Common use cases: - Creating and managing pull requests - Managing issues - Repository operations - GitHub Actions workflows - Viewing repository information</p> <p>Basic usage:</p> <pre><code># Authenticate\ngh auth login\n\n# Check authentication status\ngh auth status\n\n# View repository\ngh repo view\n\n# Clone repository\ngh repo clone owner/repo\n\n# Create repository\ngh repo create my-new-repo --public\n\n# List pull requests\ngh pr list\n\n# Create pull request\ngh pr create --title \"Feature\" --body \"Description\"\n\n# View pull request\ngh pr view 123\n\n# List issues\ngh issue list\n\n# Create issue\ngh issue create --title \"Bug\" --body \"Description\"\n</code></pre> <p>Advanced usage:</p> <pre><code># Checkout PR locally\ngh pr checkout 123\n\n# Review PR\ngh pr review 123 --approve\ngh pr review 123 --comment --body \"Looks good\"\n\n# Merge PR\ngh pr merge 123 --squash\n\n# GitHub Actions\ngh workflow list\ngh workflow run image-builder.yml\ngh run list\ngh run view\n\n# Releases\ngh release create v1.0.0 --title \"Version 1.0.0\" --notes \"Release notes\"\ngh release list\n\n# Gists\ngh gist create file.txt\ngh gist list\n</code></pre>"},{"location":"tool-basics/#ghorg","title":"ghorg","text":"<p>What it does: ghorg is a tool for quickly cloning all repositories from a GitHub organization or user.</p> <p>Available in: All images</p> <p>Common use cases: - Backing up organization repositories - Cloning multiple repos for offline work - Syncing organisation codebases - Repository migrations</p> <p>Basic usage:</p> <pre><code># Clone all repos from organization\nghorg clone my-org\n\n# Clone all repos from user\nghorg clone my-username --clone-type=user\n\n# Clone with SSH\nghorg clone my-org --protocol=ssh\n\n# Reclone (update existing clones)\nghorg reclone my-org\n</code></pre>"},{"location":"tool-basics/#task-go-task","title":"Task (go-task)","text":"<p>What it does: Task is a task runner / build tool that aims to be simpler and easier to use than GNU Make, using YAML configuration.</p> <p>Available in: All images</p> <p>Common use cases: - Project build automation - Running development tasks - Multi-step workflows - Cross-platform task execution</p> <p>Basic usage:</p> <pre><code># List available tasks\ntask --list\ntask -l\n\n# Run a task\ntask build\n\n# Run multiple tasks\ntask clean build test\n\n# Run with variables\ntask deploy ENV=production\n</code></pre> <p>Example Taskfile.yml:</p> <pre><code>version: '3'\n\ntasks:\n  build:\n    desc: Build the application\n    cmds:\n      - go build -o app main.go\n\n  test:\n    desc: Run tests\n    cmds:\n      - go test ./...\n\n  deploy:\n    desc: Deploy application\n    cmds:\n      - task: build\n      - ./deploy.sh {{.ENV}}\n</code></pre>"},{"location":"tool-basics/#programming-languages-and-package-managers","title":"Programming Languages and Package Managers","text":""},{"location":"tool-basics/#python-3","title":"Python 3","text":"<p>What it does: Python is a high-level programming language. The images include Python 3.12 with pip for package management.</p> <p>Available in: All images</p> <p>Pre-installed packages: - <code>ansible</code> - Automation framework - <code>ansible-lint</code> - Ansible playbook linter - <code>boto3</code> - AWS SDK (<code>aws-devops</code>, <code>all-devops</code>) - <code>cfn-lint</code> - CloudFormation linter (<code>aws-devops</code>, <code>all-devops</code>) - <code>jmespath</code> - JSON query language - <code>mkdocs-material</code> - Documentation generator - <code>paramiko</code> - SSH library - <code>pre-commit</code> - Git hook framework - <code>pytest</code> - Testing framework (<code>aws-devops</code>, <code>all-devops</code>) - <code>requests</code> - HTTP library (<code>aws-devops</code>, <code>all-devops</code>) - <code>s3cmd</code> - S3 tool (<code>aws-devops</code>, <code>all-devops</code>)</p> <p>Basic usage:</p> <pre><code># Check Python version\npython3 --version\n\n# Run Python script\npython3 script.py\n\n# Install package\npip install package-name\n\n# Install from requirements\npip install -r requirements.txt\n\n# List installed packages\npip list\n\n# Create virtual environment\npython3 -m venv myenv\nsource myenv/bin/activate\n</code></pre>"},{"location":"tool-basics/#nodejs-and-npm","title":"Node.js and npm","text":"<p>What it does: Node.js is a JavaScript runtime built on Chrome's V8 engine. npm is the package manager for Node.js.</p> <p>Available in: All images (LTS version)</p> <p>Common use cases: - Running JavaScript applications - Building web applications - Installing development tools - Package management</p> <p>Basic usage:</p> <pre><code># Check versions\nnode --version\nnpm --version\nnpx --version\n\n# Run JavaScript file\nnode app.js\n\n# Initialize new project\nnpm init\nnpm init -y  # Skip prompts\n\n# Install packages\nnpm install express\nnpm install -g @angular/cli  # Global installation\n\n# Install from package.json\nnpm install\n\n# Run scripts\nnpm start\nnpm test\nnpm run build\n</code></pre>"},{"location":"tool-basics/#ai-and-code-assistant-clis","title":"AI and Code Assistant CLIs","text":""},{"location":"tool-basics/#claude-cli","title":"Claude CLI","text":"<p>What it does: Official CLI for Anthropic's Claude AI assistant for code generation, analysis, and automation.</p> <p>Available in: All images</p> <p>Common use cases: - Code generation and refactoring - Documentation generation - Code review assistance - Automated problem solving</p> <p>Basic usage:</p> <pre><code># Check version (requires authentication for full functionality)\nclaude --version\n\n# Authenticate\nclaude auth login\n\n# Ask questions\nclaude \"Explain this function\" --file main.py\n\n# Generate code\nclaude \"Create a Python function to parse JSON\"\n</code></pre> <p>Note: Requires authentication via <code>~/.claude</code> configuration. Mount this directory when running the container.</p>"},{"location":"tool-basics/#openai-codex-cli","title":"OpenAI Codex CLI","text":"<p>What it does: CLI tool for OpenAI's Codex model for code generation and completion.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Check installation\ncodex --version\n\n# Note: Requires OpenAI API key and authentication\n</code></pre> <p>Note: Requires authentication configuration. Mount <code>~/.codex</code> when running the container.</p>"},{"location":"tool-basics/#github-copilot-cli","title":"GitHub Copilot CLI","text":"<p>What it does: Command-line interface for GitHub Copilot to get code suggestions directly in the terminal.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Check installation\ncopilot --version\n\n# Note: Requires GitHub Copilot subscription and authentication\n</code></pre> <p>Note: Requires GitHub authentication. Mount <code>~/.copilot</code> when running the container.</p>"},{"location":"tool-basics/#google-gemini-cli","title":"Google Gemini CLI","text":"<p>What it does: CLI interface for Google's Gemini AI model for code assistance and generation.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Check installation\ngemini --version\n\n# Note: Requires Google Cloud authentication and API access\n</code></pre> <p>Note: Requires Google Cloud credentials. Mount <code>~/.gemini</code> when running the container.</p>"},{"location":"tool-basics/#database-clients","title":"Database Clients","text":""},{"location":"tool-basics/#mongodb-shell-mongosh","title":"MongoDB Shell (mongosh)","text":"<p>What it does: mongosh is the modern MongoDB shell for connecting to and interacting with MongoDB databases.</p> <p>Available in: All images (MongoDB 6.0 compatible)</p> <p>Common use cases: - Connecting to MongoDB instances - Running database queries - Database administration - Data import/export</p> <p>Basic usage:</p> <pre><code># Connect to local MongoDB\nmongosh\n\n# Connect to remote MongoDB\nmongosh \"mongodb://username:password@hostname:27017/database\"\n\n# Connect with connection string\nmongosh \"mongodb+srv://cluster.mongodb.net/myDatabase\"\n\n# Run command\nmongosh --eval \"db.adminCommand('listDatabases')\"\n</code></pre> <p>Interactive commands:</p> <pre><code>// Show databases\nshow dbs\n\n// Use database\nuse mydb\n\n// Show collections\nshow collections\n\n// Query documents\ndb.mycollection.find()\ndb.mycollection.findOne({ name: \"John\" })\n\n// Insert document\ndb.mycollection.insertOne({ name: \"Jane\", age: 30 })\n\n// Update document\ndb.mycollection.updateOne({ name: \"Jane\" }, { $set: { age: 31 } })\n\n// Delete document\ndb.mycollection.deleteOne({ name: \"Jane\" })\n</code></pre>"},{"location":"tool-basics/#postgresql-client-psql","title":"PostgreSQL Client (psql)","text":"<p>What it does: psql is the interactive terminal client for PostgreSQL databases.</p> <p>Available in: All images (PostgreSQL 17)</p> <p>Common use cases: - Connecting to PostgreSQL databases - Running SQL queries - Database administration - Schema management</p> <p>Basic usage:</p> <pre><code># Connect to local PostgreSQL\npsql -U username -d database\n\n# Connect to remote PostgreSQL\npsql -h hostname -U username -d database -p 5432\n\n# Run SQL file\npsql -U username -d database -f script.sql\n\n# Run single command\npsql -U username -d database -c \"SELECT version();\"\n\n# Export query results\npsql -U username -d database -c \"SELECT * FROM users;\" -o output.txt\n</code></pre> <p>Interactive commands:</p> <pre><code>-- List databases\n\\l\n\n-- Connect to database\n\\c database_name\n\n-- List tables\n\\dt\n\n-- Describe table\n\\d table_name\n\n-- List schemas\n\\dn\n\n-- Execute SQL file\n\\i script.sql\n\n-- Quit\n\\q\n</code></pre>"},{"location":"tool-basics/#mysql-client","title":"MySQL Client","text":"<p>What it does: mysql is the command-line client for MySQL and MariaDB databases.</p> <p>Available in: All images</p> <p>Common use cases: - Connecting to MySQL/MariaDB databases - Running SQL queries - Database imports and exports - Schema management</p> <p>Basic usage:</p> <pre><code># Connect to MySQL\nmysql -u username -p -h hostname database\n\n# Execute SQL file\nmysql -u username -p database &lt; script.sql\n\n# Execute command\nmysql -u username -p -e \"SHOW DATABASES;\"\n\n# Dump database\nmysqldump -u username -p database &gt; backup.sql\n</code></pre>"},{"location":"tool-basics/#network-and-diagnostic-tools","title":"Network and Diagnostic Tools","text":""},{"location":"tool-basics/#dig-dns-lookup","title":"dig (DNS lookup)","text":"<p>What it does: dig is a flexible DNS lookup utility for querying DNS name servers.</p> <p>Available in: All images (part of bind-utils)</p> <p>Common use cases: - DNS troubleshooting - Checking DNS records - Verifying DNS propagation - Diagnosing DNS issues</p> <p>Basic usage:</p> <pre><code># Basic lookup\ndig google.com\n\n# Query specific record type\ndig google.com A\ndig google.com MX\ndig google.com TXT\ndig google.com NS\n\n# Query specific nameserver\ndig @8.8.8.8 google.com\n\n# Reverse DNS lookup\ndig -x 8.8.8.8\n\n# Short output\ndig google.com +short\n\n# Trace DNS path\ndig google.com +trace\n</code></pre>"},{"location":"tool-basics/#nslookup","title":"nslookup","text":"<p>What it does: nslookup is a network administration tool for querying Domain Name System records.</p> <p>Available in: All images (part of bind-utils)</p> <p>Basic usage:</p> <pre><code># Basic lookup\nnslookup google.com\n\n# Query specific nameserver\nnslookup google.com 8.8.8.8\n\n# Interactive mode\nnslookup\n&gt; server 8.8.8.8\n&gt; set type=MX\n&gt; google.com\n&gt; exit\n</code></pre>"},{"location":"tool-basics/#ncat-netcat","title":"ncat (Netcat)","text":"<p>What it does: ncat is a networking utility for reading, writing, and redirecting data across network connections.</p> <p>Available in: All images (part of nmap-ncat)</p> <p>Common use cases: - Port scanning - Network debugging - Banner grabbing - Simple TCP/UDP connections</p> <p>Basic usage:</p> <pre><code># Check version\nncat --version\n\n# Connect to host and port\nncat google.com 80\n\n# Listen on port\nncat -l 8080\n\n# Port scan\nncat -zv hostname 20-100\n\n# Simple chat\n# Server: ncat -l 9999\n# Client: ncat hostname 9999\n\n# Transfer file\n# Server: ncat -l 9999 &gt; received_file\n# Client: ncat hostname 9999 &lt; file_to_send\n</code></pre>"},{"location":"tool-basics/#telnet","title":"telnet","text":"<p>What it does: telnet is a network protocol tool for bidirectional interactive text-oriented communication.</p> <p>Available in: All images</p> <p>Common use cases: - Testing TCP connections - Checking port availability - Debugging network services - Simple protocol testing</p> <p>Basic usage:</p> <pre><code># Connect to host and port\ntelnet hostname 80\n\n# Test SMTP\ntelnet mail.example.com 25\n\n# Test HTTP\ntelnet google.com 80\nGET / HTTP/1.1\nHost: google.com\n</code></pre>"},{"location":"tool-basics/#curl-and-wget","title":"curl and wget","text":"<p>What it does: curl and wget are command-line tools for transferring data with URLs, supporting various protocols.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># curl examples\ncurl https://api.example.com\ncurl -o file.txt https://example.com/file.txt\ncurl -X POST -H \"Content-Type: application/json\" -d '{\"key\":\"value\"}' https://api.example.com\n\n# wget examples\nwget https://example.com/file.txt\nwget -r https://example.com  # Recursive download\nwget -c https://example.com/large-file.zip  # Resume download\n</code></pre>"},{"location":"tool-basics/#shell-and-terminal-tools","title":"Shell and Terminal Tools","text":""},{"location":"tool-basics/#zsh-default-shell","title":"Zsh (Default Shell)","text":"<p>What it does: Zsh is an extended Unix shell with advanced features and customisation.</p> <p>Available in: All images (default shell)</p> <p>Features: - Oh My Zsh framework pre-installed - Theme: candy - Command completion - Command history - Directory navigation enhancements</p> <p>Basic usage:</p> <pre><code># Start zsh (default shell)\nzsh\n\n# Oh My Zsh configuration file\n~/.zshrc\n</code></pre>"},{"location":"tool-basics/#bash","title":"Bash","text":"<p>What it does: Bash is the GNU Bourne-Again Shell, a widely-used Unix shell.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Start bash\nbash\n\n# Configuration file\n~/.bashrc\n</code></pre>"},{"location":"tool-basics/#fish","title":"Fish","text":"<p>What it does: Fish is a smart and user-friendly command-line shell with autosuggestions and syntax highlighting.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Start fish\nfish\n\n# Interactive configuration\nfish_config\n</code></pre>"},{"location":"tool-basics/#compression-and-archive-tools","title":"Compression and Archive Tools","text":""},{"location":"tool-basics/#zipunzip","title":"zip/unzip","text":"<p>What it does: Tools for creating and extracting ZIP archives.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Create zip archive\nzip archive.zip file1 file2\nzip -r archive.zip directory/\n\n# Extract zip archive\nunzip archive.zip\nunzip archive.zip -d /destination/\n\n# List contents\nunzip -l archive.zip\n</code></pre>"},{"location":"tool-basics/#tar-gzip-bzip2","title":"tar, gzip, bzip2","text":"<p>What it does: Tools for archiving and compression.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Create tar.gz archive\ntar -czf archive.tar.gz directory/\n\n# Extract tar.gz archive\ntar -xzf archive.tar.gz\n\n# Create tar.bz2 archive\ntar -cjf archive.tar.bz2 directory/\n\n# Extract tar.bz2 archive\ntar -xjf archive.tar.bz2\n\n# List contents\ntar -tzf archive.tar.gz\n</code></pre>"},{"location":"tool-basics/#additional-utilities","title":"Additional Utilities","text":""},{"location":"tool-basics/#jq-json-processor","title":"jq (JSON processor)","text":"<p>What it does: jq is a lightweight command-line JSON processor for parsing, filtering, and transforming JSON data.</p> <p>Available in: All images</p> <p>Common use cases: - Parsing API responses - Filtering JSON data - Transforming JSON structures - Pretty-printing JSON</p> <p>Basic usage:</p> <pre><code># Pretty-print JSON\necho '{\"name\":\"John\",\"age\":30}' | jq .\n\n# Extract specific field\necho '{\"name\":\"John\",\"age\":30}' | jq '.name'\n\n# Filter array\necho '[{\"name\":\"John\",\"age\":30},{\"name\":\"Jane\",\"age\":25}]' | jq '.[] | select(.age &gt; 26)'\n\n# Transform data\necho '{\"first\":\"John\",\"last\":\"Doe\"}' | jq '{fullName: \"\\(.first) \\(.last)\"}'\n\n# Read from file\njq '.users[] | .name' data.json\n</code></pre>"},{"location":"tool-basics/#git","title":"Git","text":"<p>What it does: Git is a distributed version control system for tracking changes in source code.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Clone repository\ngit clone https://github.com/user/repo.git\n\n# Basic workflow\ngit add .\ngit commit -m \"Commit message\"\ngit push\n\n# Branch operations\ngit branch feature-branch\ngit checkout feature-branch\ngit merge main\n\n# View status and history\ngit status\ngit log\ngit diff\n</code></pre>"},{"location":"tool-basics/#vim-and-less","title":"vim and less","text":"<p>What it does: Text editors and pagers for viewing and editing files.</p> <p>Available in: All images</p> <p>Basic vim usage:</p> <pre><code># Open file\nvim filename\n\n# Basic commands (in vim)\n# i - Insert mode\n# Esc - Normal mode\n# :w - Save\n# :q - Quit\n# :wq - Save and quit\n</code></pre>"},{"location":"tool-basics/#tree","title":"tree","text":"<p>What it does: tree displays directory structures in a tree-like format.</p> <p>Available in: All images</p> <p>Basic usage:</p> <pre><code># Display directory tree\ntree\n\n# Limit depth\ntree -L 2\n\n# Show hidden files\ntree -a\n\n# Show only directories\ntree -d\n</code></pre>"},{"location":"tool-basics/#authentication-note-for-ai-clis","title":"Authentication Note for AI CLIs","text":"<p>All AI CLI tools (<code>claude</code>, <code>codex</code>, <code>copilot</code>, <code>gemini</code>) require authentication before use. When running containers with these tools:</p> <pre><code>docker run -it --rm \\\n  -v ~/.claude:/root/.claude \\\n  -v ~/.codex:/root/.codex \\\n  -v ~/.copilot:/root/.copilot \\\n  -v ~/.gemini:/root/.gemini \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>Refer to each tool's official documentation for authentication setup.</p>"},{"location":"tool-basics/ai-cli-setup/","title":"AI CLI Setup &amp; Usage","text":""},{"location":"tool-basics/ai-cli-setup/#ai-cli-setup-usage","title":"AI CLI Setup &amp; Usage","text":"<p>Comprehensive guide to setting up and using the AI CLI tools (Claude, Codex, Copilot, Gemini) included in DevOps Images for AI-assisted infrastructure development.</p> <p>Why AI CLI Tools?</p> <ul> <li>Code generation: Generate Infrastructure as Code from natural language</li> <li>Code review: Automated security and best practice reviews</li> <li>Troubleshooting: Debug errors and get solutions</li> <li>Documentation: Auto-generate documentation from code</li> <li>Learning: Get explanations of complex configurations</li> </ul>"},{"location":"tool-basics/ai-cli-setup/#available-ai-clis","title":"Available AI CLIs","text":"Tool Provider Best For API Required claude Anthropic Code review, architecture design, complex reasoning \u2705 Anthropic API Key codex OpenAI Code generation, completion \u2705 OpenAI API Key copilot GitHub IDE integration, inline suggestions \u2705 GitHub Copilot subscription gemini Google Multi-modal tasks, GCP integration \u2705 Google AI API Key"},{"location":"tool-basics/ai-cli-setup/#claude-cli-setup","title":"Claude CLI Setup","text":""},{"location":"tool-basics/ai-cli-setup/#get-api-key","title":"Get API Key","text":"<ol> <li>Visit Anthropic Console</li> <li>Sign up or log in</li> <li>Navigate to API Keys</li> <li>Create new API key</li> <li>Copy the key (starts with <code>sk-ant-</code>)</li> </ol>"},{"location":"tool-basics/ai-cli-setup/#configure-claude-cli","title":"Configure Claude CLI","text":"Interactive SetupEnvironment VariableConfig File <pre><code>docker run -it --rm \\\n  -v ~/.claude:/root/.claude \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude auth login\n</code></pre> <p>Follow the prompts to enter your API key.</p> <pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -e ANTHROPIC_API_KEY=sk-ant-... \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this code\" --file main.tf\n</code></pre> <p>Create <code>~/.claude/config.json</code>: </p><pre><code>{\n  \"api_key\": \"sk-ant-...\"\n}\n</code></pre><p></p> <p>Then mount it: </p><pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p>"},{"location":"tool-basics/ai-cli-setup/#usage-examples","title":"Usage Examples","text":""},{"location":"tool-basics/ai-cli-setup/#code-review","title":"Code Review","text":"<pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this Terraform code for security issues and best practices\" \\\n    --file terraform/main.tf\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#generate-infrastructure-code","title":"Generate Infrastructure Code","text":"<pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Generate Terraform code to create an AWS VPC with 3 public and 3 private subnets\" \\\n    &gt; vpc.tf\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#explain-complex-configuration","title":"Explain Complex Configuration","text":"<pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Explain what this Ansible playbook does\" \\\n    --file ansible/deploy.yml\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#debug-errors","title":"Debug Errors","text":"<pre><code># Save error output\nterraform apply 2&gt;&amp;1 | tee error.log\n\n# Ask Claude to debug\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"This Terraform apply failed. What's wrong and how do I fix it?\" \\\n    --file error.log\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#codex-cli-setup","title":"Codex CLI Setup","text":""},{"location":"tool-basics/ai-cli-setup/#get-api-key_1","title":"Get API Key","text":"<ol> <li>Visit OpenAI Platform</li> <li>Sign up or log in</li> <li>Navigate to API Keys</li> <li>Create new API key</li> <li>Copy the key (starts with <code>sk-</code>)</li> </ol>"},{"location":"tool-basics/ai-cli-setup/#configure-codex-cli","title":"Configure Codex CLI","text":"Environment VariableConfig File <pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -e OPENAI_API_KEY=sk-... \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex \"Generate Python script to list all S3 buckets\"\n</code></pre> <p>Create <code>~/.codex/config.json</code>: </p><pre><code>{\n  \"api_key\": \"sk-...\"\n}\n</code></pre><p></p> <p>Mount it: </p><pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.codex:/root/.codex \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p>"},{"location":"tool-basics/ai-cli-setup/#usage-examples_1","title":"Usage Examples","text":""},{"location":"tool-basics/ai-cli-setup/#generate-scripts","title":"Generate Scripts","text":"<pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.codex:/root/.codex \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex \"Create a bash script to backup PostgreSQL database to S3\" \\\n    &gt; backup.sh\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#code-completion","title":"Code Completion","text":"<pre><code># Complete partial code\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.codex:/root/.codex \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex --complete \\\n    --file partial-script.py\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#github-copilot-cli-setup","title":"GitHub Copilot CLI Setup","text":""},{"location":"tool-basics/ai-cli-setup/#get-access","title":"Get Access","text":"<ol> <li>Subscribe to GitHub Copilot</li> <li>Install GitHub Copilot CLI extension</li> <li>Authenticate with GitHub</li> </ol>"},{"location":"tool-basics/ai-cli-setup/#configure-copilot-cli","title":"Configure Copilot CLI","text":"<pre><code>docker run -it --rm \\\n  -v ~/.copilot:/root/.copilot \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  copilot auth login\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#usage-examples_2","title":"Usage Examples","text":""},{"location":"tool-basics/ai-cli-setup/#suggest-commands","title":"Suggest Commands","text":"<pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.copilot:/root/.copilot \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  copilot suggest \"deploy kubernetes application with helm\"\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#explain-commands","title":"Explain Commands","text":"<pre><code>docker run --rm \\\n  -v ~/.copilot:/root/.copilot \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  copilot explain \"kubectl rollout status deployment/myapp -n production\"\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#gemini-cli-setup","title":"Gemini CLI Setup","text":""},{"location":"tool-basics/ai-cli-setup/#get-api-key_2","title":"Get API Key","text":"<ol> <li>Visit Google AI Studio</li> <li>Sign in with Google account</li> <li>Create API key</li> <li>Copy the key</li> </ol>"},{"location":"tool-basics/ai-cli-setup/#configure-gemini-cli","title":"Configure Gemini CLI","text":"Environment VariableConfig File <pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -e GOOGLE_API_KEY=... \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  gemini \"Generate GCP deployment manager template\"\n</code></pre> <p>Create <code>~/.gemini/config.json</code>: </p><pre><code>{\n  \"api_key\": \"...\"\n}\n</code></pre><p></p> <p>Mount it: </p><pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.gemini:/root/.gemini \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p>"},{"location":"tool-basics/ai-cli-setup/#usage-examples_3","title":"Usage Examples","text":""},{"location":"tool-basics/ai-cli-setup/#gcp-specific-tasks","title":"GCP-Specific Tasks","text":"<pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.gemini:/root/.gemini \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  gemini \"Create a Cloud Run service with auto-scaling\" \\\n    &gt; cloud-run.yaml\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#multi-modal-analysis","title":"Multi-Modal Analysis","text":"<pre><code># Analyze architecture diagram\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.gemini:/root/.gemini \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  gemini \"Describe this infrastructure architecture\" \\\n    --image architecture.png\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#real-world-workflows","title":"Real-World Workflows","text":""},{"location":"tool-basics/ai-cli-setup/#workflow-1-security-first-development","title":"Workflow 1: Security-First Development","text":"<pre><code>#!/bin/bash\n# secure-deploy.sh\n\n# 1. Generate infrastructure code with Claude\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Generate secure AWS EKS cluster with encrypted EBS volumes and VPC endpoints\" \\\n  &gt; eks-cluster.tf\n\n# 2. Review with Claude\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this EKS cluster code for security issues\" \\\n    --file eks-cluster.tf \\\n  &gt; security-review.md\n\n# 3. Scan with Trivy\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy config eks-cluster.tf\n\n# 4. Deploy\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"terraform init &amp;&amp; terraform apply\"\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#workflow-2-ai-assisted-troubleshooting","title":"Workflow 2: AI-Assisted Troubleshooting","text":"<pre><code>#!/bin/bash\n# ai-troubleshoot.sh\n\n# Capture error\nkubectl apply -f deployment.yaml 2&gt;&amp;1 | tee error.log\n\n# Get AI help\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"This Kubernetes deployment failed. Analyze the error and provide a fix.\" \\\n    --file error.log \\\n    --file deployment.yaml \\\n  &gt; solution.md\n\ncat solution.md\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#workflow-3-documentation-generation","title":"Workflow 3: Documentation Generation","text":"<pre><code>#!/bin/bash\n# generate-docs.sh\n\n# Generate README for Terraform module\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Generate comprehensive README.md documentation for this Terraform module\" \\\n    --file main.tf \\\n    --file variables.tf \\\n    --file outputs.tf \\\n  &gt; README.md\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#workflow-4-multi-cloud-translation","title":"Workflow 4: Multi-Cloud Translation","text":"<pre><code># Translate AWS to GCP\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Convert this AWS Terraform code to equivalent GCP resources\" \\\n    --file aws/main.tf \\\n  &gt; gcp/main.tf\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#comparison-matrix","title":"Comparison Matrix","text":""},{"location":"tool-basics/ai-cli-setup/#when-to-use-which-ai-cli","title":"When to Use Which AI CLI?","text":"Use Case Claude Codex Copilot Gemini Security review \u2705 Best \u26a0\ufe0f Good \u26a0\ufe0f Good \u26a0\ufe0f Good Code generation \u2705 Best \u2705 Best \u2705 Best \u2705 Best Architecture design \u2705 Best \u26a0\ufe0f Good \u274c Limited \u26a0\ufe0f Good Troubleshooting \u2705 Best \u26a0\ufe0f Good \u26a0\ufe0f Good \u26a0\ufe0f Good Multi-modal (images) \u274c No \u274c No \u274c No \u2705 Yes GCP-specific tasks \u26a0\ufe0f Good \u26a0\ufe0f Good \u26a0\ufe0f Good \u2705 Best Cost $$ $$ $ Free tier <p>Recommendations:</p> <ul> <li>General DevOps: Claude (best reasoning)</li> <li>Quick code snippets: Codex or Copilot</li> <li>GCP workloads: Gemini</li> <li>Visual analysis: Gemini (only one with multi-modal)</li> </ul>"},{"location":"tool-basics/ai-cli-setup/#best-practices","title":"Best Practices","text":"<p>Effective AI Usage</p> <ol> <li>Be specific: Detailed prompts get better results</li> <li>Provide context: Include relevant files with <code>--file</code></li> <li>Iterate: Refine prompts based on output</li> <li>Review output: Always review AI-generated code</li> <li>Combine tools: Use Trivy/TFLint alongside AI review</li> </ol> <p>Security</p> <ol> <li>Never expose API keys: Use environment variables or mounted config files</li> <li>Review before deploy: AI-generated code should always be reviewed</li> <li>Scan AI output: Run security scanners on generated code</li> <li>Cost awareness: Monitor API usage to avoid unexpected bills</li> <li>Rotate keys: Regularly rotate API keys</li> </ol> <p>Limitations</p> <ul> <li>\u274c AI makes mistakes: Always review output</li> <li>\u274c Not always up-to-date: May suggest deprecated approaches</li> <li>\u274c Context limits: Large files may be truncated</li> <li>\u274c Costs add up: Monitor usage</li> </ul>"},{"location":"tool-basics/ai-cli-setup/#cost-management","title":"Cost Management","text":""},{"location":"tool-basics/ai-cli-setup/#track-usage","title":"Track Usage","text":"<pre><code># Create usage tracking script\ncat &gt; track-ai-usage.sh &lt;&lt;'EOF'\n#!/bin/bash\nDATE=$(date +%Y-%m-%d)\nUSAGE_LOG=\"ai-usage-$DATE.log\"\n\necho \"$(date): Claude API call\" &gt;&gt; $USAGE_LOG\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"$@\"\nEOF\n\nchmod +x track-ai-usage.sh\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#cost-estimates-approximate","title":"Cost Estimates (Approximate)","text":"Provider Model Cost per 1M tokens (input) Cost per 1M tokens (output) Anthropic Claude 3.5 Sonnet $3 $15 OpenAI GPT-4 Turbo $10 $30 GitHub Copilot $10/month (unlimited) N/A Google Gemini Pro Free tier, then $0.50 $1.50"},{"location":"tool-basics/ai-cli-setup/#troubleshooting","title":"Troubleshooting","text":"API key not working <p>Problem: Authentication error when using AI CLI</p> <p>Solutions: 1. Verify API key is correct and active 2. Check config file permissions:    </p><pre><code>chmod 600 ~/.claude/config.json\n</code></pre> 3. Ensure container can access mounted config:    <pre><code>docker run --rm -v ~/.claude:/root/.claude \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ls -la /root/.claude\n</code></pre><p></p> Rate limit exceeded <p>Problem: Too many API requests</p> <p>Solutions: 1. Add delays between requests 2. Upgrade to higher tier plan 3. Batch requests when possible 4. Cache responses locally</p> Context too long <p>Problem: Input file too large for AI model</p> <p>Solutions: 1. Split large files into chunks 2. Provide only relevant sections 3. Use summary/extract approach:    </p><pre><code># First, summarize\nclaude \"Summarize the main components of this file\" --file large-file.tf\n\n# Then, ask specific questions\nclaude \"Review the VPC configuration\" --file large-file.tf\n</code></pre><p></p>"},{"location":"tool-basics/ai-cli-setup/#advanced-integration","title":"Advanced Integration","text":""},{"location":"tool-basics/ai-cli-setup/#pre-commit-hook-with-ai-review","title":"Pre-commit Hook with AI Review","text":"<p><code>.pre-commit-config.yaml</code>:</p> <pre><code>repos:\n  - repo: local\n    hooks:\n      - id: ai-code-review\n        name: AI Code Review\n        entry: ./scripts/ai-review.sh\n        language: system\n        files: \\.(tf|yml|yaml)$\n        pass_filenames: true\n</code></pre> <p><code>scripts/ai-review.sh</code>:</p> <pre><code>#!/bin/bash\nfor file in \"$@\"; do\n  docker run --rm \\\n    -v $PWD:/workspace \\\n    -v ~/.claude:/root/.claude \\\n    -w /workspace \\\n    ghcr.io/jinalshah/devops/images/all-devops:latest \\\n    claude \"Quick security review of this file\" --file \"$file\"\ndone\n</code></pre>"},{"location":"tool-basics/ai-cli-setup/#cicd-integration","title":"CI/CD Integration","text":"<p>See AI-Assisted DevOps Workflows for complete CI/CD integration examples.</p>"},{"location":"tool-basics/ai-cli-setup/#next-steps","title":"Next Steps","text":"<ul> <li>AI-Assisted DevOps Workflows - Complete workflow examples</li> <li>Authentication Guide - Mount AI credentials in containers</li> <li>Multi-Tool Patterns - Combine AI with other DevOps tools</li> <li>Security Workflows - AI + security scanning</li> </ul>"},{"location":"troubleshooting/","title":"Troubleshooting","text":""},{"location":"troubleshooting/#troubleshooting","title":"Troubleshooting","text":"<p>This guide covers common issues and their solutions when working with DevOps Images.</p>"},{"location":"troubleshooting/#image-pull-issues","title":"Image Pull Issues","text":""},{"location":"troubleshooting/#pull-access-denied-or-manifest-unknown","title":"<code>pull access denied</code> or <code>manifest unknown</code>","text":"<p>Symptoms:</p> <pre><code>Error response from daemon: pull access denied for ghcr.io/jinalshah/devops/images/all-devops\n</code></pre> <p>Solutions:</p> <ol> <li>Verify the image path is correct:</li> </ol> <pre><code># Correct paths\nghcr.io/jinalshah/devops/images/all-devops:latest\nregistry.gitlab.com/jinal-shah/devops/images/all-devops:latest\njs01/all-devops:latest\n</code></pre> <ol> <li>Check if you need authentication:</li> </ol> <pre><code># For GHCR\ndocker login ghcr.io\n\n# For GitLab\ndocker login registry.gitlab.com\n\n# For Docker Hub\ndocker login\n</code></pre> <ol> <li>Verify the tag exists:</li> </ol> <pre><code># List available tags on GitHub\ngh api repos/jinalshah/devops-images/pkgs/container/devops%2Fimages%2Fall-devops/versions\n</code></pre> <ol> <li>Try a different registry:</li> </ol> <pre><code># If GHCR fails, try Docker Hub\ndocker pull js01/all-devops:latest\n</code></pre>"},{"location":"troubleshooting/#registry-rate-limits-docker-hub","title":"Registry rate limits (Docker Hub)","text":"<p>Symptoms:</p> <pre><code>Error response from daemon: toomanyrequests: You have reached your pull rate limit\n</code></pre> <p>Solutions:</p> <ol> <li>Use GHCR or GitLab registry instead:</li> </ol> <pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <ol> <li>Authenticate to increase Docker Hub limits:</li> </ol> <pre><code>docker login\n# Then retry pull\n</code></pre> <ol> <li>In CI/CD, use authenticated pulls:</li> </ol> <pre><code># GitHub Actions example\n- name: Login to Docker Hub\n  uses: docker/login-action@v3\n  with:\n    username: ${{ secrets.DOCKERHUB_USERNAME }}\n    password: ${{ secrets.DOCKERHUB_TOKEN }}\n</code></pre>"},{"location":"troubleshooting/#network-timeouts-during-pull","title":"Network timeouts during pull","text":"<p>Solutions:</p> <ol> <li>Retry with exponential backoff in CI:</li> </ol> <pre><code>for i in {1..3}; do\n  docker pull ghcr.io/jinalshah/devops/images/all-devops:latest &amp;&amp; break\n  echo \"Retry $i failed, waiting...\"\n  sleep $((i * 10))\ndone\n</code></pre> <ol> <li> <p>Use a closer registry mirror or CDN</p> </li> <li> <p>Check your network connection and firewall settings</p> </li> </ol>"},{"location":"troubleshooting/#container-runtime-issues","title":"Container Runtime Issues","text":""},{"location":"troubleshooting/#files-created-as-root-on-host","title":"Files created as root on host","text":"<p>Symptoms: Files created by the container are owned by <code>root:root</code> on the host, making them difficult to modify.</p> <p>Solution:</p> <p>Run container with your host user ID:</p> <pre><code>docker run --rm --user \"$(id -u):$(id -g)\" \\\n  -v \"$PWD\":/srv \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform fmt -recursive /srv\n</code></pre> <p>Alternative for persistent containers:</p> <pre><code># Create a wrapper script\ncat &gt; ~/bin/devops &lt;&lt;'EOF'\n#!/bin/bash\ndocker run --rm --user \"$(id -u):$(id -g)\" \\\n  -v \"$PWD\":/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \"$@\"\nEOF\nchmod +x ~/bin/devops\n\n# Now use it\ndevops terraform plan\n</code></pre>"},{"location":"troubleshooting/#permission-denied-on-mounted-volumes","title":"Permission denied on mounted volumes","text":"<p>Symptoms:</p> <pre><code>bash: /srv/script.sh: Permission denied\n</code></pre> <p>Solutions:</p> <ol> <li>Ensure files have execute permissions:</li> </ol> <pre><code>chmod +x script.sh\n</code></pre> <ol> <li>Mount as read-only if you only need to read:</li> </ol> <pre><code>docker run --rm -v \"$PWD\":/srv:ro ghcr.io/jinalshah/devops/images/all-devops:latest cat /srv/file.txt\n</code></pre> <ol> <li>Check SELinux context (on RHEL/CentOS/Fedora):</li> </ol> <pre><code># Add :z or :Z suffix to volume mount\ndocker run --rm -v \"$PWD\":/srv:z ghcr.io/jinalshah/devops/images/all-devops:latest ls /srv\n</code></pre>"},{"location":"troubleshooting/#container-exits-immediately","title":"Container exits immediately","text":"<p>Symptoms: Container starts and exits right away when using <code>docker run -d</code>.</p> <p>Solution:</p> <p>The images default to an interactive shell. Use <code>-it</code> or provide a long-running command:</p> <pre><code># For interactive use\ndocker run -it ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# For background daemon (less common)\ndocker run -d ghcr.io/jinalshah/devops/images/all-devops:latest sleep infinity\n</code></pre>"},{"location":"troubleshooting/#out-of-disk-space","title":"Out of disk space","text":"<p>Symptoms:</p> <pre><code>no space left on device\n</code></pre> <p>Solutions:</p> <ol> <li>Clean up Docker resources:</li> </ol> <pre><code># Remove unused images\ndocker image prune -a\n\n# Remove all unused resources\ndocker system prune -a --volumes\n</code></pre> <ol> <li>Check Docker disk usage:</li> </ol> <pre><code>docker system df\n</code></pre> <ol> <li>Increase Docker Desktop disk allocation (macOS/Windows)</li> </ol>"},{"location":"troubleshooting/#cloud-provider-authentication-issues","title":"Cloud Provider Authentication Issues","text":""},{"location":"troubleshooting/#aws-credentials-not-found","title":"AWS credentials not found","text":"<p>Symptoms:</p> <pre><code>Unable to locate credentials. You can configure credentials by running \"aws configure\"\n</code></pre> <p>Solutions:</p> <ol> <li>Mount AWS credentials directory:</li> </ol> <pre><code>docker run --rm -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre> <ol> <li>Pass credentials as environment variables:</li> </ol> <pre><code>docker run --rm \\\n  -e AWS_ACCESS_KEY_ID \\\n  -e AWS_SECRET_ACCESS_KEY \\\n  -e AWS_SESSION_TOKEN \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre> <ol> <li>Use IAM roles (in EC2/ECS):    Container automatically inherits IAM role when running on AWS infrastructure.</li> </ol>"},{"location":"troubleshooting/#gcp-authentication-failed","title":"GCP authentication failed","text":"<p>Symptoms:</p> <pre><code>ERROR: (gcloud.auth.list) Failed to get authentication\n</code></pre> <p>Solutions:</p> <ol> <li>Mount gcloud config directory:</li> </ol> <pre><code>docker run --rm -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre> <ol> <li>Use service account key file:</li> </ol> <pre><code>docker run --rm \\\n  -v /path/to/service-account.json:/key.json \\\n  -e GOOGLE_APPLICATION_CREDENTIALS=/key.json \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre> <ol> <li>Authenticate inside container:</li> </ol> <pre><code>docker run -it ghcr.io/jinalshah/devops/images/gcp-devops:latest\n# Inside container:\ngcloud auth login\ngcloud auth application-default login\n</code></pre>"},{"location":"troubleshooting/#ssh-key-not-found-for-git-operations","title":"SSH key not found for Git operations","text":"<p>Symptoms:</p> <pre><code>Permission denied (publickey)\n</code></pre> <p>Solutions:</p> <ol> <li>Mount SSH directory:</li> </ol> <pre><code>docker run --rm -v ~/.ssh:/root/.ssh \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  git clone git@github.com:user/repo.git\n</code></pre> <ol> <li>Set correct SSH key permissions:</li> </ol> <pre><code>chmod 600 ~/.ssh/id_rsa\nchmod 644 ~/.ssh/id_rsa.pub\n</code></pre> <ol> <li>Use HTTPS instead of SSH:</li> </ol> <pre><code>git clone https://github.com/user/repo.git\n</code></pre>"},{"location":"troubleshooting/#build-issues","title":"Build Issues","text":""},{"location":"troubleshooting/#architecture-mismatch-errors","title":"Architecture mismatch errors","text":"<p>Symptoms:</p> <pre><code>exec format error\n</code></pre> <p>Solutions:</p> <ol> <li>Use Buildx for cross-platform builds:</li> </ol> <pre><code># Create buildx builder\ndocker buildx create --name multiarch --use\n\n# Build for specific platform\ndocker buildx build --platform linux/arm64 \\\n  --target all-devops \\\n  -t all-devops:arm64 \\\n  --load .\n</code></pre> <ol> <li>Verify your platform:</li> </ol> <pre><code>docker info | grep -i arch\nuname -m\n</code></pre> <ol> <li>Pull platform-specific tag:</li> </ol> <pre><code># For ARM64\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234-arm64\n\n# For AMD64\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234-amd64\n</code></pre>"},{"location":"troubleshooting/#build-fails-on-downloading-tools","title":"Build fails on downloading tools","text":"<p>Symptoms:</p> <pre><code>ERROR: failed to solve: process \"/bin/sh -c wget ...\" did not complete successfully\n</code></pre> <p>Solutions:</p> <ol> <li>Check network connectivity:</li> </ol> <pre><code># Test network in Docker\ndocker run --rm alpine ping -c 3 google.com\n</code></pre> <ol> <li>Retry the build (transient failures):</li> </ol> <pre><code>docker build --target all-devops -t all-devops:local .\n</code></pre> <ol> <li>Build with no cache to force re-download:</li> </ol> <pre><code>docker build --no-cache --target all-devops -t all-devops:local .\n</code></pre> <ol> <li>Check if behind corporate proxy:</li> </ol> <pre><code>docker build \\\n  --build-arg HTTP_PROXY=http://proxy:8080 \\\n  --build-arg HTTPS_PROXY=http://proxy:8080 \\\n  --target all-devops -t all-devops:local .\n</code></pre>"},{"location":"troubleshooting/#custom-build-arg-version-fails","title":"Custom build-arg version fails","text":"<p>Symptoms: Build fails when overriding tool versions with <code>--build-arg</code>.</p> <p>Solutions:</p> <ol> <li> <p>Verify the version exists:    Check the official release pages for the tool you're trying to install.</p> </li> <li> <p>Revert to defaults:</p> </li> </ol> <pre><code>docker build --target all-devops -t all-devops:local .\n</code></pre> <ol> <li>Test one build arg at a time:</li> </ol> <pre><code># Test with single override\ndocker build --build-arg TERRAGRUNT_VERSION=0.68.14 \\\n  --target all-devops -t all-devops:test .\n</code></pre>"},{"location":"troubleshooting/#build-runs-out-of-memory","title":"Build runs out of memory","text":"<p>Symptoms:</p> <pre><code>Killed\n</code></pre> <p>Solutions:</p> <ol> <li> <p>Increase Docker memory limit (Docker Desktop)</p> </li> <li> <p>Build stages separately:</p> </li> </ol> <pre><code># Build base first\ndocker build --target base -t devops-base:local .\n\n# Then build specific image\ndocker build --target all-devops -t all-devops:local .\n</code></pre> <ol> <li>Use build cache:</li> </ol> <pre><code># Subsequent builds will be faster\ndocker build --target all-devops -t all-devops:local .\n</code></pre>"},{"location":"troubleshooting/#tool-specific-issues","title":"Tool-Specific Issues","text":""},{"location":"troubleshooting/#terraform-state-locking-errors","title":"Terraform state locking errors","text":"<p>Symptoms:</p> <pre><code>Error: Error locking state: Error acquiring the state lock\n</code></pre> <p>Solutions:</p> <ol> <li>Ensure proper AWS credentials are mounted:</li> </ol> <pre><code>docker run --rm -v ~/.aws:/root/.aws -v $PWD:/srv \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform force-unlock LOCK_ID\n</code></pre> <ol> <li> <p>Check DynamoDB table exists (for S3 backend)</p> </li> <li> <p>Verify network access to backend</p> </li> </ol>"},{"location":"troubleshooting/#kubectl-context-not-found","title":"Kubectl context not found","text":"<p>Symptoms:</p> <pre><code>The connection to the server localhost:8080 was refused\n</code></pre> <p>Solutions:</p> <ol> <li>Mount kubeconfig:</li> </ol> <pre><code>docker run --rm -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  kubectl get pods\n</code></pre> <ol> <li>Set KUBECONFIG environment variable:</li> </ol> <pre><code>docker run --rm \\\n  -v ~/.kube/custom-config:/kubeconfig \\\n  -e KUBECONFIG=/kubeconfig \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  kubectl get pods\n</code></pre> <ol> <li>Get credentials from cloud provider:</li> </ol> <pre><code># For AWS EKS\naws eks update-kubeconfig --name my-cluster\n\n# For GKE\ngcloud container clusters get-credentials my-cluster --zone us-central1-a\n</code></pre>"},{"location":"troubleshooting/#ai-cli-tools-not-authenticated","title":"AI CLI tools not authenticated","text":"<p>Symptoms:</p> <pre><code>Error: Not authenticated. Please run: claude auth login\n</code></pre> <p>Solutions:</p> <ol> <li>Authenticate on host first:</li> </ol> <pre><code># On your host machine\nclaude auth login\n</code></pre> <ol> <li>Mount config directories:</li> </ol> <pre><code>docker run -it \\\n  -v ~/.claude:/root/.claude \\\n  -v ~/.codex:/root/.codex \\\n  -v ~/.copilot:/root/.copilot \\\n  -v ~/.gemini:/root/.gemini \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <ol> <li>Authenticate inside container:</li> </ol> <pre><code>docker run -it ghcr.io/jinalshah/devops/images/all-devops:latest\n# Inside container:\nclaude auth login\n</code></pre>"},{"location":"troubleshooting/#ansible-inventory-or-playbook-not-found","title":"Ansible inventory or playbook not found","text":"<p>Symptoms:</p> <pre><code>ERROR! the playbook: playbook.yml could not be found\n</code></pre> <p>Solutions:</p> <ol> <li>Mount project directory:</li> </ol> <pre><code>docker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-playbook playbook.yml\n</code></pre> <ol> <li>Use absolute paths:</li> </ol> <pre><code>docker run --rm -v $PWD:/srv \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-playbook /srv/playbook.yml\n</code></pre>"},{"location":"troubleshooting/#documentation-issues","title":"Documentation Issues","text":""},{"location":"troubleshooting/#mkdocs-command-not-found","title":"<code>mkdocs</code> command not found","text":"<p>Solution:</p> <pre><code>python3 -m pip install --upgrade mkdocs-material\nmkdocs serve\n</code></pre>"},{"location":"troubleshooting/#port-8000-already-in-use","title":"Port 8000 already in use","text":"<p>Solution:</p> <pre><code># Use different port\nmkdocs serve -a 0.0.0.0:8080\n\n# Or kill process using port 8000\nlsof -ti:8000 | xargs kill -9\n</code></pre>"},{"location":"troubleshooting/#documentation-not-updating","title":"Documentation not updating","text":"<p>Solutions:</p> <ol> <li>Stop and restart mkdocs:</li> </ol> <pre><code># Stop with Ctrl+C, then restart\nmkdocs serve\n</code></pre> <ol> <li> <p>Clear browser cache or use incognito mode</p> </li> <li> <p>Force rebuild:</p> </li> </ol> <pre><code>mkdocs build --clean\nmkdocs serve\n</code></pre>"},{"location":"troubleshooting/#platform-specific-issues","title":"Platform-Specific Issues","text":""},{"location":"troubleshooting/#apple-silicon-m1m2m3-issues","title":"Apple Silicon (M1/M2/M3) issues","text":"<p>Issue: Wrong architecture pulled</p> <p>Solution:</p> <pre><code># Verify you got ARM64 image\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest uname -m\n# Should output: aarch64\n\n# Force ARM64 if needed\ndocker pull --platform linux/arm64 ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>Issue: Rosetta compatibility mode warnings</p> <p>Solution:</p> <p>Ensure Docker Desktop is using Apple's virtualization framework, not Rosetta.</p>"},{"location":"troubleshooting/#windows-wsl2-issues","title":"Windows WSL2 issues","text":"<p>Issue: Volume mount performance is slow</p> <p>Solutions:</p> <ol> <li>Keep files in WSL2 filesystem:</li> </ol> <pre><code># Work from within WSL2 home directory\ncd ~\ndocker run -v $PWD:/workspace ...\n</code></pre> <ol> <li>Avoid mounting from /mnt/c/ if possible</li> </ol> <p>Issue: Line ending problems</p> <p>Solution:</p> <pre><code># Configure Git to use LF line endings\ngit config --global core.autocrlf input\n</code></pre>"},{"location":"troubleshooting/#linux-permission-issues-with-docker-socket","title":"Linux permission issues with Docker socket","text":"<p>Symptoms:</p> <pre><code>Got permission denied while trying to connect to the Docker daemon socket\n</code></pre> <p>Solutions:</p> <ol> <li>Add user to docker group:</li> </ol> <pre><code>sudo usermod -aG docker $USER\nnewgrp docker\n</code></pre> <ol> <li>Or use sudo (not recommended for regular use):</li> </ol> <pre><code>sudo docker run ...\n</code></pre>"},{"location":"troubleshooting/#getting-additional-help","title":"Getting Additional Help","text":"<p>If you're still experiencing issues:</p>"},{"location":"troubleshooting/#gather-information","title":"Gather Information","text":"<p>Collect the following information:</p> <pre><code># Docker version\ndocker --version\n\n# Host architecture\nuname -m\n\n# Host OS\ncat /etc/os-release  # Linux\nsw_vers              # macOS\n\n# Exact error message\ndocker run ... 2&gt;&amp;1 | tee error.log\n</code></pre>"},{"location":"troubleshooting/#open-an-issue","title":"Open an Issue","text":"<p>Open an issue on GitHub with:</p> <ul> <li>Title: Clear, concise description of the problem</li> <li>Environment: Docker version, host OS, architecture</li> <li>Steps to reproduce: Exact commands you ran</li> <li>Expected behaviour: What should happen</li> <li>Actual behaviour: What actually happened</li> <li>Error output: Full error messages and logs</li> <li>Image and tag: Which image and version you're using</li> </ul> <p>Open an issue \u2192</p>"},{"location":"troubleshooting/#community-resources","title":"Community Resources","text":"<ul> <li>GitHub Discussions</li> <li>Tool-specific documentation</li> <li>Individual tool official documentation</li> </ul>"},{"location":"use-images/","title":"Using the Images","text":""},{"location":"use-images/#using-the-images","title":"Using the Images","text":"<p>This section covers pull, run, and automation patterns from beginner to advanced usage.</p> <p>New to DevOps Images?</p> <p>Start with the Quick Start Guide for a 5-minute introduction, or use the Decision Framework to pick the right image for your needs.</p>"},{"location":"use-images/#pull-an-image","title":"Pull an Image","text":"<p>Choose your preferred registry and image variant:</p> all-devops (Multi-Cloud)aws-devops (AWS-Focused)gcp-devops (GCP-Focused) <p>Best for: Teams using both AWS and GCP, or those who want maximum flexibility</p> GHCR (Recommended)GitLab RegistryDocker Hub <pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>\u2705 No rate limits | \u2705 Fast global CDN | \u2705 Best uptime</p> <pre><code>docker pull registry.gitlab.com/jinal-shah/devops/images/all-devops:latest\n</code></pre> <p>\u2705 GitLab CI native | \u2705 Private runner support</p> <pre><code>docker pull js01/all-devops:latest\n</code></pre> <p>\u26a0\ufe0f  Rate limits: 100 pulls/6h (anonymous)</p> <p>Best for: AWS-only teams who want a smaller image</p> GHCR (Recommended)GitLab RegistryDocker Hub <pre><code>docker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre> <pre><code>docker pull registry.gitlab.com/jinal-shah/devops/images/aws-devops:latest\n</code></pre> <pre><code>docker pull js01/aws-devops:latest\n</code></pre> <p>Best for: GCP-only teams who want a smaller image</p> GHCR (Recommended)GitLab RegistryDocker Hub <pre><code>docker pull ghcr.io/jinalshah/devops/images/gcp-devops:latest\n</code></pre> <pre><code>docker pull registry.gitlab.com/jinal-shah/devops/images/gcp-devops:latest\n</code></pre> <pre><code>docker pull js01/gcp-devops:latest\n</code></pre> <p>Docker Hub Rate Limits</p> <p>Docker Hub enforces rate limits for anonymous users (100 pulls per 6 hours). We recommend using GHCR to avoid these limits.</p>"},{"location":"use-images/#run-interactively","title":"Run Interactively","text":"<p>Basic interactive run:</p> <pre><code>docker run -it --rm ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>The default shell is <code>zsh</code> with Oh My Zsh pre-configured.</p> <p>Shell Options</p> <p>The image includes three shells:</p> <ul> <li>zsh (default) - Modern shell with autocomplete and plugins</li> <li>bash - Traditional Bourne Again Shell</li> <li>fish - Friendly interactive shell</li> </ul> <p>Switch shells with: <code>bash</code>, <code>fish</code>, or <code>zsh</code></p>"},{"location":"use-images/#recommended-workstation-setup","title":"Recommended Workstation Setup","text":"<p>For real work, mount your credentials and project directory:</p> <pre><code>docker run -it --name devops-work \\  # (1)!\n  -v $PWD:/workspace \\  # (2)!\n  -v ~/.ssh:/root/.ssh \\  # (3)!\n  -v ~/.aws:/root/.aws \\  # (4)!\n  -v ~/.config/gcloud:/root/.config/gcloud \\  # (5)!\n  -v ~/.claude:/root/.claude \\  # (6)!\n  -v ~/.codex:/root/.codex \\  # (7)!\n  -v ~/.copilot:/root/.copilot \\  # (8)!\n  -v ~/.gemini:/root/.gemini \\  # (9)!\n  -w /workspace \\  # (10)!\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <ol> <li>Named container for easy restart with <code>docker start -i devops-work</code></li> <li>Mount current directory as <code>/workspace</code> for accessing your project files</li> <li>Mount SSH keys for Git operations and remote server access</li> <li>Mount AWS credentials for <code>aws</code> CLI (omit if not using AWS)</li> <li>Mount GCP credentials for <code>gcloud</code> (omit if not using GCP)</li> <li>Mount Claude AI credentials for <code>claude</code> CLI</li> <li>Mount Codex credentials for <code>codex</code> CLI (OpenAI)</li> <li>Mount Copilot credentials for <code>copilot</code> CLI (GitHub)</li> <li>Mount Gemini credentials for <code>gemini</code> CLI (Google)</li> <li>Set working directory to <code>/workspace</code></li> </ol> <p>Authentication Details</p> <p>For comprehensive authentication setup including AI CLI configuration, see the Authentication Guide.</p>"},{"location":"use-images/#run-tools-without-an-interactive-shell","title":"Run Tools Without an Interactive Shell","text":"<p>Execute single commands without entering a shell:</p> <pre><code># Check tool versions\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest terraform version\ndocker run --rm ghcr.io/jinalshah/devops/images/aws-devops:latest aws --version\ndocker run --rm ghcr.io/jinalshah/devops/images/gcp-devops:latest gcloud --version\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest trivy --version\n</code></pre> <p>One-Liner Examples</p> <pre><code># Run Terraform plan\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform plan\n\n# Scan with Trivy\ndocker run --rm -v $PWD:/workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy fs /workspace\n\n# Run Ansible playbook\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-playbook site.yml\n</code></pre>"},{"location":"use-images/#work-with-local-files","title":"Work With Local Files","text":"<p>Mount your project directory to access files:</p> <pre><code>docker run --rm \\\n  -v \"$PWD:/workspace\" \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-playbook playbook.yml\n</code></pre>"},{"location":"use-images/#avoid-root-owned-files","title":"Avoid Root-Owned Files","text":"<p>To prevent Docker from creating root-owned files on your host:</p> <pre><code>docker run --rm \\\n  --user \"$(id -u):$(id -g)\" \\\n  -v \"$PWD:/workspace\" \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform fmt -recursive\n</code></pre> <p>User Flag Limitations</p> <p>The <code>--user</code> flag may cause permission issues with some tools that expect to run as root. If you encounter errors, run without <code>--user</code> and manually fix permissions afterward:</p> <pre><code>sudo chown -R $(id -u):$(id -g) .\n</code></pre>"},{"location":"use-images/#quick-authentication-examples","title":"Quick Authentication Examples","text":"<p>Basic credential mounting for cloud providers and Git:</p> AWS AuthenticationGCP AuthenticationSSH for Git <pre><code>docker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre> <pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre> <pre><code>docker run --rm \\\n  -v ~/.ssh:/root/.ssh \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  git pull\n</code></pre> <p>Comprehensive Authentication Guide</p> <p>For detailed setup including AI CLI authentication, multiple cloud accounts, and troubleshooting, see the Authentication Guide.</p>"},{"location":"use-images/#version-pinning-for-cicd","title":"Version Pinning for CI/CD","text":"<p>Use Immutable Tags in Production</p> <p>Always pin specific image versions in CI/CD pipelines for reproducible builds:</p> <p>\u2705 Good - Immutable, predictable: </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre><p></p> <p>\u26a0\ufe0f  Avoid - Mutable, can change: </p><pre><code>docker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre><p></p>"},{"location":"use-images/#version-tag-format","title":"Version Tag Format","text":"<ul> <li><code>latest</code> - Most recent build (for local development)</li> <li><code>1.0.abc1234</code> - Semantic version + git commit SHA (for CI/CD)</li> <li><code>1.0</code> - Semantic version only (semi-stable)</li> </ul> <p>Finding Available Tags</p> <p>Check available tags on registries:</p> <ul> <li>GHCR Tags</li> <li>GitLab Tags</li> <li>Docker Hub Tags</li> </ul>"},{"location":"use-images/#cicd-integration-examples","title":"CI/CD Integration Examples","text":""},{"location":"use-images/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Deploy Infrastructure\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234  # (1)!\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure AWS Credentials\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Deploy with Terraform\n        run: |\n          terraform init\n          terraform apply -auto-approve\n</code></pre> <ol> <li>Pin to specific version for reproducible builds</li> </ol>"},{"location":"use-images/#gitlab-ci","title":"GitLab CI","text":"<pre><code>stages:\n  - deploy\n\ndeploy:production:\n  stage: deploy\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - terraform init\n    - terraform apply -auto-approve\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    AWS_DEFAULT_REGION: us-east-1\n  only:\n    - main\n</code></pre> <p>More CI/CD Examples</p> <p>For comprehensive CI/CD integration guides, see:</p> <ul> <li>GitHub Actions Examples</li> <li>GitLab CI Examples</li> <li>Jenkins Examples</li> <li>CircleCI Examples</li> </ul>"},{"location":"use-images/#next-steps","title":"Next Steps","text":"<p>Getting Started:</p> <ul> <li>Quick Start Guide - 5-minute introduction</li> <li>Authentication Setup - Configure credentials</li> <li>Quick Reference - Common command patterns</li> </ul> <p>Cloud-Specific Guides:</p> <ul> <li>Using all-devops - Multi-cloud image</li> <li>Using aws-devops - AWS-focused image</li> <li>Using gcp-devops - GCP-focused image</li> </ul> <p>Advanced Topics:</p> <ul> <li>Docker Compose Examples - Multi-container setups</li> <li>Workflows &amp; Patterns - Real-world examples</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"use-images/all-devops/","title":"All DevOps Image","text":""},{"location":"use-images/all-devops/#all-devops-image","title":"All DevOps Image","text":"<p>The all-devops image is the complete multi-cloud toolkit with both AWS and GCP tools, providing maximum flexibility for teams working across cloud providers.</p> <p>Image Details</p> <p>Size: ~3.2 GB | Architectures: amd64, arm64 | Base: Rocky Linux 9</p>"},{"location":"use-images/all-devops/#when-to-use-this-image","title":"When to Use This Image","text":"<p>\u2705 Perfect for:</p> <ul> <li>Platform teams managing multi-cloud infrastructure (AWS + GCP)</li> <li>Organisations with a hybrid cloud strategy</li> <li>CI/CD pipelines deploying to multiple cloud providers</li> <li>Development teams who need maximum flexibility</li> <li>Exploring both AWS and GCP tools without switching images</li> </ul> <p>\u26a0\ufe0f  Consider alternatives if:</p> <ul> <li>You only use AWS \u2192 Use aws-devops to save ~400 MB</li> <li>You only use GCP \u2192 Use gcp-devops to save ~300 MB</li> <li>Image size is critical \u2192 See optimisation guide</li> </ul>"},{"location":"use-images/all-devops/#pull-the-image","title":"Pull the Image","text":"GHCR (Recommended)GitLab RegistryDocker Hub <pre><code># Latest version\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Pinned version (recommended for CI/CD)\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre> <p>\u2705 No rate limits | \u2705 Fast CDN | \u2705 Best uptime</p> <pre><code># Latest version\ndocker pull registry.gitlab.com/jinal-shah/devops/images/all-devops:latest\n\n# Pinned version\ndocker pull registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n</code></pre> <p>\u2705 Native GitLab CI integration</p> <pre><code># Latest version\ndocker pull js01/all-devops:latest\n\n# Pinned version\ndocker pull js01/all-devops:1.0.abc1234\n</code></pre> <p>\u26a0\ufe0f  Rate limits apply (100 pulls/6h for anonymous users)</p>"},{"location":"use-images/all-devops/#whats-included","title":"What's Included","text":""},{"location":"use-images/all-devops/#infrastructure-as-code","title":"Infrastructure as Code","text":"Tool Version Purpose Terraform Multi-version via tfswitch Infrastructure provisioning Terragrunt Latest DRY Terraform configurations TFLint Latest Terraform linting Packer Latest Image building"},{"location":"use-images/all-devops/#kubernetes-containers","title":"Kubernetes &amp; Containers","text":"Tool Version Purpose kubectl Latest Kubernetes management Helm 3 Latest Kubernetes package manager k9s Latest Kubernetes terminal UI"},{"location":"use-images/all-devops/#aws-tools","title":"AWS Tools \u2601\ufe0f","text":"Tool Purpose AWS CLI v2 AWS service management Session Manager Plugin EC2 instance access without SSH boto3 AWS SDK for Python cfn-lint CloudFormation linting s3cmd S3 operations"},{"location":"use-images/all-devops/#gcp-tools","title":"GCP Tools \u2601\ufe0f","text":"Tool Purpose gcloud GCP service management docker-credential-gcr GCR authentication gsutil Cloud Storage operations (via gcloud)"},{"location":"use-images/all-devops/#configuration-security","title":"Configuration &amp; Security","text":"Tool Purpose Ansible Configuration management ansible-lint Playbook validation Trivy Vulnerability scanning pre-commit Git hook framework Task Modern task runner"},{"location":"use-images/all-devops/#ai-powered-development","title":"AI-Powered Development","text":"Tool Provider Best For claude Anthropic Code review, architecture codex OpenAI Code generation copilot GitHub IDE integration gemini Google Multi-modal, GCP tasks <p>See AI CLI Setup Guide for authentication and usage.</p>"},{"location":"use-images/all-devops/#development-tools","title":"Development Tools","text":"Tool Version Python 3.12 Node.js LTS Git Latest GitHub CLI (gh) Latest jq Latest"},{"location":"use-images/all-devops/#database-clients","title":"Database Clients","text":"Tool Version mongosh v6.0 psql PostgreSQL 17 mysql Latest"},{"location":"use-images/all-devops/#network-utilities","title":"Network &amp; Utilities","text":"<ul> <li>dig, nslookup - DNS troubleshooting</li> <li>ncat, telnet - Network connectivity</li> <li>curl, wget - HTTP clients</li> <li>vim, less - Editors/pagers</li> <li>tree - Directory visualisation</li> </ul>"},{"location":"use-images/all-devops/#quick-start","title":"Quick Start","text":""},{"location":"use-images/all-devops/#interactive-shell","title":"Interactive Shell","text":"<pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.ssh:/root/.ssh \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"use-images/all-devops/#one-liner-commands","title":"One-Liner Commands","text":"<pre><code># Check versions\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest terraform version\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest aws --version\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest gcloud --version\n\n# Verify authentication\ndocker run --rm -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  aws sts get-caller-identity\n\ndocker run --rm -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  gcloud auth list\n</code></pre>"},{"location":"use-images/all-devops/#real-world-examples","title":"Real-World Examples","text":""},{"location":"use-images/all-devops/#multi-cloud-terraform-deployment","title":"Multi-Cloud Terraform Deployment","text":"<p>Deploy infrastructure to both AWS and GCP:</p> <pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    # Deploy AWS infrastructure\n    cd aws/\n    terraform init\n    terraform apply -auto-approve\n\n    # Deploy GCP infrastructure\n    cd ../gcp/\n    terraform init\n    terraform apply -auto-approve\n  \"\n</code></pre>"},{"location":"use-images/all-devops/#multi-cloud-kubernetes-deployment","title":"Multi-Cloud Kubernetes Deployment","text":"<p>Deploy to both EKS and GKE:</p> <pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.kube:/root/.kube \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    # Deploy to EKS\n    aws eks update-kubeconfig --region us-east-1 --name my-eks-cluster\n    helm upgrade --install myapp ./charts/myapp --namespace production\n\n    # Deploy to GKE\n    gcloud container clusters get-credentials my-gke-cluster --region us-central1\n    helm upgrade --install myapp ./charts/myapp --namespace production\n  \"\n</code></pre>"},{"location":"use-images/all-devops/#security-scanning-across-cloud-configs","title":"Security Scanning Across Cloud Configs","text":"<pre><code>docker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    # Scan Terraform configs\n    trivy config ./terraform/aws\n    trivy config ./terraform/gcp\n\n    # Lint CloudFormation\n    cfn-lint ./cloudformation/**/*.yaml\n\n    # Validate Terraform\n    cd terraform/aws &amp;&amp; terraform validate\n    cd ../gcp &amp;&amp; terraform validate\n  \"\n</code></pre>"},{"location":"use-images/all-devops/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"use-images/all-devops/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Multi-Cloud Deploy\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure AWS\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Configure GCP\n        uses: google-github-actions/auth@v2\n        with:\n          credentials_json: ${{ secrets.GCP_SA_KEY }}\n\n      - name: Deploy to AWS\n        run: |\n          cd terraform/aws\n          terraform init\n          terraform apply -auto-approve\n\n      - name: Deploy to GCP\n        run: |\n          cd terraform/gcp\n          terraform init\n          terraform apply -auto-approve\n</code></pre>"},{"location":"use-images/all-devops/#gitlab-ci","title":"GitLab CI","text":"<pre><code>stages:\n  - deploy\n\ndeploy:multi-cloud:\n  stage: deploy\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    # AWS deployment\n    - cd terraform/aws\n    - terraform init\n    - terraform apply -auto-approve\n    # GCP deployment\n    - cd ../gcp\n    - terraform init\n    - terraform apply -auto-approve\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    GOOGLE_APPLICATION_CREDENTIALS: /tmp/gcp-key.json\n  before_script:\n    - echo $GCP_SA_KEY | base64 -d &gt; /tmp/gcp-key.json\n  only:\n    - main\n</code></pre>"},{"location":"use-images/all-devops/#troubleshooting","title":"Troubleshooting","text":"AWS commands failing with 'Unable to locate credentials' <p>Problem: AWS CLI can't find credentials</p> <p>Solution: Ensure ~/.aws is mounted correctly </p><pre><code># Verify mount\ndocker run --rm -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ls -la /root/.aws\n\n# Test authentication\ndocker run --rm -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  aws sts get-caller-identity\n</code></pre><p></p> gcloud commands failing with authentication errors <p>Problem: GCP CLI can't authenticate</p> <p>Solution: Run gcloud auth on host first </p><pre><code># On host machine\ngcloud auth login\ngcloud auth application-default login\n\n# Then use in container\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  gcloud auth list\n</code></pre><p></p> Image pull is slow <p>Problem: Large image size (~3.2 GB)</p> <p>Solutions:</p> <ol> <li>Use GHCR instead of Docker Hub (faster CDN)</li> <li>Consider using aws-devops or gcp-devops if you only need one cloud</li> <li>Pre-pull images in CI/CD setup phase</li> <li>Use pinned versions to leverage Docker layer caching</li> </ol>"},{"location":"use-images/all-devops/#performance-tips","title":"Performance Tips","text":"<p>Optimise for CI/CD</p> <ol> <li>Pin versions: Use immutable tags like <code>1.0.abc1234</code> instead of <code>latest</code></li> <li>Pre-pull images: Pull during CI setup phase, not during actual work</li> <li>Layer caching: Use consistent image versions across pipeline jobs</li> <li>Registry choice: GHCR has the best performance for most regions</li> </ol> <p>Reduce Local Disk Usage</p> <pre><code># Remove old images\ndocker image prune -a\n\n# Or use smaller cloud-specific images\ndocker pull ghcr.io/jinalshah/devops/images/aws-devops:latest  # ~400 MB smaller\n</code></pre>"},{"location":"use-images/all-devops/#next-steps","title":"Next Steps","text":"<ul> <li>Authentication Guide - Set up AWS, GCP, and AI CLI credentials</li> <li>Workflows - Multi-cloud workflow patterns</li> <li>Architecture - Understand what's inside</li> <li>Choosing an Image - Compare all variants</li> </ul>"},{"location":"use-images/authentication/","title":"Authentication &amp; Credentials","text":""},{"location":"use-images/authentication/#authentication-credentials","title":"Authentication &amp; Credentials","text":"<p>Learn how to securely configure cloud provider credentials, SSH keys, and AI CLI authentication when using DevOps Images.</p>"},{"location":"use-images/authentication/#volume-mount-strategy","title":"Volume Mount Strategy","text":"<p>The DevOps Images use volume mounts to access your credentials from the host machine, ensuring secrets never get baked into the container image.</p> <pre><code>graph TB\n    HOST[Host Machine] --&gt; MOUNTS[Volume Mounts]\n\n    subgraph \"Host Credentials\"\n        AWS_H[~/.aws]\n        GCP_H[~/.config/gcloud]\n        SSH_H[~/.ssh]\n        CLAUDE_H[~/.claude]\n        CODEX_H[~/.codex]\n        COPILOT_H[~/.copilot]\n        GEMINI_H[~/.gemini]\n    end\n\n    subgraph \"Container Paths\"\n        AWS_C[/root/.aws]\n        GCP_C[/root/.config/gcloud]\n        SSH_C[/root/.ssh]\n        CLAUDE_C[/root/.claude]\n        CODEX_C[/root/.codex]\n        COPILOT_C[/root/.copilot]\n        GEMINI_C[/root/.gemini]\n    end\n\n    AWS_H -.-&gt;|-v ~/.aws:/root/.aws| AWS_C\n    GCP_H -.-&gt;|-v ~/.config/gcloud:/root/.config/gcloud| GCP_C\n    SSH_H -.-&gt;|-v ~/.ssh:/root/.ssh| SSH_C\n    CLAUDE_H -.-&gt;|-v ~/.claude:/root/.claude| CLAUDE_C\n    CODEX_H -.-&gt;|-v ~/.codex:/root/.codex| CODEX_C\n    COPILOT_H -.-&gt;|-v ~/.copilot:/root/.copilot| COPILOT_C\n    GEMINI_H -.-&gt;|-v ~/.gemini:/root/.gemini| GEMINI_C\n\n    subgraph \"Available Tools\"\n        AWS_CLI[aws cli]\n        GCLOUD[gcloud]\n        GIT[git]\n        CLAUDE_CLI[claude]\n        CODEX_CLI[codex]\n        COPILOT_CLI[copilot]\n        GEMINI_CLI[gemini]\n    end\n\n    AWS_C --&gt; AWS_CLI\n    GCP_C --&gt; GCLOUD\n    SSH_C --&gt; GIT\n    CLAUDE_C --&gt; CLAUDE_CLI\n    CODEX_C --&gt; CODEX_CLI\n    COPILOT_C --&gt; COPILOT_CLI\n    GEMINI_C --&gt; GEMINI_CLI\n\n    style HOST fill:#4A90E2,color:#fff\n    style AWS_CLI fill:#FF9F43,color:#fff\n    style GCLOUD fill:#5F8D4E,color:#fff</code></pre>"},{"location":"use-images/authentication/#complete-docker-run-command","title":"Complete Docker Run Command","text":"<pre><code>docker run -it --rm \\\n  --name devops-work \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.ssh:/root/.ssh \\\n  -v ~/.claude:/root/.claude \\\n  -v ~/.codex:/root/.codex \\\n  -v ~/.copilot:/root/.copilot \\\n  -v ~/.gemini:/root/.gemini \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <p>Code Annotation</p> <p>Hover over the numbers for explanations of each mount:</p> <pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\  # (1)!\n  -v ~/.aws:/root/.aws \\  # (2)!\n  -v ~/.config/gcloud:/root/.config/gcloud \\  # (3)!\n  -v ~/.ssh:/root/.ssh \\  # (4)!\n  -v ~/.claude:/root/.claude \\  # (5)!\n  -v ~/.codex:/root/.codex \\  # (6)!\n  -v ~/.copilot:/root/.copilot \\  # (7)!\n  -v ~/.gemini:/root/.gemini \\  # (8)!\n  -w /workspace \\  # (9)!\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <ol> <li>Mount current directory to <code>/workspace</code> for accessing your project files</li> <li>Mount AWS credentials for <code>aws</code> CLI authentication</li> <li>Mount GCP credentials for <code>gcloud</code> authentication</li> <li>Mount SSH keys for Git operations and remote server access</li> <li>Mount Claude AI credentials for <code>claude</code> CLI</li> <li>Mount Codex credentials for OpenAI <code>codex</code> CLI</li> <li>Mount Copilot credentials for GitHub <code>copilot</code> CLI</li> <li>Mount Gemini credentials for Google <code>gemini</code> CLI</li> <li>Set working directory to <code>/workspace</code> so you start in your project</li> </ol>"},{"location":"use-images/authentication/#aws-authentication","title":"AWS Authentication","text":"<p>The DevOps Images support multiple AWS authentication methods.</p> IAM User (Access Keys)IAM Role (EC2/ECS)SSO (AWS IAM Identity Centre)Environment Variables"},{"location":"use-images/authentication/#setup","title":"Setup","text":"<pre><code># On host machine\naws configure\n</code></pre> <p>This creates <code>~/.aws/credentials</code> and <code>~/.aws/config</code>.</p>"},{"location":"use-images/authentication/#usage","title":"Usage","text":"<pre><code>docker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre>"},{"location":"use-images/authentication/#credentials-file","title":"Credentials File","text":"<pre><code># ~/.aws/credentials\n[default]\naws_access_key_id = AKIAIOSFODNN7EXAMPLE\naws_secret_access_key = wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n\n[staging]\naws_access_key_id = AKIAI44QH8DHBEXAMPLE\naws_secret_access_key = je7MtGbClwBF/2Zp9Utk/h3yCo8nvbEXAMPLEKEY\n</code></pre> <pre><code># ~/.aws/config\n[default]\nregion = us-east-1\noutput = json\n\n[profile staging]\nregion = us-west-2\noutput = json\n</code></pre>"},{"location":"use-images/authentication/#for-ec2-instances","title":"For EC2 Instances","text":"<p>No credentials needed! The instance role is automatically detected.</p> <pre><code># Run on EC2 instance with IAM role attached\ndocker run --rm \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre>"},{"location":"use-images/authentication/#for-ecs-tasks","title":"For ECS Tasks","text":"<pre><code>{\n  \"taskRoleArn\": \"arn:aws:iam::123456789012:role/ecsTaskRole\",\n  \"containerDefinitions\": [{\n    \"name\": \"devops\",\n    \"image\": \"ghcr.io/jinalshah/devops/images/aws-devops:latest\",\n    \"command\": [\"terraform\", \"apply\", \"-auto-approve\"]\n  }]\n}\n</code></pre>"},{"location":"use-images/authentication/#setup_1","title":"Setup","text":"<pre><code># On host machine\naws configure sso\n# Follow prompts to set up SSO\n\n# Login\naws sso login --profile my-sso-profile\n</code></pre>"},{"location":"use-images/authentication/#usage_1","title":"Usage","text":"<pre><code>docker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  -e AWS_PROFILE=my-sso-profile \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre>"},{"location":"use-images/authentication/#usage_2","title":"Usage","text":"<pre><code>docker run --rm \\\n  -e AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE \\\n  -e AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY \\\n  -e AWS_DEFAULT_REGION=us-east-1 \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre> <p>Security Warning</p> <p>Avoid using environment variables for credentials in shared environments. Prefer volume mounts or IAM roles.</p>"},{"location":"use-images/authentication/#using-multiple-aws-profiles","title":"Using Multiple AWS Profiles","text":"<pre><code># Set profile via environment variable\ndocker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  -e AWS_PROFILE=staging \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n\n# Or use --profile flag\ndocker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws --profile staging sts get-caller-identity\n</code></pre>"},{"location":"use-images/authentication/#aws-session-manager","title":"AWS Session Manager","text":"<p>For EC2 instance access using Session Manager:</p> <pre><code># Connect to instance\ndocker run -it --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws ssm start-session --target i-1234567890abcdef0\n\n# Port forwarding\ndocker run -it --rm \\\n  -v ~/.aws:/root/.aws \\\n  -p 8080:8080 \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws ssm start-session --target i-1234567890abcdef0 \\\n    --document-name AWS-StartPortForwardingSession \\\n    --parameters '{\"portNumber\":[\"8080\"],\"localPortNumber\":[\"8080\"]}'\n</code></pre>"},{"location":"use-images/authentication/#gcp-authentication","title":"GCP Authentication","text":"<p>The DevOps Images support multiple GCP authentication methods.</p> Service Account Keygcloud auth loginApplication Default CredentialsWorkload Identity (GKE)"},{"location":"use-images/authentication/#setup_2","title":"Setup","text":"<pre><code># On host machine - download service account key\nexport GOOGLE_APPLICATION_CREDENTIALS=~/gcp-key.json\n\n# Authenticate gcloud\ngcloud auth activate-service-account --key-file=~/gcp-key.json\n</code></pre>"},{"location":"use-images/authentication/#usage_3","title":"Usage","text":"<pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/gcp-key.json:/root/gcp-key.json \\\n  -e GOOGLE_APPLICATION_CREDENTIALS=/root/gcp-key.json \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre>"},{"location":"use-images/authentication/#setup_3","title":"Setup","text":"<pre><code># On host machine - interactive login\ngcloud auth login\ngcloud config set project my-project-id\n</code></pre>"},{"location":"use-images/authentication/#usage_4","title":"Usage","text":"<pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre>"},{"location":"use-images/authentication/#setup_4","title":"Setup","text":"<pre><code># On host machine\ngcloud auth application-default login\n</code></pre>"},{"location":"use-images/authentication/#usage_5","title":"Usage","text":"<pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth application-default print-access-token\n</code></pre>"},{"location":"use-images/authentication/#for-gke-pods","title":"For GKE Pods","text":"<p>No credentials needed! Workload Identity is automatically configured.</p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: devops-pod\nspec:\n  serviceAccountName: my-ksa\n  containers:\n  - name: devops\n    image: ghcr.io/jinalshah/devops/images/gcp-devops:latest\n    command: [\"gcloud\", \"auth\", \"list\"]\n</code></pre>"},{"location":"use-images/authentication/#gcp-multiple-projects","title":"GCP Multiple Projects","text":"<pre><code># Set active project\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud config set project my-project-id\n\n# Or use --project flag\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud compute instances list --project my-project-id\n</code></pre>"},{"location":"use-images/authentication/#ssh-key-authentication","title":"SSH Key Authentication","text":"<p>For Git operations and remote server access.</p>"},{"location":"use-images/authentication/#setup_5","title":"Setup","text":"<pre><code># Use your existing SSH keys\ndocker run -it --rm \\\n  -v ~/.ssh:/root/.ssh \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ssh-add -l\n</code></pre>"},{"location":"use-images/authentication/#git-over-ssh","title":"Git Over SSH","text":"<pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.ssh:/root/.ssh \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  git clone git@github.com:yourusername/your-repo.git\n</code></pre>"},{"location":"use-images/authentication/#ssh-to-remote-servers","title":"SSH to Remote Servers","text":"<pre><code>docker run -it --rm \\\n  -v ~/.ssh:/root/.ssh \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ssh user@remote-server.com\n</code></pre> <p>SSH Agent Forwarding</p> <p>For SSH agent forwarding on macOS/Linux:</p> <pre><code>docker run -it --rm \\\n  -v $SSH_AUTH_SOCK:/ssh-agent \\\n  -e SSH_AUTH_SOCK=/ssh-agent \\\n  -v ~/.ssh:/root/.ssh \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ssh user@remote-server.com\n</code></pre>"},{"location":"use-images/authentication/#ai-cli-authentication","title":"AI CLI Authentication","text":"<p>All DevOps Images include four AI CLI tools. Each requires separate authentication.</p>"},{"location":"use-images/authentication/#claude-cli-anthropic","title":"Claude CLI (Anthropic)","text":"<p>Setup: Interactive authentication</p> <pre><code>docker run -it --rm \\\n  -v ~/.claude:/root/.claude \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude auth login\n</code></pre> <p>Follow the prompts to authenticate with your Anthropic account.</p> <p>Usage:</p> <pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this Terraform code\" --file main.tf\n</code></pre> <p>Verification:</p> <pre><code>docker run --rm \\\n  -v ~/.claude:/root/.claude \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude --version\n</code></pre>"},{"location":"use-images/authentication/#codex-cli-openai","title":"Codex CLI (OpenAI)","text":"<p>Setup: API key configuration</p> <pre><code># Set API key as environment variable\nexport OPENAI_API_KEY=\"sk-...\"\n\n# Or create config file\nmkdir -p ~/.codex\necho \"OPENAI_API_KEY=sk-...\" &gt; ~/.codex/config\n</code></pre> <p>Usage:</p> <pre><code>docker run --rm \\\n  -e OPENAI_API_KEY=$OPENAI_API_KEY \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex \"generate terraform module for AWS VPC\"\n</code></pre>"},{"location":"use-images/authentication/#github-copilot-cli","title":"GitHub Copilot CLI","text":"<p>Setup: GitHub authentication</p> <pre><code>docker run -it --rm \\\n  -v ~/.copilot:/root/.copilot \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  copilot auth login\n</code></pre> <p>Usage:</p> <pre><code>docker run --rm \\\n  -v ~/.copilot:/root/.copilot \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  copilot suggest \"how to deploy to kubernetes\"\n</code></pre>"},{"location":"use-images/authentication/#google-gemini-cli","title":"Google Gemini CLI","text":"<p>Setup: Use GCP credentials</p> <pre><code># Requires gcloud authentication\ndocker run -it --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  gemini --version\n</code></pre> <p>Usage:</p> <pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  gemini \"explain this error\" --stdin &lt; error.log\n</code></pre> <p>AI CLI Setup Details</p> <p>For comprehensive AI CLI setup guides, examples, and use cases, see:</p> <ul> <li>AI CLI Setup Guide - Detailed authentication and configuration</li> <li>AI-Assisted DevOps Workflows - Real-world examples</li> </ul>"},{"location":"use-images/authentication/#cicd-authentication","title":"CI/CD Authentication","text":""},{"location":"use-images/authentication/#github-actions","title":"GitHub Actions","text":"<pre><code>jobs:\n  deploy:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/aws-devops:latest\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure AWS Credentials\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Deploy\n        run: terraform apply -auto-approve\n</code></pre>"},{"location":"use-images/authentication/#gitlab-ci","title":"GitLab CI","text":"<pre><code>deploy:\n  image: registry.gitlab.com/jinal-shah/devops/images/aws-devops:latest\n  script:\n    - terraform apply -auto-approve\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    AWS_DEFAULT_REGION: us-east-1\n</code></pre>"},{"location":"use-images/authentication/#environment-variables-summary","title":"Environment Variables Summary","text":"Variable Purpose Example <code>AWS_ACCESS_KEY_ID</code> AWS access key <code>AKIAIOSFODNN7EXAMPLE</code> <code>AWS_SECRET_ACCESS_KEY</code> AWS secret key <code>wJalrXUtnFEMI/K7MDENG/...</code> <code>AWS_DEFAULT_REGION</code> AWS region <code>us-east-1</code> <code>AWS_PROFILE</code> AWS profile name <code>staging</code> <code>GOOGLE_APPLICATION_CREDENTIALS</code> GCP service account key path <code>/root/gcp-key.json</code> <code>OPENAI_API_KEY</code> OpenAI API key <code>sk-...</code> <code>SSH_AUTH_SOCK</code> SSH agent socket <code>/ssh-agent</code>"},{"location":"use-images/authentication/#troubleshooting-authentication","title":"Troubleshooting Authentication","text":""},{"location":"use-images/authentication/#aws","title":"AWS","text":"<pre><code># Verify AWS credentials\ndocker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n\n# Debug AWS configuration\ndocker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws configure list\n</code></pre>"},{"location":"use-images/authentication/#gcp","title":"GCP","text":"<pre><code># Verify GCP authentication\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n\n# Verify active project\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud config get-value project\n</code></pre>"},{"location":"use-images/authentication/#common-issues","title":"Common Issues","text":"<p>Permission Denied on SSH Keys</p> <p>Problem: SSH keys have incorrect permissions after mounting</p> <p>Solution: </p><pre><code># Fix permissions inside container\ndocker run -it --rm \\\n  -v ~/.ssh:/root/.ssh \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  chmod 600 /root/.ssh/id_rsa\n</code></pre><p></p> <p>AWS Credentials Not Found</p> <p>Problem: <code>Unable to locate credentials</code></p> <p>Solution: Ensure volume mount is correct </p><pre><code># Verify mount\ndocker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  ls -la /root/.aws\n</code></pre><p></p> <p>GCP Application Default Credentials Not Found</p> <p>Problem: <code>Could not automatically determine credentials</code></p> <p>Solution: Run <code>gcloud auth application-default login</code> on host first</p>"},{"location":"use-images/authentication/#security-best-practices","title":"Security Best Practices","text":"<p>Never Commit Credentials</p> <ul> <li>\u274c Never commit <code>.aws/credentials</code>, <code>.env</code>, or service account keys to Git</li> <li>\u2705 Use volume mounts to inject credentials at runtime</li> <li>\u2705 Use CI/CD secrets for automated pipelines</li> <li>\u2705 Rotate credentials regularly</li> <li>\u2705 Use IAM roles when running on cloud platforms</li> </ul> <p>Minimal Permissions</p> <ul> <li>Follow principle of least privilege</li> <li>Create separate IAM users/service accounts for different projects</li> <li>Use read-only credentials for testing</li> <li>Enable MFA on cloud accounts</li> </ul> <p>Credential Isolation</p> <ul> <li>Use different volume mounts for different projects</li> <li>Don't share credentials between development and production</li> <li>Consider using separate containers for sensitive operations</li> </ul>"},{"location":"use-images/authentication/#next-steps","title":"Next Steps","text":"<ul> <li>AI CLI Setup Guide - Comprehensive AI CLI authentication and usage</li> <li>Quick Reference - Common volume mount patterns</li> <li>Troubleshooting - Authentication error solutions</li> <li>Workflows - Real-world CI/CD examples</li> </ul>"},{"location":"use-images/aws-devops/","title":"AWS DevOps Image","text":""},{"location":"use-images/aws-devops/#aws-devops-image","title":"AWS DevOps Image","text":"<p>AWS-optimised container with all essential DevOps tools plus AWS-specific CLIs and libraries. Perfect for AWS-centric workflows while maintaining full platform tool support.</p>"},{"location":"use-images/aws-devops/#pull-the-image","title":"Pull the Image","text":"GHCR (Recommended)GitLab RegistryDocker Hub <pre><code># Latest version\ndocker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\n\n# Specific version (recommended for CI/CD)\ndocker pull ghcr.io/jinalshah/devops/images/aws-devops:1.0.abc1234\n</code></pre> <p>Why GHCR?</p> <ul> <li>No rate limits for public images</li> <li>Built-in GitHub integration for CI/CD</li> <li>Faster pulls from GitHub Actions</li> </ul> <pre><code># Latest version\ndocker pull registry.gitlab.com/jinal-shah/devops/images/aws-devops:latest\n\n# Specific version\ndocker pull registry.gitlab.com/jinal-shah/devops/images/aws-devops:1.0.abc1234\n</code></pre> <p>When to use</p> <ul> <li>Using GitLab CI/CD pipelines</li> <li>Need GitLab Container Registry integration</li> <li>Already authenticated with GitLab</li> </ul> <pre><code># Latest version\ndocker pull js01/aws-devops:latest\n\n# Specific version\ndocker pull js01/aws-devops:1.0.abc1234\n</code></pre> <p>Rate Limits</p> <p>Docker Hub has pull rate limits for free accounts:</p> <ul> <li>Unauthenticated: 100 pulls per 6 hours</li> <li>Authenticated: 200 pulls per 6 hours</li> </ul> <p>Consider using GHCR for CI/CD to avoid rate limit issues.</p>"},{"location":"use-images/aws-devops/#whats-included","title":"What's Included","text":""},{"location":"use-images/aws-devops/#base-platform-tools","title":"Base Platform Tools","text":"<p>All standard DevOps tools from the base image:</p> <ul> <li>Infrastructure as Code: Terraform, Terragrunt, TFLint, Packer</li> <li>Kubernetes: kubectl, Helm 3, k9s, kustomize</li> <li>Security: Trivy (container scanning), ansible-lint</li> <li>Configuration Management: Ansible</li> <li>Development: Python 3.12, Node.js 20, Git, jq, yq</li> <li>AI CLIs: claude, codex, copilot, gemini</li> <li>Utilities: gh (GitHub CLI), Task, zsh, vim, curl, wget</li> </ul>"},{"location":"use-images/aws-devops/#aws-specific-additions","title":"AWS-Specific Additions","text":"<p>Tools optimised for AWS workflows:</p> <ul> <li>AWS CLI v2: Latest AWS command-line interface</li> <li>AWS Session Manager Plugin: Direct SSH-like access to EC2 instances</li> <li>Python Libraries:</li> <li><code>boto3</code>: AWS SDK for Python automation</li> <li><code>cfn-lint</code>: CloudFormation template validation</li> <li><code>s3cmd</code>: Advanced S3 operations</li> <li><code>crcmod</code>: CRC32c verification for uploads</li> </ul>"},{"location":"use-images/aws-devops/#quick-start","title":"Quick Start","text":""},{"location":"use-images/aws-devops/#interactive-shell","title":"Interactive Shell","text":"<pre><code># Basic interactive shell with AWS credentials\ndocker run -it --rm \\\n  -v $PWD:/workspace \\  # (1)!\n  -v ~/.aws:/root/.aws \\  # (2)!\n  -w /workspace \\  # (3)!\n  ghcr.io/jinalshah/devops/images/aws-devops:latest\n</code></pre> <ol> <li>Mount current directory to <code>/workspace</code> for file access</li> <li>Mount AWS credentials for authentication</li> <li>Set working directory to your project</li> </ol>"},{"location":"use-images/aws-devops/#one-off-commands","title":"One-Off Commands","text":"AWS CLITerraform + AWSCloudFormationPython + Boto3 <pre><code># Verify AWS identity\ndocker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n\n# List S3 buckets\ndocker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws s3 ls\n</code></pre> <pre><code># Terraform plan with AWS credentials\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terraform plan\n\n# Terraform apply\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terraform apply -auto-approve\n</code></pre> <pre><code># Validate CloudFormation template\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  cfn-lint template.yaml\n\n# Deploy stack\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws cloudformation deploy \\\n    --template-file template.yaml \\\n    --stack-name my-stack\n</code></pre> <pre><code># Run Python script with boto3\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  python3 aws-automation.py\n</code></pre>"},{"location":"use-images/aws-devops/#authentication-methods","title":"Authentication Methods","text":""},{"location":"use-images/aws-devops/#method-1-mount-aws-credentials-recommended","title":"Method 1: Mount AWS Credentials (Recommended)","text":"<pre><code>docker run -it --rm \\\n  -v ~/.aws:/root/.aws \\  # (1)!\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre> <ol> <li>Mounts your local <code>~/.aws</code> directory containing <code>credentials</code> and <code>config</code> files</li> </ol> <p>Files mounted: - <code>~/.aws/credentials</code> - AWS access keys - <code>~/.aws/config</code> - AWS CLI configuration (regions, output format)</p>"},{"location":"use-images/aws-devops/#method-2-environment-variables","title":"Method 2: Environment Variables","text":"<pre><code>docker run -it --rm \\\n  -e AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE \\  # (1)!\n  -e AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY \\  # (2)!\n  -e AWS_DEFAULT_REGION=us-east-1 \\  # (3)!\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws s3 ls\n</code></pre> <ol> <li>Your AWS access key ID</li> <li>Your AWS secret access key</li> <li>Default AWS region for operations</li> </ol> <p>Security</p> <p>Environment variables are visible in <code>docker inspect</code> output. For production, prefer mounting credentials or using IAM roles.</p>"},{"location":"use-images/aws-devops/#method-3-iam-role-ecsec2","title":"Method 3: IAM Role (ECS/EC2)","text":"<p>When running on AWS infrastructure (ECS, EC2, EKS), the container automatically inherits IAM credentials:</p> <pre><code># No credentials needed - uses instance/task role\ndocker run -it --rm \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre> <p>Supported AWS environments: - ECS tasks with task roles - EC2 instances with instance profiles - EKS pods with IRSA (IAM Roles for Service Accounts)</p>"},{"location":"use-images/aws-devops/#common-workflows","title":"Common Workflows","text":""},{"location":"use-images/aws-devops/#terraform-on-aws","title":"Terraform on AWS","text":"<pre><code>#!/bin/bash\n# Deploy infrastructure to AWS\n\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  sh -c \"\n    terraform init\n    terraform validate\n    terraform plan -out=tfplan\n    terraform apply tfplan\n  \"\n</code></pre>"},{"location":"use-images/aws-devops/#ansible-with-ec2-dynamic-inventory","title":"Ansible with EC2 Dynamic Inventory","text":"<pre><code># Run playbook against EC2 instances\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.ssh:/root/.ssh \\  # (1)!\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  ansible-playbook \\\n    -i aws_ec2.yml \\  # (2)!\n    deploy.yml\n</code></pre> <ol> <li>Mount SSH keys for EC2 instance access</li> <li>AWS EC2 dynamic inventory plugin</li> </ol>"},{"location":"use-images/aws-devops/#security-scanning","title":"Security Scanning","text":"<pre><code># Scan CloudFormation templates\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  sh -c \"\n    cfn-lint cloudformation/**/*.yaml\n    trivy config cloudformation/\n  \"\n</code></pre>"},{"location":"use-images/aws-devops/#python-automation-with-boto3","title":"Python Automation with Boto3","text":"<pre><code># Run AWS automation script\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  python3 scripts/cleanup-unused-ebs.py\n</code></pre>"},{"location":"use-images/aws-devops/#best-use-cases","title":"Best Use Cases","text":"<p>Perfect For</p> <ul> <li>\u2705 AWS-first DevOps teams: No GCP tools to reduce image size</li> <li>\u2705 AWS-only CI/CD pipelines: Faster startup than multi-cloud image</li> <li>\u2705 CloudFormation workflows: Built-in <code>cfn-lint</code> validation</li> <li>\u2705 Terraform on AWS: Full Terraform + AWS CLI integration</li> <li>\u2705 Python automation: Pre-installed boto3 and AWS libraries</li> <li>\u2705 EKS deployments: kubectl + Helm + AWS CLI in one image</li> </ul> <p>Consider all-devops if you need</p> <ul> <li>Multi-cloud (AWS + GCP) support</li> <li><code>gcloud</code> CLI for hybrid workflows</li> <li>Team works across cloud providers</li> </ul>"},{"location":"use-images/aws-devops/#image-size","title":"Image Size","text":"Image Size AWS Tools aws-devops ~2.8 GB AWS CLI, boto3, cfn-lint, Session Manager all-devops ~3.2 GB AWS + GCP tools <p>Size savings: ~400 MB compared to <code>all-devops</code> by excluding GCP-specific tools.</p>"},{"location":"use-images/aws-devops/#dockerfile-reference","title":"Dockerfile Reference","text":"<p>Want to build your own? See Building AWS DevOps Image for:</p> <ul> <li>Complete Dockerfile</li> <li>Build arguments</li> <li>Customisation options</li> <li>Multi-platform builds</li> </ul>"},{"location":"use-images/aws-devops/#advanced-usage","title":"Advanced Usage","text":"Cache Terraform Plugins <p>Speed up repeated Terraform runs by caching provider plugins:</p> <pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.terraform.d:/root/.terraform.d \\  # (1)!\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terraform init\n</code></pre> <ol> <li>Cache Terraform plugins across runs (saves download time)</li> </ol> Named Container for Persistent Shell <p>Keep a persistent container for ongoing work:</p> <pre><code># Create named container\ndocker run -it --name aws-dev \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest\n\n# Later, restart the same container\ndocker start -i aws-dev\n</code></pre> Custom Shell Alias <p>Add to <code>~/.bashrc</code> or <code>~/.zshrc</code>:</p> <pre><code>alias aws-devops='docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.ssh:/root/.ssh \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest'\n\n# Usage\naws-devops terraform plan\naws-devops aws s3 ls\n</code></pre>"},{"location":"use-images/aws-devops/#troubleshooting","title":"Troubleshooting","text":"AWS credentials not found <p>Problem: <code>Unable to locate credentials</code></p> <p>Solutions:</p> <ol> <li> <p>Verify credentials exist locally:    </p><pre><code>cat ~/.aws/credentials\n</code></pre><p></p> </li> <li> <p>Check mount is working:    </p><pre><code>docker run --rm -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  ls -la /root/.aws\n</code></pre><p></p> </li> <li> <p>Use environment variables instead:    </p><pre><code>docker run --rm \\\n  -e AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID \\\n  -e AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws sts get-caller-identity\n</code></pre><p></p> </li> </ol> Region errors <p>Problem: <code>You must specify a region</code></p> <p>Solutions:</p> <ol> <li> <p>Set default region in <code>~/.aws/config</code>:    </p><pre><code>[default]\nregion = us-east-1\n</code></pre><p></p> </li> <li> <p>Pass as environment variable:    </p><pre><code>docker run --rm \\\n  -e AWS_DEFAULT_REGION=us-east-1 \\\n  -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  aws s3 ls\n</code></pre><p></p> </li> </ol> Permission denied on files <p>Problem: Cannot write files created by container</p> <p>Solution: Run with your user ID:</p> <pre><code>docker run --rm \\\n  --user \"$(id -u):$(id -g)\" \\  # (1)!\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terraform fmt\n</code></pre> <ol> <li>Use your local user/group ID to match file ownership</li> </ol>"},{"location":"use-images/aws-devops/#next-steps","title":"Next Steps","text":"<ul> <li>Authentication Guide - Detailed credential setup</li> <li>Quick Reference - Command cheat sheet</li> <li>Docker Compose Examples - Multi-container setups</li> <li>Terraform Workflows - Advanced Terraform patterns</li> <li>CI/CD Integration - Use in pipelines</li> </ul>"},{"location":"use-images/docker-compose/","title":"Docker Compose Examples","text":""},{"location":"use-images/docker-compose/#docker-compose-examples","title":"Docker Compose Examples","text":"<p>Pre-configured Docker Compose setups for local development environments using DevOps Images with databases, services, and development tools.</p>"},{"location":"use-images/docker-compose/#basic-development-environment","title":"Basic Development Environment","text":""},{"location":"use-images/docker-compose/#minimal-setup","title":"Minimal Setup","text":"<p><code>docker-compose.yml</code>:</p> <pre><code>version: '3.8'\n\nservices:\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    container_name: devops-workspace\n    volumes:\n      - .:/workspace\n      - ~/.aws:/root/.aws\n      - ~/.config/gcloud:/root/.config/gcloud\n      - ~/.ssh:/root/.ssh\n    working_dir: /workspace\n    stdin_open: true\n    tty: true\n    command: zsh\n</code></pre> <p>Usage:</p> <pre><code># Start interactive shell\ndocker-compose run --rm devops\n\n# Run specific command\ndocker-compose run --rm devops terraform plan\n</code></pre>"},{"location":"use-images/docker-compose/#development-with-databases","title":"Development with Databases","text":""},{"location":"use-images/docker-compose/#postgresql-devops-tools","title":"PostgreSQL + DevOps Tools","text":"<pre><code>version: '3.8'\n\nservices:\n  postgres:\n    image: postgres:17-alpine\n    container_name: dev-postgres\n    environment:\n      POSTGRES_USER: devops\n      POSTGRES_PASSWORD: devops\n      POSTGRES_DB: infrastructure\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U devops\"]\n      interval: 5s\n      timeout: 5s\n      retries: 5\n\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    container_name: devops-workspace\n    depends_on:\n      postgres:\n        condition: service_healthy\n    volumes:\n      - .:/workspace\n      - ~/.aws:/root/.aws\n      - ~/.ssh:/root/.ssh\n    working_dir: /workspace\n    environment:\n      DATABASE_URL: postgresql://devops:devops@postgres:5432/infrastructure\n    stdin_open: true\n    tty: true\n    command: zsh\n\nvolumes:\n  postgres-data:\n</code></pre> <p>Usage:</p> <pre><code># Start all services\ndocker-compose up -d\n\n# Access DevOps shell\ndocker-compose exec devops zsh\n\n# Inside container, connect to PostgreSQL\npsql postgresql://devops:devops@postgres:5432/infrastructure\n</code></pre>"},{"location":"use-images/docker-compose/#multi-database-environment","title":"Multi-Database Environment","text":""},{"location":"use-images/docker-compose/#postgresql-mongodb-redis","title":"PostgreSQL + MongoDB + Redis","text":"<pre><code>version: '3.8'\n\nservices:\n  postgres:\n    image: postgres:17-alpine\n    environment:\n      POSTGRES_USER: devops\n      POSTGRES_PASSWORD: devops\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n\n  mongodb:\n    image: mongo:6.0\n    environment:\n      MONGO_INITDB_ROOT_USERNAME: devops\n      MONGO_INITDB_ROOT_PASSWORD: devops\n    ports:\n      - \"27017:27017\"\n    volumes:\n      - mongo-data:/data/db\n\n  redis:\n    image: redis:7-alpine\n    ports:\n      - \"6379:6379\"\n    volumes:\n      - redis-data:/data\n\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    depends_on:\n      - postgres\n      - mongodb\n      - redis\n    volumes:\n      - .:/workspace\n      - ~/.aws:/root/.aws\n      - ~/.ssh:/root/.ssh\n    working_dir: /workspace\n    environment:\n      POSTGRES_URL: postgresql://devops:devops@postgres:5432/devops\n      MONGO_URL: mongodb://devops:devops@mongodb:27017\n      REDIS_URL: redis://redis:6379\n    stdin_open: true\n    tty: true\n    command: zsh\n\nvolumes:\n  postgres-data:\n  mongo-data:\n  redis-data:\n</code></pre> <p>Usage:</p> <pre><code># Start all services\ndocker-compose up -d\n\n# Access DevOps shell\ndocker-compose exec devops zsh\n\n# Inside container\npsql $POSTGRES_URL -c \"SELECT version();\"\nmongosh $MONGO_URL\nredis-cli -h redis ping\n</code></pre>"},{"location":"use-images/docker-compose/#cicd-testing-environment","title":"CI/CD Testing Environment","text":""},{"location":"use-images/docker-compose/#local-pipeline-testing","title":"Local Pipeline Testing","text":"<pre><code>version: '3.8'\n\nservices:\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234  # (1)!\n    volumes:\n      - .:/workspace\n      - ~/.aws:/root/.aws\n      - /var/run/docker.sock:/var/run/docker.sock  # (2)!\n    working_dir: /workspace\n    environment:\n      CI: \"true\"\n      ENVIRONMENT: local\n    profiles:\n      - test\n\n  validate:\n    extends: devops\n    command: &gt;\n      sh -c \"\n        terraform fmt -check -recursive &amp;&amp;\n        terraform init -backend=false &amp;&amp;\n        terraform validate &amp;&amp;\n        trivy config .\n      \"\n    profiles:\n      - test\n\n  deploy:\n    extends: devops\n    command: &gt;\n      sh -c \"\n        terraform init &amp;&amp;\n        terraform plan &amp;&amp;\n        terraform apply -auto-approve\n      \"\n    profiles:\n      - deploy\n</code></pre> <ol> <li>Pin version for reproducibility</li> <li>Access Docker daemon for Docker-in-Docker operations</li> </ol> <p>Usage:</p> <pre><code># Run validation\ndocker-compose --profile test run --rm validate\n\n# Run deployment\ndocker-compose --profile deploy run --rm deploy\n</code></pre>"},{"location":"use-images/docker-compose/#terraform-state-backend","title":"Terraform State Backend","text":""},{"location":"use-images/docker-compose/#local-s3-compatible-storage","title":"Local S3-Compatible Storage","text":"<pre><code>version: '3.8'\n\nservices:\n  minio:  # (1)!\n    image: minio/minio:latest\n    command: server /data --console-address \":9001\"\n    environment:\n      MINIO_ROOT_USER: minioadmin\n      MINIO_ROOT_PASSWORD: minioadmin\n    ports:\n      - \"9000:9000\"\n      - \"9001:9001\"\n    volumes:\n      - minio-data:/data\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:9000/minio/health/live\"]\n      interval: 30s\n      timeout: 20s\n      retries: 3\n\n  create-bucket:  # (2)!\n    image: minio/mc:latest\n    depends_on:\n      minio:\n        condition: service_healthy\n    entrypoint: &gt;\n      sh -c \"\n        mc alias set myminio http://minio:9000 minioadmin minioadmin &amp;&amp;\n        mc mb myminio/terraform-state || true\n      \"\n\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    depends_on:\n      - create-bucket\n    volumes:\n      - .:/workspace\n    working_dir: /workspace\n    environment:\n      AWS_ACCESS_KEY_ID: minioadmin\n      AWS_SECRET_ACCESS_KEY: minioadmin\n      AWS_ENDPOINT_URL_S3: http://minio:9000\n    stdin_open: true\n    tty: true\n    command: zsh\n\nvolumes:\n  minio-data:\n</code></pre> <ol> <li>MinIO provides S3-compatible local storage</li> <li>Automatically creates Terraform state bucket</li> </ol> <p>Terraform backend config:</p> <pre><code>terraform {\n  backend \"s3\" {\n    bucket                      = \"terraform-state\"\n    key                         = \"dev/terraform.tfstate\"\n    region                      = \"us-east-1\"\n    endpoint                    = \"http://minio:9000\"\n    skip_credentials_validation = true\n    skip_metadata_api_check     = true\n    skip_region_validation      = true\n    force_path_style            = true\n  }\n}\n</code></pre> <p>Usage:</p> <pre><code># Start environment\ndocker-compose up -d\n\n# Access DevOps shell\ndocker-compose exec devops zsh\n\n# Inside container\nterraform init\nterraform plan\n</code></pre>"},{"location":"use-images/docker-compose/#kubernetes-development","title":"Kubernetes Development","text":""},{"location":"use-images/docker-compose/#kind-cluster-devops-tools","title":"Kind Cluster + DevOps Tools","text":"<pre><code>version: '3.8'\n\nservices:\n  kind:  # (1)!\n    image: kindest/node:v1.27.0\n    container_name: kind-control-plane\n    privileged: true\n    ports:\n      - \"6443:6443\"\n      - \"80:30080\"\n      - \"443:30443\"\n    volumes:\n      - kind-data:/var\n\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    depends_on:\n      - kind\n    volumes:\n      - .:/workspace\n      - ~/.kube:/root/.kube\n    working_dir: /workspace\n    environment:\n      KUBECONFIG: /root/.kube/config\n    network_mode: service:kind  # (2)!\n    stdin_open: true\n    tty: true\n    command: zsh\n\nvolumes:\n  kind-data:\n</code></pre> <ol> <li>Kind (Kubernetes in Docker) for local K8s cluster</li> <li>Share network with Kind to access K8s API</li> </ol> <p>Usage:</p> <pre><code># Start cluster\ndocker-compose up -d\n\n# Access DevOps shell\ndocker-compose exec devops zsh\n\n# Inside container\nkubectl get nodes\nkubectl get pods -A\nhelm list -A\n</code></pre>"},{"location":"use-images/docker-compose/#development-documentation","title":"Development + Documentation","text":""},{"location":"use-images/docker-compose/#mkdocs-devops-tools","title":"MkDocs + DevOps Tools","text":"<pre><code>version: '3.8'\n\nservices:\n  docs:\n    image: squidfunk/mkdocs-material:latest\n    volumes:\n      - .:/docs\n    ports:\n      - \"8000:8000\"\n    command: serve --dev-addr=0.0.0.0:8000\n\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    volumes:\n      - .:/workspace\n      - ~/.aws:/root/.aws\n    working_dir: /workspace\n    stdin_open: true\n    tty: true\n    command: zsh\n</code></pre> <p>Usage:</p> <pre><code># Start all services\ndocker-compose up -d\n\n# View docs\nopen http://localhost:8000\n\n# Access DevOps shell\ndocker-compose exec devops zsh\n</code></pre>"},{"location":"use-images/docker-compose/#production-like-environment","title":"Production-Like Environment","text":""},{"location":"use-images/docker-compose/#multi-service-stack","title":"Multi-Service Stack","text":"<pre><code>version: '3.8'\n\nnetworks:\n  frontend:\n  backend:\n\nservices:\n  postgres:\n    image: postgres:17-alpine\n    networks:\n      - backend\n    environment:\n      POSTGRES_USER: app\n      POSTGRES_PASSWORD: secret\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n\n  redis:\n    image: redis:7-alpine\n    networks:\n      - backend\n    volumes:\n      - redis-data:/data\n\n  nginx:\n    image: nginx:alpine\n    networks:\n      - frontend\n      - backend\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    networks:\n      - frontend\n      - backend\n    volumes:\n      - .:/workspace\n      - ~/.aws:/root/.aws\n      - ~/.kube:/root/.kube\n    working_dir: /workspace\n    environment:\n      DATABASE_URL: postgresql://app:secret@postgres:5432/app\n      REDIS_URL: redis://redis:6379\n    depends_on:\n      - postgres\n      - redis\n    stdin_open: true\n    tty: true\n    command: zsh\n\nvolumes:\n  postgres-data:\n  redis-data:\n</code></pre>"},{"location":"use-images/docker-compose/#best-practices","title":"Best Practices","text":"<p>Performance</p> <ol> <li>Use named volumes: Better performance than bind mounts</li> <li>Health checks: Ensure services are ready before starting dependent containers</li> <li>Resource limits: Prevent containers from consuming all resources</li> <li>Network isolation: Use custom networks to isolate services</li> </ol> <p>Security</p> <ol> <li>Don't commit secrets: Use <code>.env</code> files (add to <code>.gitignore</code>)</li> <li>Use specific versions: Pin image versions for reproducibility</li> <li>Limit exposed ports: Only expose necessary ports</li> <li>Run as non-root: Use <code>user:</code> directive when possible</li> </ol> <p>Common Pitfalls</p> <ul> <li>\u274c Using <code>latest</code> tag: Can lead to unexpected behaviour</li> <li>\u274c No health checks: Dependent services may start before ready</li> <li>\u274c Committing <code>.env</code> files: Exposes secrets</li> <li>\u274c No resource limits: Can cause host exhaustion</li> </ul>"},{"location":"use-images/docker-compose/#environment-variables","title":"Environment Variables","text":""},{"location":"use-images/docker-compose/#using-env-file","title":"Using <code>.env</code> File","text":"<p><code>.env</code>:</p> <pre><code># Image versions\nDEVOPS_IMAGE=ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\nPOSTGRES_VERSION=17-alpine\n\n# Database credentials\nPOSTGRES_USER=devops\nPOSTGRES_PASSWORD=changeme\nPOSTGRES_DB=infrastructure\n\n# AWS credentials\nAWS_ACCESS_KEY_ID=your-key-id\nAWS_SECRET_ACCESS_KEY=your-secret-key\nAWS_DEFAULT_REGION=us-east-1\n</code></pre> <p><code>docker-compose.yml</code>:</p> <pre><code>version: '3.8'\n\nservices:\n  postgres:\n    image: postgres:${POSTGRES_VERSION}\n    environment:\n      POSTGRES_USER: ${POSTGRES_USER}\n      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n      POSTGRES_DB: ${POSTGRES_DB}\n\n  devops:\n    image: ${DEVOPS_IMAGE}\n    environment:\n      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}\n      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}\n      AWS_DEFAULT_REGION: ${AWS_DEFAULT_REGION}\n</code></pre> <p><code>.gitignore</code>:</p> <pre><code>.env\n</code></pre>"},{"location":"use-images/docker-compose/#useful-commands","title":"Useful Commands","text":"<pre><code># Start all services\ndocker-compose up -d\n\n# Stop all services\ndocker-compose down\n\n# View logs\ndocker-compose logs -f devops\n\n# Access shell\ndocker-compose exec devops zsh\n\n# Run one-off command\ndocker-compose run --rm devops terraform plan\n\n# Rebuild images\ndocker-compose build\n\n# Remove all containers and volumes\ndocker-compose down -v\n\n# Scale service\ndocker-compose up -d --scale devops=3\n</code></pre>"},{"location":"use-images/docker-compose/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Reference - Common command patterns</li> <li>Authentication - Configure cloud credentials</li> <li>Workflows - Real-world usage examples</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"use-images/gcp-devops/","title":"GCP DevOps Image","text":""},{"location":"use-images/gcp-devops/#gcp-devops-image","title":"GCP DevOps Image","text":"<p>GCP-optimised container with all essential DevOps tools plus Google Cloud-specific CLIs. Perfect for GCP-centric workflows while maintaining full platform tool support.</p>"},{"location":"use-images/gcp-devops/#pull-the-image","title":"Pull the Image","text":"GHCR (Recommended)GitLab RegistryDocker Hub <pre><code># Latest version\ndocker pull ghcr.io/jinalshah/devops/images/gcp-devops:latest\n\n# Specific version (recommended for CI/CD)\ndocker pull ghcr.io/jinalshah/devops/images/gcp-devops:1.0.abc1234\n</code></pre> <p>Why GHCR?</p> <ul> <li>No rate limits for public images</li> <li>Built-in GitHub integration for CI/CD</li> <li>Faster pulls from GitHub Actions</li> </ul> <pre><code># Latest version\ndocker pull registry.gitlab.com/jinal-shah/devops/images/gcp-devops:latest\n\n# Specific version\ndocker pull registry.gitlab.com/jinal-shah/devops/images/gcp-devops:1.0.abc1234\n</code></pre> <p>When to use</p> <ul> <li>Using GitLab CI/CD pipelines</li> <li>Need GitLab Container Registry integration</li> <li>Already authenticated with GitLab</li> </ul> <pre><code># Latest version\ndocker pull js01/gcp-devops:latest\n\n# Specific version\ndocker pull js01/gcp-devops:1.0.abc1234\n</code></pre> <p>Rate Limits</p> <p>Docker Hub has pull rate limits for free accounts:</p> <ul> <li>Unauthenticated: 100 pulls per 6 hours</li> <li>Authenticated: 200 pulls per 6 hours</li> </ul> <p>Consider using GHCR for CI/CD to avoid rate limit issues.</p>"},{"location":"use-images/gcp-devops/#whats-included","title":"What's Included","text":""},{"location":"use-images/gcp-devops/#base-platform-tools","title":"Base Platform Tools","text":"<p>All standard DevOps tools from the base image:</p> <ul> <li>Infrastructure as Code: Terraform, Terragrunt, TFLint, Packer</li> <li>Kubernetes: kubectl, Helm 3, k9s, kustomize</li> <li>Security: Trivy (container scanning), ansible-lint</li> <li>Configuration Management: Ansible</li> <li>Development: Python 3.12, Node.js 20, Git, jq, yq</li> <li>AI CLIs: claude, codex, copilot, gemini</li> <li>Utilities: gh (GitHub CLI), Task, zsh, vim, curl, wget</li> </ul>"},{"location":"use-images/gcp-devops/#gcp-specific-additions","title":"GCP-Specific Additions","text":"<p>Tools optimised for Google Cloud workflows:</p> <ul> <li>Google Cloud CLI (<code>gcloud</code>): Complete GCP command-line suite</li> <li><code>gcloud</code> - Core Cloud SDK</li> <li><code>gsutil</code> - Cloud Storage operations</li> <li><code>bq</code> - BigQuery CLI</li> <li>Docker Credential Helper: <code>docker-credential-gcr</code> for GCR authentication</li> </ul>"},{"location":"use-images/gcp-devops/#quick-start","title":"Quick Start","text":""},{"location":"use-images/gcp-devops/#interactive-shell","title":"Interactive Shell","text":"<pre><code># Basic interactive shell with GCP credentials\ndocker run -it --rm \\\n  -v $PWD:/workspace \\  # (1)!\n  -v ~/.config/gcloud:/root/.config/gcloud \\  # (2)!\n  -w /workspace \\  # (3)!\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest\n</code></pre> <ol> <li>Mount current directory to <code>/workspace</code> for file access</li> <li>Mount GCP credentials for authentication</li> <li>Set working directory to your project</li> </ol>"},{"location":"use-images/gcp-devops/#one-off-commands","title":"One-Off Commands","text":"gcloud CLITerraform + GCPCloud StorageGKE Operations <pre><code># Verify GCP identity\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n\n# List GCP projects\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud projects list\n</code></pre> <pre><code># Terraform plan with GCP credentials\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  terraform plan\n\n# Terraform apply\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  terraform apply -auto-approve\n</code></pre> <pre><code># List Cloud Storage buckets\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gsutil ls\n\n# Upload file to bucket\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gsutil cp myfile.txt gs://my-bucket/\n</code></pre> <pre><code># Get GKE cluster credentials\ndocker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud container clusters get-credentials my-cluster \\\n    --region us-central1\n\n# List pods in GKE cluster\ndocker run --rm \\\n  -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  kubectl get pods -A\n</code></pre>"},{"location":"use-images/gcp-devops/#authentication-methods","title":"Authentication Methods","text":""},{"location":"use-images/gcp-devops/#method-1-mount-gcloud-config-recommended","title":"Method 1: Mount gcloud Config (Recommended)","text":"<pre><code>docker run -it --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\  # (1)!\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre> <ol> <li>Mounts your local gcloud configuration including credentials and active project</li> </ol> <p>What's mounted: - Authentication tokens - Active project configuration - Component settings</p> <p>Initial setup (run once on your local machine): </p><pre><code>gcloud auth login\ngcloud config set project YOUR_PROJECT_ID\n</code></pre><p></p>"},{"location":"use-images/gcp-devops/#method-2-service-account-key-file","title":"Method 2: Service Account Key File","text":"<pre><code>docker run -it --rm \\\n  -v /path/to/key.json:/tmp/key.json \\  # (1)!\n  -e GOOGLE_APPLICATION_CREDENTIALS=/tmp/key.json \\  # (2)!\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre> <ol> <li>Mount service account JSON key file</li> <li>Set environment variable pointing to the key</li> </ol> <p>Security</p> <p>Service account keys are sensitive credentials. Never commit them to version control. Use secret management in CI/CD.</p> <p>Activate service account: </p><pre><code>docker run --rm \\\n  -v /path/to/key.json:/tmp/key.json \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth activate-service-account --key-file=/tmp/key.json\n</code></pre><p></p>"},{"location":"use-images/gcp-devops/#method-3-workload-identity-gke","title":"Method 3: Workload Identity (GKE)","text":"<p>When running on GKE with Workload Identity enabled, the container automatically inherits GCP credentials:</p> <pre><code># No credentials needed - uses Workload Identity\ndocker run -it --rm \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre> <p>Supported GCP environments: - GKE pods with Workload Identity - Cloud Run services - Compute Engine with default service account - Cloud Build</p>"},{"location":"use-images/gcp-devops/#common-workflows","title":"Common Workflows","text":""},{"location":"use-images/gcp-devops/#terraform-on-gcp","title":"Terraform on GCP","text":"<pre><code>#!/bin/bash\n# Deploy infrastructure to GCP\n\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  sh -c \"\n    terraform init\n    terraform validate\n    terraform plan -out=tfplan\n    terraform apply tfplan\n  \"\n</code></pre>"},{"location":"use-images/gcp-devops/#deploy-to-gke-with-helm","title":"Deploy to GKE with Helm","text":"<pre><code># Get GKE credentials and deploy\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.kube:/root/.kube \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  sh -c \"\n    gcloud container clusters get-credentials prod-cluster --region us-central1\n    helm upgrade --install myapp ./charts/myapp\n  \"\n</code></pre>"},{"location":"use-images/gcp-devops/#ansible-with-gcp-dynamic-inventory","title":"Ansible with GCP Dynamic Inventory","text":"<pre><code># Run playbook against GCP instances\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.ssh:/root/.ssh \\  # (1)!\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  ansible-playbook \\\n    -i gcp_compute.yml \\  # (2)!\n    deploy.yml\n</code></pre> <ol> <li>Mount SSH keys for instance access</li> <li>GCP compute dynamic inventory plugin</li> </ol>"},{"location":"use-images/gcp-devops/#security-scanning","title":"Security Scanning","text":"<pre><code># Scan Terraform configs and container images\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  sh -c \"\n    trivy config terraform/\n    trivy image gcr.io/my-project/my-app:latest\n  \"\n</code></pre>"},{"location":"use-images/gcp-devops/#cloud-storage-operations","title":"Cloud Storage Operations","text":"<pre><code># Sync directory to Cloud Storage\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gsutil -m rsync -r ./build gs://my-bucket/releases/\n</code></pre>"},{"location":"use-images/gcp-devops/#best-use-cases","title":"Best Use Cases","text":"<p>Perfect For</p> <ul> <li>\u2705 GCP-first DevOps teams: No AWS tools to reduce image size</li> <li>\u2705 GCP-only CI/CD pipelines: Faster startup than multi-cloud image</li> <li>\u2705 GKE deployments: gcloud + kubectl + Helm in one image</li> <li>\u2705 Terraform on GCP: Full Terraform + gcloud CLI integration</li> <li>\u2705 Cloud Run deployments: gcloud CLI with container runtime</li> <li>\u2705 Cloud Build pipelines: Optimised for GCP-native CI/CD</li> </ul> <p>Consider all-devops if you need</p> <ul> <li>Multi-cloud (AWS + GCP) support</li> <li>AWS CLI for hybrid workflows</li> <li>Team works across cloud providers</li> </ul>"},{"location":"use-images/gcp-devops/#image-size","title":"Image Size","text":"Image Size GCP Tools gcp-devops ~2.9 GB gcloud SDK, gsutil, bq, docker-credential-gcr all-devops ~3.2 GB GCP + AWS tools <p>Size savings: ~300 MB compared to <code>all-devops</code> by excluding AWS-specific tools.</p>"},{"location":"use-images/gcp-devops/#dockerfile-reference","title":"Dockerfile Reference","text":"<p>Want to build your own? See Building GCP DevOps Image for:</p> <ul> <li>Complete Dockerfile</li> <li>Build arguments</li> <li>Customisation options</li> <li>Multi-platform builds</li> </ul>"},{"location":"use-images/gcp-devops/#advanced-usage","title":"Advanced Usage","text":"Cache Terraform Plugins <p>Speed up repeated Terraform runs by caching provider plugins:</p> <pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.terraform.d:/root/.terraform.d \\  # (1)!\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  terraform init\n</code></pre> <ol> <li>Cache Terraform plugins across runs (saves download time)</li> </ol> Named Container for Persistent Shell <p>Keep a persistent container for ongoing work:</p> <pre><code># Create named container\ndocker run -it --name gcp-dev \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest\n\n# Later, restart the same container\ndocker start -i gcp-dev\n</code></pre> Custom Shell Alias <p>Add to <code>~/.bashrc</code> or <code>~/.zshrc</code>:</p> <pre><code>alias gcp-devops='docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.kube:/root/.kube \\\n  -v ~/.ssh:/root/.ssh \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest'\n\n# Usage\ngcp-devops terraform plan\ngcp-devops gcloud projects list\ngcp-devops kubectl get pods\n</code></pre> GCR Authentication for Docker <p>Authenticate Docker to use Google Container Registry:</p> <pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.docker:/root/.docker \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth configure-docker gcr.io\n</code></pre>"},{"location":"use-images/gcp-devops/#troubleshooting","title":"Troubleshooting","text":"GCP credentials not found <p>Problem: <code>ERROR: (gcloud.auth.list) Failed to load credentials</code></p> <p>Solutions:</p> <ol> <li> <p>Verify credentials exist locally:    </p><pre><code>gcloud auth list\n</code></pre><p></p> </li> <li> <p>Authenticate if needed:    </p><pre><code>gcloud auth login\ngcloud config set project YOUR_PROJECT_ID\n</code></pre><p></p> </li> <li> <p>Check mount is working:    </p><pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  ls -la /root/.config/gcloud\n</code></pre><p></p> </li> <li> <p>Use service account key instead:    </p><pre><code>docker run --rm \\\n  -v /path/to/key.json:/tmp/key.json \\\n  -e GOOGLE_APPLICATION_CREDENTIALS=/tmp/key.json \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud auth list\n</code></pre><p></p> </li> </ol> Project not set <p>Problem: <code>ERROR: (gcloud) You do not currently have an active project</code></p> <p>Solutions:</p> <ol> <li> <p>Set project in local config:    </p><pre><code>gcloud config set project YOUR_PROJECT_ID\n</code></pre><p></p> </li> <li> <p>Pass as environment variable:    </p><pre><code>docker run --rm \\\n  -e CLOUDSDK_CORE_PROJECT=YOUR_PROJECT_ID \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud projects describe $CLOUDSDK_CORE_PROJECT\n</code></pre><p></p> </li> <li> <p>Specify in command:    </p><pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud compute instances list --project=YOUR_PROJECT_ID\n</code></pre><p></p> </li> </ol> Permission denied on files <p>Problem: Cannot write files created by container</p> <p>Solution: Run with your user ID:</p> <pre><code>docker run --rm \\\n  --user \"$(id -u):$(id -g)\" \\  # (1)!\n  -v $PWD:/workspace \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  terraform fmt\n</code></pre> <ol> <li>Use your local user/group ID to match file ownership</li> </ol> GKE credentials not working <p>Problem: Cannot connect to GKE cluster</p> <p>Solutions:</p> <ol> <li> <p>Get fresh credentials:    </p><pre><code>docker run --rm \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gcloud container clusters get-credentials CLUSTER_NAME \\\n    --region REGION\n</code></pre><p></p> </li> <li> <p>Verify kubeconfig:    </p><pre><code>docker run --rm \\\n  -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  kubectl config current-context\n</code></pre><p></p> </li> </ol>"},{"location":"use-images/gcp-devops/#next-steps","title":"Next Steps","text":"<ul> <li>Authentication Guide - Detailed credential setup</li> <li>Quick Reference - Command cheat sheet</li> <li>Docker Compose Examples - Multi-container setups</li> <li>Terraform Workflows - Advanced Terraform patterns</li> <li>CI/CD Integration - Use in pipelines</li> </ul>"},{"location":"use-images/quick-reference/","title":"Quick Reference","text":""},{"location":"use-images/quick-reference/#quick-reference","title":"Quick Reference","text":"<p>Fast lookup guide for common DevOps Images commands, volume mounts, and usage patterns.</p>"},{"location":"use-images/quick-reference/#essential-commands","title":"Essential Commands","text":""},{"location":"use-images/quick-reference/#pull-images","title":"Pull Images","text":"<pre><code># All-devops (multi-cloud)\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# AWS-only\ndocker pull ghcr.io/jinalshah/devops/images/aws-devops:latest\n\n# GCP-only\ndocker pull ghcr.io/jinalshah/devops/images/gcp-devops:latest\n</code></pre>"},{"location":"use-images/quick-reference/#run-interactively","title":"Run Interactively","text":"<pre><code># Basic interactive shell\ndocker run -it --rm ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# With project mounted\ndocker run -it --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Full workstation setup\ndocker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.ssh:/root/.ssh \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"use-images/quick-reference/#run-single-commands","title":"Run Single Commands","text":"<pre><code># Terraform\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform plan\n\n# Ansible\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-playbook site.yml\n\n# kubectl\ndocker run --rm -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  kubectl get pods\n</code></pre>"},{"location":"use-images/quick-reference/#volume-mounts-cheat-sheet","title":"Volume Mounts Cheat Sheet","text":"Mount Purpose When Needed <code>-v $PWD:/workspace</code> Project files Always (for accessing code) <code>-v ~/.aws:/root/.aws</code> AWS credentials AWS operations <code>-v ~/.config/gcloud:/root/.config/gcloud</code> GCP credentials GCP operations <code>-v ~/.ssh:/root/.ssh</code> SSH keys Git operations, SSH access <code>-v ~/.kube:/root/.kube</code> Kubernetes config kubectl operations <code>-v ~/.claude:/root/.claude</code> Claude AI credentials Claude CLI <code>-v ~/.codex:/root/.codex</code> Codex credentials Codex CLI <code>-v ~/.terraform.d:/root/.terraform.d</code> Terraform plugins cache Speed up Terraform"},{"location":"use-images/quick-reference/#common-workflows","title":"Common Workflows","text":""},{"location":"use-images/quick-reference/#terraform-deployment","title":"Terraform Deployment","text":"<pre><code># Plan\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform plan\n\n# Apply\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform apply -auto-approve\n</code></pre>"},{"location":"use-images/quick-reference/#security-scanning","title":"Security Scanning","text":"<pre><code># Scan Terraform configs\ndocker run --rm -v $PWD:/workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy config /workspace/terraform\n\n# Lint Terraform\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"cd terraform &amp;&amp; tflint --init &amp;&amp; tflint\"\n\n# Lint Ansible\ndocker run --rm -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-lint ansible/\n</code></pre>"},{"location":"use-images/quick-reference/#kubernetes-operations","title":"Kubernetes Operations","text":"<pre><code># Get pods\ndocker run --rm -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  kubectl get pods\n\n# Deploy with Helm\ndocker run --rm -v ~/.kube:/root/.kube -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  helm upgrade --install myapp ./charts/myapp\n\n# Interactive k9s\ndocker run -it --rm -v ~/.kube:/root/.kube \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  k9s\n</code></pre>"},{"location":"use-images/quick-reference/#ai-assisted-development","title":"AI-Assisted Development","text":"<pre><code># Code review with Claude\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this code for security issues\" --file main.tf\n\n# Generate code\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Generate Terraform code for AWS VPC\" &gt; vpc.tf\n</code></pre>"},{"location":"use-images/quick-reference/#useful-aliases","title":"Useful Aliases","text":"<p>Add to your <code>~/.bashrc</code> or <code>~/.zshrc</code>:</p> <pre><code># Quick access to all-devops\nalias devops='docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -v ~/.ssh:/root/.ssh \\\n  -v ~/.kube:/root/.kube \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest'\n\n# One-off commands\nalias devops-run='docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest'\n\n# Terraform-specific\nalias tf-plan='devops-run terraform plan'\nalias tf-apply='devops-run terraform apply'\nalias tf-destroy='devops-run terraform destroy'\n\n# Security scanning\nalias trivy-scan='devops-run trivy config .'\nalias tflint-scan='devops-run sh -c \"tflint --init &amp;&amp; tflint\"'\n\n# Kubernetes\nalias k='docker run --rm -v ~/.kube:/root/.kube ghcr.io/jinalshah/devops/images/all-devops:latest kubectl'\nalias k9s='docker run -it --rm -v ~/.kube:/root/.kube ghcr.io/jinalshah/devops/images/all-devops:latest k9s'\n</code></pre> <p>Usage examples:</p> <pre><code># Interactive shell\ndevops\n\n# Run Terraform\ntf-plan\ntf-apply\n\n# Get pods\nk get pods\n\n# Scan for vulnerabilities\ntrivy-scan\n</code></pre>"},{"location":"use-images/quick-reference/#tool-version-checks","title":"Tool Version Checks","text":"<pre><code># Check all versions\ndocker run --rm ghcr.io/jinalshah/devops/images/all-devops:latest sh -c \"\\\n  echo '=== Terraform ===' &amp;&amp; terraform version &amp;&amp; \\\n  echo '=== kubectl ===' &amp;&amp; kubectl version --client &amp;&amp; \\\n  echo '=== Helm ===' &amp;&amp; helm version &amp;&amp; \\\n  echo '=== Ansible ===' &amp;&amp; ansible --version &amp;&amp; \\\n  echo '=== AWS CLI ===' &amp;&amp; aws --version &amp;&amp; \\\n  echo '=== gcloud ===' &amp;&amp; gcloud --version &amp;&amp; \\\n  echo '=== Trivy ===' &amp;&amp; trivy --version &amp;&amp; \\\n  echo '=== Python ===' &amp;&amp; python3 --version &amp;&amp; \\\n  echo '=== Node.js ===' &amp;&amp; node --version\"\n</code></pre>"},{"location":"use-images/quick-reference/#environment-variables","title":"Environment Variables","text":""},{"location":"use-images/quick-reference/#aws","title":"AWS","text":"<pre><code>docker run --rm \\\n  -e AWS_ACCESS_KEY_ID=... \\\n  -e AWS_SECRET_ACCESS_KEY=... \\\n  -e AWS_DEFAULT_REGION=us-east-1 \\\n  -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform apply\n</code></pre>"},{"location":"use-images/quick-reference/#gcp","title":"GCP","text":"<pre><code>docker run --rm \\\n  -e GOOGLE_APPLICATION_CREDENTIALS=/tmp/key.json \\\n  -v $PWD:/workspace -w /workspace \\\n  -v /path/to/key.json:/tmp/key.json \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform apply\n</code></pre>"},{"location":"use-images/quick-reference/#ai-clis","title":"AI CLIs","text":"<pre><code>docker run --rm \\\n  -e ANTHROPIC_API_KEY=sk-ant-... \\\n  -e OPENAI_API_KEY=sk-... \\\n  -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this code\" --file main.tf\n</code></pre>"},{"location":"use-images/quick-reference/#image-sizes","title":"Image Sizes","text":"Image Size Use Case all-devops ~3.2 GB Multi-cloud (AWS + GCP) aws-devops ~2.8 GB AWS only (-400 MB) gcp-devops ~2.9 GB GCP only (-300 MB)"},{"location":"use-images/quick-reference/#registry-urls","title":"Registry URLs","text":""},{"location":"use-images/quick-reference/#ghcr-recommended","title":"GHCR (Recommended)","text":"<pre><code># All-devops\nghcr.io/jinalshah/devops/images/all-devops:latest\nghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n# AWS-devops\nghcr.io/jinalshah/devops/images/aws-devops:latest\n\n# GCP-devops\nghcr.io/jinalshah/devops/images/gcp-devops:latest\n</code></pre>"},{"location":"use-images/quick-reference/#gitlab-registry","title":"GitLab Registry","text":"<pre><code>registry.gitlab.com/jinal-shah/devops/images/all-devops:latest\nregistry.gitlab.com/jinal-shah/devops/images/aws-devops:latest\nregistry.gitlab.com/jinal-shah/devops/images/gcp-devops:latest\n</code></pre>"},{"location":"use-images/quick-reference/#docker-hub","title":"Docker Hub","text":"<pre><code>js01/all-devops:latest\njs01/aws-devops:latest\njs01/gcp-devops:latest\n</code></pre>"},{"location":"use-images/quick-reference/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":""},{"location":"use-images/quick-reference/#inside-k9s","title":"Inside k9s","text":"Key Action <code>0</code> Show all pods <code>d</code> Describe resource <code>l</code> Show logs <code>s</code> Open shell <code>/</code> Filter <code>:q</code> Quit"},{"location":"use-images/quick-reference/#inside-vim","title":"Inside vim","text":"Key Action <code>:w</code> Save <code>:q</code> Quit <code>:wq</code> Save and quit <code>/</code> Search <code>dd</code> Delete line <code>u</code> Undo"},{"location":"use-images/quick-reference/#quick-troubleshooting","title":"Quick Troubleshooting","text":""},{"location":"use-images/quick-reference/#image-wont-pull","title":"Image won't pull","text":"<pre><code># Try different registry\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:latest  # GHCR\ndocker pull registry.gitlab.com/jinal-shah/devops/images/all-devops:latest  # GitLab\ndocker pull js01/all-devops:latest  # Docker Hub\n</code></pre>"},{"location":"use-images/quick-reference/#permissions-issues","title":"Permissions issues","text":"<pre><code># Run with your user ID\ndocker run --rm \\\n  --user \"$(id -u):$(id -g)\" \\\n  -v $PWD:/workspace -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform fmt\n\n# Or fix ownership after\nsudo chown -R $(id -u):$(id -g) .\n</code></pre>"},{"location":"use-images/quick-reference/#credentials-not-working","title":"Credentials not working","text":"<pre><code># Verify mount\ndocker run --rm -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ls -la /root/.aws\n\n# Test authentication\ndocker run --rm -v ~/.aws:/root/.aws \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  aws sts get-caller-identity\n</code></pre>"},{"location":"use-images/quick-reference/#performance-tips","title":"Performance Tips","text":""},{"location":"use-images/quick-reference/#cache-docker-layers","title":"Cache Docker Layers","text":"<pre><code># Pull once\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n# Reuse for all commands (layers cached)\ndocker run --rm ... ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n</code></pre>"},{"location":"use-images/quick-reference/#cache-terraform-plugins","title":"Cache Terraform Plugins","text":"<pre><code># Cache plugins directory\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.terraform.d:/root/.terraform.d \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform init\n</code></pre>"},{"location":"use-images/quick-reference/#use-named-containers","title":"Use Named Containers","text":"<pre><code># Create named container\ndocker run -it --name devops-work \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Restart later\ndocker start -i devops-work\n</code></pre>"},{"location":"use-images/quick-reference/#next-steps","title":"Next Steps","text":"<ul> <li>Authentication Setup - Configure cloud credentials</li> <li>Docker Compose Examples - Multi-container setups</li> <li>Tool Basics - Detailed tool documentation</li> <li>Workflows - Real-world examples</li> </ul>"},{"location":"workflows/","title":"Workflows &amp; Patterns","text":""},{"location":"workflows/#workflows-patterns","title":"Workflows &amp; Patterns","text":"<p>Real-world examples of using DevOps Images in CI/CD pipelines and development workflows.</p>"},{"location":"workflows/#overview","title":"Overview","text":"<p>The DevOps Images integrate seamlessly with popular CI/CD platforms, providing a consistent toolset across your entire deployment pipeline.</p>"},{"location":"workflows/#cicd-integration-flow","title":"CI/CD Integration Flow","text":"<pre><code>graph LR\n    subgraph \"CI Systems\"\n        GHA[GitHub Actions]\n        GLC[GitLab CI]\n        JNK[Jenkins]\n        CCI[CircleCI]\n    end\n\n    subgraph \"Image Registry\"\n        GHCR[ghcr.io/jinalshah/devops]\n        GLREG[registry.gitlab.com]\n        DH[Docker Hub]\n    end\n\n    subgraph \"DevOps Images\"\n        ALL[all-devops]\n        AWS[aws-devops]\n        GCP[gcp-devops]\n    end\n\n    subgraph \"Your Workflows\"\n        TF[Terraform Apply]\n        AN[Ansible Playbook]\n        HL[Helm Deploy]\n        SC[Security Scan]\n        AI[AI Code Review]\n    end\n\n    GHA --&gt; GHCR\n    GLC --&gt; GLREG\n    JNK --&gt; DH\n    CCI --&gt; GHCR\n\n    GHCR --&gt; ALL &amp; AWS &amp; GCP\n    GLREG --&gt; ALL &amp; AWS &amp; GCP\n    DH --&gt; ALL &amp; AWS &amp; GCP\n\n    ALL --&gt; TF &amp; AN &amp; HL &amp; SC &amp; AI\n    AWS --&gt; TF &amp; AN &amp; HL &amp; SC\n    GCP --&gt; TF &amp; AN &amp; HL &amp; SC\n\n    style GHA fill:#2088FF,color:#fff\n    style GLC fill:#FC6D26,color:#fff\n    style ALL fill:#FF6B6B,color:#fff</code></pre>"},{"location":"workflows/#available-cicd-guides","title":"Available CI/CD Guides","text":""},{"location":"workflows/#platform-specific-examples","title":"Platform-Specific Examples","text":"Platform Guide Key Features GitHub Actions ci-cd-github.md Matrix builds, caching, secrets management GitLab CI ci-cd-gitlab.md Multi-stage pipelines, artifacts, environments Jenkins ci-cd-jenkins.md Declarative &amp; scripted pipelines, credentials CircleCI ci-cd-circleci.md Executors, workflows, caching optimisation"},{"location":"workflows/#workflow-patterns","title":"Workflow Patterns","text":"Pattern Guide Description Terraform Workflows terraform-workflows.md Terragrunt, state management, module testing Multi-Tool Patterns multi-tool-patterns.md Terraform+Helm+Ansible, security scanning AI-Assisted DevOps ai-assisted-devops.md Code review, generation, troubleshooting with AI CLIs"},{"location":"workflows/#common-workflow-scenarios","title":"Common Workflow Scenarios","text":""},{"location":"workflows/#scenario-1-infrastructure-deployment","title":"Scenario 1: Infrastructure Deployment","text":"<p>Typical Flow: Plan \u2192 Review \u2192 Apply \u2192 Configure</p> <pre><code># 1. Plan infrastructure changes\nterraform init &amp;&amp; terraform plan -out=plan.tfplan\n\n# 2. Apply infrastructure\nterraform apply plan.tfplan\n\n# 3. Configure instances with Ansible\nansible-playbook -i inventory.yml site.yml\n\n# 4. Deploy application with Helm\nhelm upgrade --install myapp ./charts/myapp\n</code></pre> <p>Best Image: <code>all-devops</code> or cloud-specific variant</p> <p>See: Terraform Workflows, Multi-Tool Patterns</p>"},{"location":"workflows/#scenario-2-security-first-pipeline","title":"Scenario 2: Security-First Pipeline","text":"<p>Typical Flow: Scan \u2192 Lint \u2192 Validate \u2192 Deploy</p> <pre><code># 1. Scan for vulnerabilities\ntrivy fs .\ntrivy config .\n\n# 2. Lint infrastructure code\ntflint --recursive\nansible-lint\n\n# 3. Validate configurations\nterraform validate\n\n# 4. Deploy if all checks pass\nterraform apply -auto-approve\n</code></pre> <p>Best Image: Any variant (all include Trivy, TFLint, ansible-lint)</p> <p>See: Multi-Tool Patterns &gt; Security Workflows</p>"},{"location":"workflows/#scenario-3-ai-assisted-code-review","title":"Scenario 3: AI-Assisted Code Review","text":"<p>Typical Flow: Generate \u2192 Review \u2192 Fix \u2192 Deploy</p> <pre><code># 1. Generate Terraform module with AI\ncodex \"create terraform module for AWS ECS cluster\"\n\n# 2. Review with Claude CLI\nclaude \"review this terraform code for security issues\" --file main.tf\n\n# 3. Lint and validate\ntflint\nterraform validate\n\n# 4. Apply infrastructure\nterraform apply\n</code></pre> <p>Best Image: Any variant (all include AI CLI tools)</p> <p>See: AI-Assisted DevOps</p>"},{"location":"workflows/#scenario-4-kubernetes-deployment","title":"Scenario 4: Kubernetes Deployment","text":"<p>Typical Flow: Build \u2192 Push \u2192 Deploy \u2192 Verify</p> <pre><code># 1. Package Helm chart\nhelm package ./charts/myapp\n\n# 2. Deploy to cluster\nhelm upgrade --install myapp ./myapp-1.0.0.tgz \\\n  --namespace production \\\n  --values values-prod.yaml\n\n# 3. Verify deployment\nkubectl rollout status deployment/myapp -n production\n\n# 4. Monitor with k9s\nk9s -n production\n</code></pre> <p>Best Image: Any variant (all include kubectl, Helm, k9s)</p> <p>See: Multi-Tool Patterns</p>"},{"location":"workflows/#workflow-best-practices","title":"Workflow Best Practices","text":""},{"location":"workflows/#1-version-pinning-in-cicd","title":"1. Version Pinning in CI/CD","text":"<p>Use Immutable Tags</p> <p>Always pin specific image versions in CI/CD pipelines:</p> <pre><code># Good - immutable tag\nimage: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n# Avoid - mutable tag (can change)\nimage: ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre>"},{"location":"workflows/#2-credential-management","title":"2. Credential Management","text":"<p>Never Commit Credentials</p> <p>Use volume mounts (local) or CI secrets (pipelines):</p> Local DevelopmentGitHub ActionsGitLab CI <pre><code>docker run --rm \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.config/gcloud:/root/.config/gcloud \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n</code></pre> <pre><code>- name: Deploy Infrastructure\n  run: terraform apply -auto-approve\n  env:\n    AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n    AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n</code></pre> <pre><code>deploy:\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:latest\n  script:\n    - terraform apply -auto-approve\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n</code></pre>"},{"location":"workflows/#3-caching-for-performance","title":"3. Caching for Performance","text":"<p>Leverage Docker Layer Caching</p> <p>Use the same image version across pipeline jobs:</p> <pre><code># GitHub Actions example\njobs:\n  plan:\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n  apply:\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    # Both jobs use the same cached image\n</code></pre>"},{"location":"workflows/#4-parallel-execution","title":"4. Parallel Execution","text":"<p>Run independent tasks in parallel for faster pipelines:</p> <pre><code># GitLab CI example\nstages:\n  - validate\n\ntflint:\n  stage: validate\n  script: [tflint]\n\nansible-lint:\n  stage: validate\n  script: [ansible-lint]\n\ntrivy-scan:\n  stage: validate\n  script: [trivy fs .]\n\n# All run in parallel\n</code></pre>"},{"location":"workflows/#5-artifact-management","title":"5. Artifact Management","text":"<p>Share state files, plans, and reports between jobs:</p> <pre><code># Example: Share Terraform plan\nplan:\n  script:\n    - terraform plan -out=plan.tfplan\n  artifacts:\n    paths:\n      - plan.tfplan\n\napply:\n  script:\n    - terraform apply plan.tfplan\n  dependencies:\n    - plan\n</code></pre>"},{"location":"workflows/#integration-examples","title":"Integration Examples","text":""},{"location":"workflows/#docker-compose-for-local-development","title":"Docker Compose for Local Development","text":"<pre><code>version: '3.8'\n\nservices:\n  devops:\n    image: ghcr.io/jinalshah/devops/images/all-devops:latest\n    volumes:\n      - .:/workspace\n      - ~/.aws:/root/.aws\n      - ~/.config/gcloud:/root/.config/gcloud\n      - ~/.ssh:/root/.ssh\n      - ~/.claude:/root/.claude\n    working_dir: /workspace\n    command: zsh\n    stdin_open: true\n    tty: true\n\n  postgres:\n    image: postgres:17\n    environment:\n      POSTGRES_PASSWORD: devpassword\n    ports:\n      - \"5432:5432\"\n</code></pre> <p>Run with: </p><pre><code>docker-compose run --rm devops\n</code></pre><p></p>"},{"location":"workflows/#vs-code-dev-container","title":"VS Code Dev Container","text":"<pre><code>{\n  \"name\": \"DevOps Environment\",\n  \"image\": \"ghcr.io/jinalshah/devops/images/all-devops:latest\",\n  \"mounts\": [\n    \"source=${localEnv:HOME}/.aws,target=/root/.aws,type=bind\",\n    \"source=${localEnv:HOME}/.config/gcloud,target=/root/.config/gcloud,type=bind\",\n    \"source=${localEnv:HOME}/.ssh,target=/root/.ssh,type=bind\"\n  ],\n  \"extensions\": [\n    \"hashicorp.terraform\",\n    \"redhat.ansible\",\n    \"ms-kubernetes-tools.vscode-kubernetes-tools\"\n  ]\n}\n</code></pre>"},{"location":"workflows/#monitoring-and-debugging","title":"Monitoring and Debugging","text":""},{"location":"workflows/#common-troubleshooting-commands","title":"Common Troubleshooting Commands","text":"<pre><code># Check tool versions\nterraform version\nkubectl version\nhelm version\naws --version\ngcloud version\n\n# Test cloud authentication\naws sts get-caller-identity\ngcloud auth list\n\n# Verify Kubernetes connectivity\nkubectl cluster-info\nkubectl get nodes\n\n# Test Ansible connectivity\nansible all -i inventory.yml -m ping\n</code></pre>"},{"location":"workflows/#debugging-cicd-issues","title":"Debugging CI/CD Issues","text":"<p>Debug Container Locally</p> <p>Reproduce CI failures locally using the same image:</p> <pre><code># Pull the exact version from CI\ndocker pull ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n# Run interactively\ndocker run -it --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234 \\\n  zsh\n\n# Run the failing command\nterraform apply -auto-approve\n</code></pre>"},{"location":"workflows/#performance-optimisation","title":"Performance Optimisation","text":""},{"location":"workflows/#image-pull-optimisation","title":"Image Pull Optimisation","text":"<ol> <li>Use GHCR - Fastest global CDN, no rate limits</li> <li>Pin versions - Enable Docker layer caching</li> <li>Pre-pull images - In CI, pull during setup phase</li> <li>Use smaller images - aws-devops/gcp-devops vs all-devops</li> </ol>"},{"location":"workflows/#pipeline-optimisation","title":"Pipeline Optimisation","text":"<ol> <li>Parallel jobs - Run independent tasks concurrently</li> <li>Cache dependencies - Terraform plugins, Helm charts</li> <li>Skip unchanged - Use <code>git diff</code> to skip unchanged infrastructure</li> <li>Workspace cleanup - Remove old workspaces and plans</li> </ol>"},{"location":"workflows/#next-steps","title":"Next Steps","text":"<p>By Platform:</p> <ul> <li>GitHub Actions Examples</li> <li>GitLab CI Examples</li> <li>Jenkins Examples</li> <li>CircleCI Examples</li> </ul> <p>By Pattern:</p> <ul> <li>Terraform Workflows</li> <li>Multi-Tool Patterns</li> <li>AI-Assisted DevOps</li> </ul> <p>Other Resources:</p> <ul> <li>Authentication Setup</li> <li>Tool Basics</li> <li>Troubleshooting</li> </ul>"},{"location":"workflows/ai-assisted-devops/","title":"AI-Assisted DevOps Workflows","text":""},{"location":"workflows/ai-assisted-devops/#ai-assisted-devops-workflows","title":"AI-Assisted DevOps Workflows","text":"<p>Leverage AI CLI tools (Claude, Codex, Copilot, Gemini) for code generation, review, and troubleshooting in your DevOps workflows.</p> <p>AI CLI Tools Included</p> <p>All DevOps Images include four AI CLI assistants. See the AI CLI Setup Guide for authentication details.</p>"},{"location":"workflows/ai-assisted-devops/#overview","title":"Overview","text":"<p>The DevOps Images include four powerful AI CLI tools that can accelerate your infrastructure and automation workflows:</p> AI Tool Provider Strengths Best For Claude CLI Anthropic Long context (200K tokens), reasoning, analysis Code review, architecture decisions, documentation Codex CLI OpenAI Fast code generation Quick scripts, Terraform modules, one-off tasks Copilot CLI GitHub GitHub integration PR reviews, GitHub Actions, repository operations Gemini CLI Google Multi-modal, GCP knowledge GCP-specific tasks, image analysis, diverse inputs"},{"location":"workflows/ai-assisted-devops/#common-ai-assisted-workflows","title":"Common AI-Assisted Workflows","text":""},{"location":"workflows/ai-assisted-devops/#workflow-1-ai-code-review-before-deployment","title":"Workflow 1: AI Code Review Before Deployment","text":"<p>Use AI to review infrastructure code before applying changes:</p> <pre><code>sequenceDiagram\n    participant Dev as Developer\n    participant Claude as Claude CLI\n    participant TFLint as TFLint\n    participant Trivy as Trivy\n    participant TF as Terraform\n\n    Dev-&gt;&gt;Claude: Review Terraform code\n    Claude--&gt;&gt;Dev: Suggestions + issues found\n\n    Dev-&gt;&gt;Dev: Fix issues\n\n    Dev-&gt;&gt;TFLint: Lint code\n    TFLint--&gt;&gt;Dev: Validation passed\n\n    Dev-&gt;&gt;Trivy: Security scan\n    Trivy--&gt;&gt;Dev: No vulnerabilities\n\n    Dev-&gt;&gt;TF: terraform apply\n    TF--&gt;&gt;Dev: Deployment successful</code></pre> <p>Implementation:</p> <pre><code>#!/bin/bash\n# AI-powered review pipeline\n\necho \"\ud83e\udd16 Running AI code review...\"\n\n# Step 1: AI review with Claude\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this Terraform code for security issues, best practices, and potential bugs. Focus on: 1) Security groups and IAM policies, 2) Resource naming and tagging, 3) State management, 4) Cost optimization\" \\\n  --file terraform/main.tf \\\n  &gt; ai-review.md\n\n# Step 2: Validate with TFLint\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"cd terraform &amp;&amp; tflint\"\n\n# Step 3: Security scan with Trivy\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy config workspace/terraform\n\n# Step 4: Review AI suggestions\ncat ai-review.md\n\necho \"\u2705 Review complete! Check ai-review.md for AI suggestions.\"\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#workflow-2-generate-infrastructure-code-with-ai","title":"Workflow 2: Generate Infrastructure Code with AI","text":"<p>Generate Terraform modules or Ansible playbooks from natural language:</p> <pre><code># Generate a Terraform module for AWS VPC\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.codex:/root/.codex \\\n  -e OPENAI_API_KEY=$OPENAI_API_KEY \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex \"Create a Terraform module for an AWS VPC with:\n  - 3 public subnets across 3 AZs\n  - 3 private subnets across 3 AZs\n  - NAT gateways in each public subnet\n  - Internet gateway\n  - Proper route tables\n  - VPC Flow Logs to CloudWatch\n  - Tags for environment and project\n  Output as main.tf, variables.tf, and outputs.tf\" \\\n  &gt; modules/vpc/main.tf\n\n# Validate generated code\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace/modules/vpc \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform validate\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#workflow-3-ai-powered-troubleshooting","title":"Workflow 3: AI-Powered Troubleshooting","text":"<p>Use AI to diagnose and fix errors:</p> <pre><code># Capture error\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terraform apply 2&gt;&amp;1 | tee error.log\n\n# AI diagnosis\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Analyze this Terraform error and provide:\n  1. Root cause explanation\n  2. Step-by-step fix\n  3. Prevention tips for the future\" \\\n  --stdin &lt; error.log\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#workflow-4-documentation-generation","title":"Workflow 4: Documentation Generation","text":"<p>Auto-generate documentation from code:</p> <pre><code># Generate README for Terraform module\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Generate comprehensive documentation for this Terraform module including:\n  - Purpose and use cases\n  - Input variables with descriptions and defaults\n  - Outputs with descriptions\n  - Usage examples\n  - Prerequisites\n  - Architecture diagram in Mermaid format\n  Output in README.md format\" \\\n  --file modules/eks/main.tf \\\n  &gt; modules/eks/README.md\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#real-world-examples","title":"Real-World Examples","text":""},{"location":"workflows/ai-assisted-devops/#example-1-ai-reviewed-terraform-module","title":"Example 1: AI-Reviewed Terraform Module","text":"<p>Scenario: Create and review an AWS EKS cluster module</p> <pre><code># Step 1: Generate module with Codex\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -e OPENAI_API_KEY=$OPENAI_API_KEY \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex \"Create a production-ready Terraform module for AWS EKS cluster with:\n  - EKS cluster version 1.28\n  - Node groups with auto-scaling\n  - IRSA (IAM Roles for Service Accounts)\n  - CloudWatch logging\n  - Encryption at rest\n  - Private endpoint access\n  Include variables.tf and outputs.tf\" \\\n  &gt; modules/eks/main.tf\n\n# Step 2: Review with Claude\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this EKS module for:\n  1. Security best practices (encryption, IAM, network policies)\n  2. High availability configuration\n  3. Cost optimization opportunities\n  4. Missing critical configurations\n  Provide specific recommendations\" \\\n  --file modules/eks/main.tf \\\n  &gt; modules/eks/review.md\n\n# Step 3: Validate\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace/modules/eks \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"terraform init &amp;&amp; terraform validate &amp;&amp; tflint\"\n\n# Step 4: Security scan\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy config workspace/modules/eks\n\necho \"\u2705 Module generated, reviewed, and validated!\"\necho \"\ud83d\udcc4 See modules/eks/review.md for AI recommendations\"\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#example-2-ansible-playbook-generation-and-optimisation","title":"Example 2: Ansible Playbook Generation and Optimisation","text":"<pre><code># Generate playbook\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -e OPENAI_API_KEY=$OPENAI_API_KEY \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex \"Create an Ansible playbook to:\n  - Install Docker on Ubuntu 22.04\n  - Configure Docker daemon with custom settings\n  - Set up Docker log rotation\n  - Add user to docker group\n  - Enable and start Docker service\n  Use best practices and idempotent tasks\" \\\n  &gt; playbooks/docker-setup.yml\n\n# Review and optimize with Claude\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Review this Ansible playbook for:\n  - Idempotency\n  - Error handling\n  - Security considerations\n  - Performance optimization\n  - Best practices\n  Suggest improvements\" \\\n  --file playbooks/docker-setup.yml\n\n# Lint\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  ansible-lint playbooks/docker-setup.yml\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#example-3-multi-cloud-migration-planning","title":"Example 3: Multi-Cloud Migration Planning","text":"<p>Use AI to plan and execute cloud migrations:</p> <pre><code># Analyze existing AWS infrastructure\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Analyze this AWS infrastructure and create a migration plan to GCP. Include:\n  1. Service mapping (AWS \u2192 GCP equivalents)\n  2. Migration strategy (lift-and-shift vs re-architect)\n  3. Estimated effort and timeline\n  4. Risks and mitigation strategies\n  5. Cost comparison\n  Output as a detailed migration plan\" \\\n  --file terraform/aws/main.tf \\\n  &gt; migration-plan.md\n\n# Generate GCP equivalent\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.gemini:/root/.gemini \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/gcp-devops:latest \\\n  gemini \"Convert this AWS Terraform configuration to GCP equivalent using Google Cloud Platform best practices\" \\\n  --file terraform/aws/main.tf \\\n  &gt; terraform/gcp/main.tf\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#example-4-cicd-pipeline-enhancement","title":"Example 4: CI/CD Pipeline Enhancement","text":"<p>Get AI suggestions for improving your pipelines:</p> <pre><code># Review GitHub Actions workflow\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.copilot:/root/.copilot \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  copilot \"Review this GitHub Actions workflow and suggest:\n  - Performance optimizations (caching, parallelization)\n  - Security improvements\n  - Better error handling\n  - Cost reduction strategies\n  - Additional quality gates\" \\\n  --file .github/workflows/deploy.yml\n\n# Generate GitLab CI equivalent\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -e OPENAI_API_KEY=$OPENAI_API_KEY \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  codex \"Convert this GitHub Actions workflow to GitLab CI format with equivalent functionality\" \\\n  --file .github/workflows/deploy.yml \\\n  &gt; .gitlab-ci.yml\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#advanced-ai-workflows","title":"Advanced AI Workflows","text":""},{"location":"workflows/ai-assisted-devops/#workflow-ai-powered-security-audit","title":"Workflow: AI-Powered Security Audit","text":"<p>Comprehensive security review using multiple AI tools:</p> <pre><code>#!/bin/bash\n# ai-security-audit.sh\n\nWORKSPACE=$PWD\n\necho \"\ud83d\udd12 Starting AI-powered security audit...\"\n\n# Audit 1: Terraform security with Claude\necho \"1\ufe0f\u20e3 Terraform security review...\"\ndocker run --rm \\\n  -v $WORKSPACE:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Perform a comprehensive security audit of this Terraform code. Check for:\n  - Overly permissive IAM policies\n  - Public-facing resources\n  - Unencrypted data stores\n  - Missing security groups\n  - Hardcoded secrets\n  - Compliance issues (CIS benchmarks)\n  Rate each finding by severity\" \\\n  --file terraform/ \\\n  &gt; reports/terraform-security.md\n\n# Audit 2: Ansible security with Claude\necho \"2\ufe0f\u20e3 Ansible security review...\"\ndocker run --rm \\\n  -v $WORKSPACE:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Audit these Ansible playbooks for security issues:\n  - Privilege escalation risks\n  - Insecure file permissions\n  - Hardcoded credentials\n  - Unsafe module usage\n  - Missing input validation\" \\\n  --file ansible/ \\\n  &gt; reports/ansible-security.md\n\n# Audit 3: Container security with Trivy + Claude interpretation\necho \"3\ufe0f\u20e3 Container security scan...\"\ndocker run --rm \\\n  -v $WORKSPACE:/workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  trivy config workspace/ --format json \\\n  &gt; reports/trivy-results.json\n\ndocker run --rm \\\n  -v $WORKSPACE:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Analyze this Trivy scan result and provide:\n  - Executive summary\n  - Critical findings prioritized\n  - Remediation steps\n  - Long-term recommendations\" \\\n  --file reports/trivy-results.json \\\n  &gt; reports/trivy-analysis.md\n\n# Audit 4: CI/CD pipeline security\necho \"4\ufe0f\u20e3 CI/CD security review...\"\ndocker run --rm \\\n  -v $WORKSPACE:/workspace \\\n  -v ~/.copilot:/root/.copilot \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  copilot \"Audit CI/CD workflows for security issues:\n  - Secrets management\n  - Permission scopes\n  - Third-party actions security\n  - Code injection risks\n  - Artifact security\" \\\n  --file .github/workflows/ \\\n  &gt; reports/cicd-security.md\n\necho \"\u2705 Security audit complete!\"\necho \"\ud83d\udcca Reports generated in reports/\"\nls -lh reports/\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#workflow-automated-infrastructure-documentation","title":"Workflow: Automated Infrastructure Documentation","text":"<p>Keep documentation in sync with code:</p> <pre><code>#!/bin/bash\n# auto-document.sh\n\n# Generate module documentation\nfor module in modules/*; do\n  echo \"\ud83d\udcdd Documenting $module...\"\n\n  docker run --rm \\\n    -v $PWD:/workspace \\\n    -v ~/.claude:/root/.claude \\\n    -w /workspace \\\n    ghcr.io/jinalshah/devops/images/all-devops:latest \\\n    claude \"Generate complete documentation for this Terraform module:\n    - Overview and purpose\n    - Architecture diagram (Mermaid)\n    - Variables table with descriptions, types, defaults\n    - Outputs table\n    - Usage examples\n    - Dependencies\n    - Version requirements\n    Format as professional README.md\" \\\n    --file $module/main.tf \\\n    &gt; $module/README.md\n\n  echo \"\u2705 Generated $module/README.md\"\ndone\n\n# Generate architecture diagrams\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  claude \"Analyze all Terraform modules and create a high-level architecture diagram in Mermaid format showing:\n  - Resource relationships\n  - Data flow\n  - Network topology\n  - External dependencies\" \\\n  --file terraform/ \\\n  &gt; docs/architecture.md\n\necho \"\ud83d\udcda Documentation generation complete!\"\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#cicd-integration-with-ai-review","title":"CI/CD Integration with AI Review","text":""},{"location":"workflows/ai-assisted-devops/#github-actions-ai-code-review-bot","title":"GitHub Actions: AI Code Review Bot","text":"<pre><code>name: AI Code Review\n\non:\n  pull_request:\n    paths:\n      - 'terraform/**'\n      - 'ansible/**'\n\njobs:\n  ai-review:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:latest\n\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Get changed files\n        id: changed-files\n        run: |\n          git diff --name-only origin/${{ github.base_ref }}...HEAD &gt; changed_files.txt\n\n      - name: AI Review with Claude\n        env:\n          CLAUDE_API_KEY: ${{ secrets.CLAUDE_API_KEY }}\n        run: |\n          mkdir -p reviews\n\n          # Review each changed file\n          while IFS= read -r file; do\n            if [[ $file == *.tf ]] || [[ $file == *.yml ]]; then\n              echo \"Reviewing $file...\"\n              claude \"Review this file for:\n              - Security issues\n              - Best practices\n              - Potential bugs\n              - Performance concerns\n              Provide specific, actionable feedback\" \\\n              --file \"$file\" \\\n              &gt; \"reviews/$(basename $file).review.md\"\n            fi\n          done &lt; changed_files.txt\n\n      - name: Post Review Comment\n        uses: actions/github-script@v7\n        with:\n          script: |\n            const fs = require('fs');\n            const reviews = fs.readdirSync('reviews')\n              .map(file =&gt; fs.readFileSync(`reviews/${file}`, 'utf8'))\n              .join('\\n\\n---\\n\\n');\n\n            github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: `## \ud83e\udd16 AI Code Review\\n\\n${reviews}`\n            });\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#gitlab-ci-ai-enhanced-pipeline","title":"GitLab CI: AI-Enhanced Pipeline","text":"<pre><code>stages:\n  - ai-review\n  - validate\n  - deploy\n\nai:review:\n  stage: ai-review\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:latest\n  script:\n    - |\n      claude \"Review this merge request's infrastructure changes for:\n      - Security vulnerabilities\n      - Cost implications\n      - Architectural concerns\n      - Breaking changes\n      Provide a summary and recommendations\" \\\n      --file terraform/ \\\n      &gt; ai-review.md\n\n      # Post to MR discussion\n      curl --request POST \\\n        --header \"PRIVATE-TOKEN: $GITLAB_TOKEN\" \\\n        --data \"body=$(cat ai-review.md)\" \\\n        \"$CI_API_V4_URL/projects/$CI_PROJECT_ID/merge_requests/$CI_MERGE_REQUEST_IID/notes\"\n  only:\n    - merge_requests\n</code></pre>"},{"location":"workflows/ai-assisted-devops/#best-practices","title":"Best Practices","text":"<p>AI CLI Best Practices</p> <ol> <li>Be Specific: Provide detailed context and requirements</li> <li>Iterate: Use AI suggestions as starting point, refine as needed</li> <li>Validate: Always validate AI-generated code with linters and tests</li> <li>Review: Manually review AI suggestions, don't blindly accept</li> <li>Combine Tools: Use multiple AI tools for different perspectives</li> <li>Version Control: Track AI prompts and responses for reproducibility</li> </ol> <p>AI Limitations</p> <ul> <li>Not Infallible: AI can make mistakes or hallucinate</li> <li>Context Limits: Large codebases may exceed context windows</li> <li>Outdated Knowledge: May not know latest tool versions</li> <li>Security Sensitive: Never share production secrets with AI</li> <li>Compliance: Review AI-generated code for compliance requirements</li> </ul>"},{"location":"workflows/ai-assisted-devops/#cost-optimisation","title":"Cost Optimisation","text":"<p>AI API calls have costs. Optimise usage:</p> <ol> <li>Batch operations: Review multiple files in one prompt</li> <li>Cache responses: Save reviews for similar code patterns</li> <li>Use appropriate models: Smaller models for simple tasks</li> <li>Set budgets: Use API rate limits and spending caps</li> <li>Local alternatives: Consider local LLMs for sensitive work</li> </ol>"},{"location":"workflows/ai-assisted-devops/#troubleshooting","title":"Troubleshooting","text":"AI CLI authentication failing <p>See AI CLI Setup Guide for detailed authentication steps for each tool.</p> Context window exceeded <p>Problem: File too large for AI context</p> <p>Solution: Split into smaller chunks or use summary approach </p><pre><code># Summarize large file first\nhead -n 100 large-file.tf &gt; summary.tf\nclaude \"Review this excerpt\" --file summary.tf\n</code></pre><p></p> AI responses are generic or unhelpful <p>Problem: Prompt lacks specificity</p> <p>Solution: Provide more context and specific requirements </p><pre><code># \u274c Bad: Generic\nclaude \"Review this code\" --file main.tf\n\n# \u2705 Good: Specific\nclaude \"Review this Terraform code for:\n1. IAM permission security (check for * wildcards)\n2. S3 bucket encryption at rest\n3. VPC security group rules (no 0.0.0.0/0)\n4. Missing tags (environment, project, owner)\n5. Cost optimization opportunities\" \\\n--file main.tf\n</code></pre><p></p>"},{"location":"workflows/ai-assisted-devops/#next-steps","title":"Next Steps","text":"<ul> <li>AI CLI Setup Guide - Authentication and configuration</li> <li>Multi-Tool Patterns - Combining AI with other DevOps tools</li> <li>GitHub Actions Examples - Complete CI/CD configurations</li> <li>Authentication Guide - Credential management</li> </ul>"},{"location":"workflows/ci-cd-circleci/","title":"CircleCI Integration","text":""},{"location":"workflows/ci-cd-circleci/#circleci-integration","title":"CircleCI Integration","text":"<p>Complete guide to using DevOps Images in CircleCI pipelines for automated infrastructure deployment, testing, and validation.</p> <p>Why CircleCI?</p> <ul> <li>Cloud-hosted or self-hosted options</li> <li>Powerful workflow orchestration</li> <li>Docker layer caching included in paid plans</li> <li>Generous free tier (6,000 build minutes/month)</li> </ul>"},{"location":"workflows/ci-cd-circleci/#basic-setup","title":"Basic Setup","text":""},{"location":"workflows/ci-cd-circleci/#simple-terraform-deployment","title":"Simple Terraform Deployment","text":"<p>Deploy infrastructure on every push to main:</p> <pre><code>version: 2.1\n\njobs:\n  deploy:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234  # (1)!\n    steps:\n      - checkout  # (2)!\n\n      - run:\n          name: Terraform Init\n          command: terraform init\n\n      - run:\n          name: Terraform Apply\n          command: terraform apply -auto-approve\n          environment:  # (3)!\n            AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}\n            AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}\n            AWS_DEFAULT_REGION: us-east-1\n\nworkflows:\n  deploy-infrastructure:\n    jobs:\n      - deploy:\n          filters:  # (4)!\n            branches:\n              only: main\n</code></pre> <ol> <li>Use DevOps Image as executor</li> <li>Check out code from repository</li> <li>Set environment variables from CircleCI context</li> <li>Only run on main branch</li> </ol>"},{"location":"workflows/ci-cd-circleci/#multi-stage-pipeline","title":"Multi-Stage Pipeline","text":""},{"location":"workflows/ci-cd-circleci/#validate-plan-apply","title":"Validate \u2192 Plan \u2192 Apply","text":"<pre><code>version: 2.1\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\njobs:\n  validate:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Terraform Format Check\n          command: terraform fmt -check -recursive\n\n      - run:\n          name: TFLint\n          command: |\n            cd terraform\n            tflint --init\n            tflint\n\n      - run:\n          name: Trivy Scan\n          command: |\n            trivy config ./terraform \\\n              --severity HIGH,CRITICAL \\\n              --exit-code 1\n\n  plan:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Terraform Plan\n          command: |\n            cd terraform\n            terraform init\n            terraform plan -out=tfplan\n\n      - persist_to_workspace:  # (1)!\n          root: terraform\n          paths:\n            - tfplan\n            - .terraform\n\n  apply:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - attach_workspace:  # (2)!\n          at: terraform\n\n      - run:\n          name: Terraform Apply\n          command: |\n            cd terraform\n            terraform init\n            terraform apply tfplan\n\nworkflows:\n  terraform-pipeline:\n    jobs:\n      - validate\n      - plan:\n          requires:\n            - validate\n      - hold-for-approval:  # (3)!\n          type: approval\n          requires:\n            - plan\n          filters:\n            branches:\n              only: main\n      - apply:\n          requires:\n            - hold-for-approval\n</code></pre> <ol> <li>Save plan artifact to workspace</li> <li>Restore plan artifact from workspace</li> <li>Manual approval gate for production</li> </ol>"},{"location":"workflows/ci-cd-circleci/#multi-cloud-deployment","title":"Multi-Cloud Deployment","text":""},{"location":"workflows/ci-cd-circleci/#deploy-to-both-aws-and-gcp","title":"Deploy to Both AWS and GCP","text":"<pre><code>version: 2.1\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\njobs:\n  deploy-aws:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Deploy AWS Infrastructure\n          command: |\n            cd terraform/aws\n            terraform init\n            terraform apply -auto-approve\n          environment:\n            AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}\n            AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}\n            AWS_DEFAULT_REGION: us-east-1\n\n  deploy-gcp:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Setup GCP Credentials\n          command: |\n            echo $GCP_SA_KEY | base64 -d &gt; /tmp/gcp-key.json\n            export GOOGLE_APPLICATION_CREDENTIALS=/tmp/gcp-key.json\n\n      - run:\n          name: Deploy GCP Infrastructure\n          command: |\n            cd terraform/gcp\n            terraform init\n            terraform apply -auto-approve\n\nworkflows:\n  multi-cloud-deploy:\n    jobs:\n      - deploy-aws:\n          context: aws-production  # (1)!\n          filters:\n            branches:\n              only: main\n      - deploy-gcp:\n          context: gcp-production  # (2)!\n          filters:\n            branches:\n              only: main\n</code></pre> <ol> <li>Use CircleCI context for AWS credentials</li> <li>Use CircleCI context for GCP credentials</li> </ol>"},{"location":"workflows/ci-cd-circleci/#matrix-builds","title":"Matrix Builds","text":""},{"location":"workflows/ci-cd-circleci/#deploy-to-multiple-environments","title":"Deploy to Multiple Environments","text":"<pre><code>version: 2.1\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    environment:\n      TF_DIR: terraform/&lt;&lt; parameters.cloud &gt;&gt;/&lt;&lt; parameters.environment &gt;&gt;\n\nparameters:\n  cloud:\n    type: string\n  environment:\n    type: string\n\njobs:\n  deploy:\n    executor: devops-executor\n    parameters:\n      cloud:\n        type: string\n      environment:\n        type: string\n    steps:\n      - checkout\n\n      - run:\n          name: Deploy &lt;&lt; parameters.cloud &gt;&gt; &lt;&lt; parameters.environment &gt;&gt;\n          command: |\n            cd terraform/&lt;&lt; parameters.cloud &gt;&gt;/&lt;&lt; parameters.environment &gt;&gt;\n            terraform init\n            terraform apply -auto-approve\n\nworkflows:\n  deploy-all-environments:\n    jobs:\n      # AWS environments\n      - deploy:\n          name: deploy-aws-dev\n          cloud: aws\n          environment: dev\n          context: aws-dev\n\n      - deploy:\n          name: deploy-aws-staging\n          cloud: aws\n          environment: staging\n          context: aws-staging\n          requires:\n            - deploy-aws-dev\n\n      - deploy:\n          name: deploy-aws-prod\n          cloud: aws\n          environment: production\n          context: aws-production\n          requires:\n            - deploy-aws-staging\n\n      # GCP environments\n      - deploy:\n          name: deploy-gcp-dev\n          cloud: gcp\n          environment: dev\n          context: gcp-dev\n\n      - deploy:\n          name: deploy-gcp-staging\n          cloud: gcp\n          environment: staging\n          context: gcp-staging\n          requires:\n            - deploy-gcp-dev\n</code></pre>"},{"location":"workflows/ci-cd-circleci/#security-scanning-pipeline","title":"Security Scanning Pipeline","text":""},{"location":"workflows/ci-cd-circleci/#comprehensive-security-checks","title":"Comprehensive Security Checks","text":"<pre><code>version: 2.1\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\njobs:\n  trivy-scan:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Trivy IaC Scan\n          command: |\n            trivy config ./terraform \\\n              --format json \\\n              --output trivy-report.json\n            trivy config ./terraform \\\n              --severity HIGH,CRITICAL\n\n      - store_artifacts:  # (1)!\n          path: trivy-report.json\n\n  tflint:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: TFLint\n          command: |\n            cd terraform\n            tflint --init\n            tflint --minimum-failure-severity=error\n\n  cfn-lint:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: CloudFormation Lint\n          command: cfn-lint cloudformation/**/*.yaml\n\n  ansible-lint:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Ansible Lint\n          command: ansible-lint ansible/\n\nworkflows:\n  security-scan:\n    jobs:\n      - trivy-scan\n      - tflint\n      - cfn-lint\n      - ansible-lint\n</code></pre> <ol> <li>Store scan results as CircleCI artifacts</li> </ol>"},{"location":"workflows/ci-cd-circleci/#kubernetes-deployment","title":"Kubernetes Deployment","text":""},{"location":"workflows/ci-cd-circleci/#deploy-to-eksgke-with-helm","title":"Deploy to EKS/GKE with Helm","text":"<pre><code>version: 2.1\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\njobs:\n  deploy-eks:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Configure kubectl for EKS\n          command: |\n            aws eks update-kubeconfig \\\n              --region us-east-1 \\\n              --name my-eks-cluster\n          environment:\n            AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}\n            AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}\n\n      - run:\n          name: Deploy with Helm\n          command: |\n            helm upgrade --install myapp ./charts/myapp \\\n              --namespace production \\\n              --create-namespace \\\n              --set image.tag=${CIRCLE_SHA1:0:7} \\\n              --wait \\\n              --timeout 5m\n\n      - run:\n          name: Verify Deployment\n          command: |\n            kubectl rollout status deployment/myapp -n production\n            kubectl get pods -n production\n\nworkflows:\n  k8s-deploy:\n    jobs:\n      - deploy-eks:\n          context: aws-production\n          filters:\n            branches:\n              only: main\n</code></pre>"},{"location":"workflows/ci-cd-circleci/#docker-layer-caching","title":"Docker Layer Caching","text":""},{"location":"workflows/ci-cd-circleci/#speed-up-builds-with-dlc","title":"Speed Up Builds with DLC","text":"<pre><code>version: 2.1\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\njobs:\n  build-and-deploy:\n    executor: devops-executor\n    steps:\n      - checkout\n      - setup_remote_docker:  # (1)!\n          docker_layer_caching: true  # (2)!\n\n      - run:\n          name: Build Docker Image\n          command: docker build -t myapp:${CIRCLE_SHA1} .\n\n      - run:\n          name: Push to Registry\n          command: |\n            echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin\n            docker push myapp:${CIRCLE_SHA1}\n\nworkflows:\n  build-deploy:\n    jobs:\n      - build-and-deploy\n</code></pre> <ol> <li>Enable remote Docker for building images</li> <li>Enable Docker Layer Caching (requires paid plan)</li> </ol>"},{"location":"workflows/ci-cd-circleci/#orbs-integration","title":"Orbs Integration","text":""},{"location":"workflows/ci-cd-circleci/#using-circleci-orbs-with-devops-images","title":"Using CircleCI Orbs with DevOps Images","text":"<pre><code>version: 2.1\n\norbs:\n  aws-cli: circleci/aws-cli@4.0  # (1)!\n  slack: circleci/slack@4.12\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\njobs:\n  deploy:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - aws-cli/setup:  # (2)!\n          profile_name: default\n\n      - run:\n          name: Terraform Apply\n          command: |\n            terraform init\n            terraform apply -auto-approve\n\n      - slack/notify:  # (3)!\n          event: pass\n          template: success_tagged_deploy_1\n\n      - slack/notify:\n          event: fail\n          template: basic_fail_1\n\nworkflows:\n  deploy-with-notifications:\n    jobs:\n      - deploy:\n          context:\n            - aws-production\n            - slack\n</code></pre> <ol> <li>Import CircleCI orbs for common tasks</li> <li>Use AWS CLI orb to configure credentials</li> <li>Send Slack notifications on success/failure</li> </ol>"},{"location":"workflows/ci-cd-circleci/#ai-assisted-code-review","title":"AI-Assisted Code Review","text":""},{"location":"workflows/ci-cd-circleci/#automated-review-with-claude-cli","title":"Automated Review with Claude CLI","text":"<pre><code>version: 2.1\n\nexecutors:\n  devops-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\njobs:\n  ai-review:\n    executor: devops-executor\n    steps:\n      - checkout\n\n      - run:\n          name: Setup Claude CLI\n          command: |\n            mkdir -p ~/.claude\n            echo \"${CLAUDE_API_KEY}\" &gt; ~/.claude/config.json\n\n      - run:\n          name: Review Terraform Changes\n          command: |\n            git diff origin/main...HEAD -- terraform/ &gt; changes.diff\n            claude \"Review this Terraform code for security issues and best practices\" \\\n              --file changes.diff \\\n              &gt; review-output.md\n\n      - store_artifacts:\n          path: review-output.md\n\n      - run:\n          name: Post Review to PR\n          command: |\n            # Post to GitHub PR comment\n            curl -X POST \\\n              -H \"Authorization: token ${GITHUB_TOKEN}\" \\\n              -d \"{\\\"body\\\": \\\"$(cat review-output.md)\\\"}\" \\\n              https://api.github.com/repos/${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}/issues/${CIRCLE_PULL_REQUEST##*/}/comments\n\nworkflows:\n  pr-review:\n    jobs:\n      - ai-review:\n          filters:\n            branches:\n              ignore: main\n</code></pre>"},{"location":"workflows/ci-cd-circleci/#best-practices","title":"Best Practices","text":"<p>Performance Optimisation</p> <ol> <li>Use executors: Define reusable executors to avoid repetition</li> <li>Enable DLC: Docker Layer Caching speeds up image pulls (paid feature)</li> <li>Cache dependencies: Cache Terraform plugins and modules</li> <li>Parallel jobs: Run independent jobs in parallel</li> <li>Use workspaces: Share data between jobs efficiently</li> </ol> <p>Security Best Practices</p> <ol> <li>Use Contexts: Store secrets in CircleCI contexts</li> <li>Limit context access: Restrict contexts to specific teams/projects</li> <li>Use approval jobs: Add manual gates for production deployments</li> <li>Rotate secrets: Regularly rotate credentials stored in contexts</li> <li>Audit logs: Review CircleCI audit logs regularly</li> </ol> <p>Common Pitfalls</p> <ul> <li>\u274c Using <code>latest</code> tag: Non-reproducible builds</li> <li>\u274c Hardcoding secrets: Always use CircleCI contexts or environment variables</li> <li>\u274c No resource classes: Can lead to slow builds (upgrade to larger resource class)</li> <li>\u274c Ignoring artifacts: Store important files for debugging</li> </ul>"},{"location":"workflows/ci-cd-circleci/#resource-classes","title":"Resource Classes","text":""},{"location":"workflows/ci-cd-circleci/#optimise-build-performance","title":"Optimise Build Performance","text":"<pre><code>version: 2.1\n\nexecutors:\n  small-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    resource_class: small  # 1 vCPU, 2GB RAM\n\n  medium-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    resource_class: medium  # 2 vCPUs, 4GB RAM\n\n  large-executor:\n    docker:\n      - image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    resource_class: large  # 4 vCPUs, 8GB RAM\n\njobs:\n  lint:\n    executor: small-executor  # Fast linting doesn't need resources\n    steps:\n      - checkout\n      - run: terraform fmt -check\n\n  deploy:\n    executor: large-executor  # Complex deployments benefit from resources\n    steps:\n      - checkout\n      - run: terraform apply -auto-approve\n</code></pre>"},{"location":"workflows/ci-cd-circleci/#troubleshooting","title":"Troubleshooting","text":"Image pull rate limited <p>Problem: Docker Hub rate limits exceeded</p> <p>Solution: Use GHCR or authenticate with Docker Hub </p><pre><code>- run:\n    name: Login to Docker Hub\n    command: echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin\n</code></pre><p></p> Workspace not persisting <p>Problem: Files not available in downstream jobs</p> <p>Solution: Use <code>persist_to_workspace</code> and <code>attach_workspace</code> </p><pre><code># In first job\n- persist_to_workspace:\n    root: .\n    paths:\n      - terraform/tfplan\n\n# In second job\n- attach_workspace:\n    at: .\n</code></pre><p></p> Environment variables not set <p>Problem: Variables from context not accessible</p> <p>Solution: Ensure job uses correct context </p><pre><code>workflows:\n  deploy:\n    jobs:\n      - deploy-job:\n          context: production  # Make sure context is specified\n</code></pre><p></p>"},{"location":"workflows/ci-cd-circleci/#example-repository-structure","title":"Example Repository Structure","text":"<pre><code>.\n\u251c\u2500\u2500 .circleci/\n\u2502   \u2514\u2500\u2500 config.yml\n\u251c\u2500\u2500 terraform/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u251c\u2500\u2500 staging/\n\u2502   \u2514\u2500\u2500 production/\n\u251c\u2500\u2500 ansible/\n\u2502   \u2514\u2500\u2500 playbooks/\n\u2514\u2500\u2500 charts/\n    \u2514\u2500\u2500 myapp/\n</code></pre>"},{"location":"workflows/ci-cd-circleci/#next-steps","title":"Next Steps","text":"<ul> <li>GitHub Actions Integration - GitHub Actions examples</li> <li>GitLab CI Integration - GitLab CI examples</li> <li>Jenkins Integration - Jenkins pipeline examples</li> <li>AI-Assisted DevOps - AI workflow automation</li> <li>Multi-Tool Patterns - Combining multiple tools</li> </ul>"},{"location":"workflows/ci-cd-github/","title":"GitHub Actions CI/CD Integration","text":""},{"location":"workflows/ci-cd-github/#github-actions-cicd-integration","title":"GitHub Actions CI/CD Integration","text":"<p>Complete guide to using DevOps Images in GitHub Actions workflows for automated infrastructure deployment, testing, and validation.</p> <p>Why GitHub Actions?</p> <ul> <li>Native GitHub integration</li> <li>GHCR registry optimised for Actions</li> <li>Generous free tier (2,000 minutes/month for private repos)</li> <li>Extensive marketplace of actions</li> </ul>"},{"location":"workflows/ci-cd-github/#basic-setup","title":"Basic Setup","text":""},{"location":"workflows/ci-cd-github/#simple-terraform-deployment","title":"Simple Terraform Deployment","text":"<p>Deploy infrastructure on every push to main:</p> <pre><code>name: Deploy Infrastructure\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234  # (1)!\n\n    steps:\n      - uses: actions/checkout@v4  # (2)!\n\n      - name: Configure AWS Credentials  # (3)!\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Terraform Deploy  # (4)!\n        run: |\n          terraform init\n          terraform apply -auto-approve\n</code></pre> <ol> <li>Use immutable tag for reproducible builds</li> <li>Checkout code into the container</li> <li>Configure cloud credentials using official GitHub Actions</li> <li>Run Terraform commands directly in the container</li> </ol>"},{"location":"workflows/ci-cd-github/#multi-stage-pipeline","title":"Multi-Stage Pipeline","text":""},{"location":"workflows/ci-cd-github/#validate-plan-apply","title":"Validate \u2192 Plan \u2192 Apply","text":"<p>Comprehensive workflow with validation, planning, and conditional deployment:</p> <pre><code>name: Terraform Pipeline\n\non:\n  pull_request:\n    paths:\n      - 'terraform/**'\n  push:\n    branches: [main]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Terraform Format Check\n        run: terraform fmt -check -recursive\n\n      - name: TFLint\n        run: |\n          cd terraform\n          tflint --init\n          tflint\n\n      - name: Trivy Scan\n        run: trivy config ./terraform\n\n  plan:\n    needs: validate\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure AWS Credentials\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Terraform Plan\n        run: |\n          cd terraform\n          terraform init\n          terraform plan -out=tfplan\n\n      - name: Upload Plan\n        uses: actions/upload-artifact@v4\n        with:\n          name: terraform-plan\n          path: terraform/tfplan\n\n  apply:\n    needs: plan\n    if: github.ref == 'refs/heads/main'\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    environment: production  # (1)!\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Download Plan\n        uses: actions/download-artifact@v4\n        with:\n          name: terraform-plan\n          path: terraform\n\n      - name: Configure AWS Credentials\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Terraform Apply\n        run: |\n          cd terraform\n          terraform init\n          terraform apply tfplan\n</code></pre> <ol> <li>Use GitHub Environments for approval gates and protection rules</li> </ol>"},{"location":"workflows/ci-cd-github/#multi-cloud-deployment","title":"Multi-Cloud Deployment","text":""},{"location":"workflows/ci-cd-github/#deploy-to-both-aws-and-gcp","title":"Deploy to Both AWS and GCP","text":"<pre><code>name: Multi-Cloud Deploy\n\non:\n  workflow_dispatch:  # (1)!\n    inputs:\n      environment:\n        description: 'Target environment'\n        required: true\n        type: choice\n        options:\n          - dev\n          - staging\n          - production\n\njobs:\n  deploy-aws:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure AWS\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Deploy AWS Infrastructure\n        run: |\n          cd terraform/aws/${{ inputs.environment }}\n          terraform init\n          terraform apply -auto-approve\n\n  deploy-gcp:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure GCP\n        uses: google-github-actions/auth@v2\n        with:\n          credentials_json: ${{ secrets.GCP_SA_KEY }}\n\n      - name: Deploy GCP Infrastructure\n        run: |\n          cd terraform/gcp/${{ inputs.environment }}\n          terraform init\n          terraform apply -auto-approve\n</code></pre> <ol> <li>Manual trigger with environment selection</li> </ol>"},{"location":"workflows/ci-cd-github/#matrix-builds","title":"Matrix Builds","text":""},{"location":"workflows/ci-cd-github/#deploy-to-multiple-environments","title":"Deploy to Multiple Environments","text":"<p>Deploy the same code to dev, staging, and production in parallel:</p> <pre><code>name: Multi-Environment Deploy\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        environment: [dev, staging, production]\n        cloud: [aws, gcp]\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure Credentials\n        run: |\n          # Configure based on matrix.cloud\n          if [ \"${{ matrix.cloud }}\" == \"aws\" ]; then\n            echo \"Configuring AWS...\"\n          else\n            echo \"Configuring GCP...\"\n          fi\n\n      - name: Deploy\n        run: |\n          cd terraform/${{ matrix.cloud }}/${{ matrix.environment }}\n          terraform init\n          terraform apply -auto-approve\n</code></pre>"},{"location":"workflows/ci-cd-github/#security-scanning-workflow","title":"Security Scanning Workflow","text":""},{"location":"workflows/ci-cd-github/#comprehensive-security-checks","title":"Comprehensive Security Checks","text":"<pre><code>name: Security Scan\n\non:\n  pull_request:\n  schedule:\n    - cron: '0 0 * * 0'  # Weekly on Sundays\n\njobs:\n  security-scan:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Trivy IaC Scan\n        run: |\n          trivy config ./terraform \\\n            --severity HIGH,CRITICAL \\\n            --exit-code 1\n\n      - name: TFLint\n        run: |\n          cd terraform\n          tflint --init\n          tflint --minimum-failure-severity=error\n\n      - name: CloudFormation Lint\n        if: hashFiles('cloudformation/**/*.yaml') != ''\n        run: |\n          cfn-lint cloudformation/**/*.yaml\n\n      - name: Ansible Lint\n        if: hashFiles('ansible/**/*.yml') != ''\n        run: |\n          ansible-lint ansible/\n\n      - name: Container Image Scan\n        if: hashFiles('**/Dockerfile') != ''\n        run: |\n          trivy image --severity HIGH,CRITICAL my-app:latest\n</code></pre>"},{"location":"workflows/ci-cd-github/#kubernetes-deployment","title":"Kubernetes Deployment","text":""},{"location":"workflows/ci-cd-github/#deploy-to-eksgke-with-helm","title":"Deploy to EKS/GKE with Helm","text":"<pre><code>name: Deploy to Kubernetes\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy-eks:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure AWS\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Update kubeconfig\n        run: |\n          aws eks update-kubeconfig \\\n            --region us-east-1 \\\n            --name my-eks-cluster\n\n      - name: Deploy with Helm\n        run: |\n          helm upgrade --install myapp ./charts/myapp \\\n            --namespace production \\\n            --create-namespace \\\n            --wait \\\n            --timeout 5m\n\n      - name: Verify Deployment\n        run: |\n          kubectl rollout status deployment/myapp -n production\n          kubectl get pods -n production\n</code></pre>"},{"location":"workflows/ci-cd-github/#caching-strategies","title":"Caching Strategies","text":""},{"location":"workflows/ci-cd-github/#speed-up-pipeline-with-caching","title":"Speed Up Pipeline with Caching","text":"<pre><code>name: Optimized Pipeline\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Cache Terraform Plugins\n        uses: actions/cache@v4\n        with:\n          path: |\n            ~/.terraform.d/plugin-cache\n          key: terraform-${{ hashFiles('**/.terraform.lock.hcl') }}\n\n      - name: Configure Terraform Plugin Cache\n        run: |\n          mkdir -p ~/.terraform.d/plugin-cache\n          cat &gt; ~/.terraformrc &lt;&lt;EOF\n          plugin_cache_dir = \"$HOME/.terraform.d/plugin-cache\"\n          EOF\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Terraform Apply\n        run: terraform apply -auto-approve\n</code></pre>"},{"location":"workflows/ci-cd-github/#ai-assisted-code-review","title":"AI-Assisted Code Review","text":""},{"location":"workflows/ci-cd-github/#automated-review-with-claude-cli","title":"Automated Review with Claude CLI","text":"<pre><code>name: AI Code Review\n\non:\n  pull_request:\n    paths:\n      - 'terraform/**'\n      - 'ansible/**'\n\njobs:\n  ai-review:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Setup Claude CLI\n        run: |\n          echo \"${{ secrets.CLAUDE_API_KEY }}\" &gt; ~/.claude/config.json\n\n      - name: Review Terraform Changes\n        run: |\n          git diff origin/main...HEAD -- terraform/ &gt; changes.diff\n          claude \"Review this Terraform code for security issues and best practices\" \\\n            --file changes.diff \\\n            &gt; review-output.md\n\n      - name: Post Review Comment\n        uses: actions/github-script@v7\n        with:\n          script: |\n            const fs = require('fs');\n            const review = fs.readFileSync('review-output.md', 'utf8');\n            github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: `## \ud83e\udd16 AI Code Review\\n\\n${review}`\n            });\n</code></pre>"},{"location":"workflows/ci-cd-github/#reusable-workflows","title":"Reusable Workflows","text":""},{"location":"workflows/ci-cd-github/#create-reusable-workflow","title":"Create Reusable Workflow","text":"<p><code>.github/workflows/terraform-deploy.yml</code>:</p> <pre><code>name: Reusable Terraform Deploy\n\non:\n  workflow_call:\n    inputs:\n      environment:\n        required: true\n        type: string\n      terraform_dir:\n        required: true\n        type: string\n    secrets:\n      AWS_ACCESS_KEY_ID:\n        required: true\n      AWS_SECRET_ACCESS_KEY:\n        required: true\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n    environment: ${{ inputs.environment }}\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure AWS\n        uses: aws-actions/configure-aws-credentials@v4\n        with:\n          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws-region: us-east-1\n\n      - name: Terraform Deploy\n        run: |\n          cd ${{ inputs.terraform_dir }}\n          terraform init\n          terraform apply -auto-approve\n</code></pre> <p>Use the reusable workflow:</p> <pre><code>name: Deploy All Environments\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy-dev:\n    uses: ./.github/workflows/terraform-deploy.yml\n    with:\n      environment: dev\n      terraform_dir: terraform/dev\n    secrets: inherit\n\n  deploy-staging:\n    needs: deploy-dev\n    uses: ./.github/workflows/terraform-deploy.yml\n    with:\n      environment: staging\n      terraform_dir: terraform/staging\n    secrets: inherit\n\n  deploy-prod:\n    needs: deploy-staging\n    uses: ./.github/workflows/terraform-deploy.yml\n    with:\n      environment: production\n      terraform_dir: terraform/production\n    secrets: inherit\n</code></pre>"},{"location":"workflows/ci-cd-github/#best-practices","title":"Best Practices","text":"<p>Performance Optimisation</p> <ol> <li>Pin image versions: Use immutable tags like <code>1.0.abc1234</code></li> <li>Cache layers: GitHub automatically caches container layers</li> <li>Use GHCR: Fastest registry for GitHub Actions</li> <li>Cache Terraform plugins: Use <code>actions/cache</code> for <code>.terraform</code> directory</li> <li>Parallel jobs: Run independent steps in parallel</li> </ol> <p>Security Best Practices</p> <ol> <li>Use GitHub Secrets: Store credentials in repository or organization secrets</li> <li>Use Environments: Add approval gates for production deployments</li> <li>Limit permissions: Use <code>permissions:</code> to grant minimal access</li> <li>Scan before deploy: Run Trivy/TFLint in validation job</li> <li>Use OIDC: Consider AWS/GCP OIDC instead of static credentials</li> </ol> <p>Common Pitfalls</p> <ul> <li>\u274c Using <code>latest</code> tag: Leads to non-reproducible builds</li> <li>\u274c Hardcoding credentials: Always use GitHub Secrets</li> <li>\u274c No approval gates: Use Environments for production</li> <li>\u274c Ignoring scan results: Make security checks blocking</li> </ul>"},{"location":"workflows/ci-cd-github/#troubleshooting","title":"Troubleshooting","text":"Container fails to start <p>Problem: GitHub Actions can't pull or run the container</p> <p>Solutions: </p><pre><code># 1. Verify image name and tag\ncontainer:\n  image: ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234\n\n# 2. For private images, authenticate\ncontainer:\n  image: ghcr.io/private/image:latest\n  credentials:\n    username: ${{ github.actor }}\n    password: ${{ secrets.GITHUB_TOKEN }}\n</code></pre><p></p> Terraform state locking issues <p>Problem: Multiple jobs try to access Terraform state simultaneously</p> <p>Solution: Use job dependencies or concurrency groups </p><pre><code>concurrency:\n  group: terraform-${{ github.ref }}\n  cancel-in-progress: false\n</code></pre><p></p> AWS credentials not working <p>Problem: AWS CLI can't find credentials in container</p> <p>Solution: Ensure <code>aws-actions/configure-aws-credentials</code> runs before AWS commands </p><pre><code>- name: Configure AWS Credentials\n  uses: aws-actions/configure-aws-credentials@v4\n  with:\n    aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n    aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n    aws-region: us-east-1\n</code></pre><p></p>"},{"location":"workflows/ci-cd-github/#example-repository-structure","title":"Example Repository Structure","text":"<pre><code>.\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u251c\u2500\u2500 terraform-pipeline.yml\n\u2502       \u251c\u2500\u2500 security-scan.yml\n\u2502       \u251c\u2500\u2500 k8s-deploy.yml\n\u2502       \u2514\u2500\u2500 reusable/\n\u2502           \u2514\u2500\u2500 terraform-deploy.yml\n\u251c\u2500\u2500 terraform/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u251c\u2500\u2500 staging/\n\u2502   \u2514\u2500\u2500 production/\n\u251c\u2500\u2500 ansible/\n\u2502   \u2514\u2500\u2500 playbooks/\n\u2514\u2500\u2500 charts/\n    \u2514\u2500\u2500 myapp/\n</code></pre>"},{"location":"workflows/ci-cd-github/#next-steps","title":"Next Steps","text":"<ul> <li>GitLab CI Integration - GitLab CI examples</li> <li>Jenkins Integration - Jenkins pipeline examples</li> <li>CircleCI Integration - CircleCI config examples</li> <li>AI-Assisted DevOps - AI workflow automation</li> <li>Multi-Tool Patterns - Combining multiple tools</li> </ul>"},{"location":"workflows/ci-cd-gitlab/","title":"GitLab CI/CD Integration","text":""},{"location":"workflows/ci-cd-gitlab/#gitlab-cicd-integration","title":"GitLab CI/CD Integration","text":"<p>Complete guide to using DevOps Images in GitLab CI pipelines for automated infrastructure deployment, testing, and validation.</p> <p>Why GitLab CI?</p> <ul> <li>Native GitLab integration</li> <li>GitLab Container Registry optimised for CI</li> <li>Generous free tier (400 minutes/month for free tier)</li> <li>Built-in security scanning and compliance features</li> </ul>"},{"location":"workflows/ci-cd-gitlab/#basic-setup","title":"Basic Setup","text":""},{"location":"workflows/ci-cd-gitlab/#simple-terraform-deployment","title":"Simple Terraform Deployment","text":"<p>Deploy infrastructure on every push to main:</p> <pre><code>stages:\n  - deploy\n\ndeploy:production:\n  stage: deploy\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234  # (1)!\n  script:\n    - terraform init\n    - terraform apply -auto-approve\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID  # (2)!\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    AWS_DEFAULT_REGION: us-east-1\n  only:\n    - main  # (3)!\n</code></pre> <ol> <li>Use GitLab Container Registry for faster pulls in GitLab CI</li> <li>Use GitLab CI/CD variables (Settings \u2192 CI/CD \u2192 Variables)</li> <li>Only run on main branch</li> </ol>"},{"location":"workflows/ci-cd-gitlab/#multi-stage-pipeline","title":"Multi-Stage Pipeline","text":""},{"location":"workflows/ci-cd-gitlab/#validate-plan-apply","title":"Validate \u2192 Plan \u2192 Apply","text":"<p>Comprehensive pipeline with validation, planning, and conditional deployment:</p> <pre><code>stages:\n  - validate\n  - plan\n  - apply\n\nvariables:\n  TF_ROOT: ${CI_PROJECT_DIR}/terraform  # (1)!\n  TF_STATE_NAME: default\n\ncache:  # (2)!\n  paths:\n    - ${TF_ROOT}/.terraform\n\n# Validate Stage\nterraform:validate:\n  stage: validate\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cd ${TF_ROOT}\n    - terraform fmt -check -recursive\n    - terraform init -backend=false\n    - terraform validate\n\ntflint:\n  stage: validate\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cd ${TF_ROOT}\n    - tflint --init\n    - tflint\n\ntrivy:scan:\n  stage: validate\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - trivy config ${TF_ROOT} --exit-code 1 --severity HIGH,CRITICAL\n  allow_failure: true  # (3)!\n\n# Plan Stage\nterraform:plan:\n  stage: plan\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cd ${TF_ROOT}\n    - terraform init\n    - terraform plan -out=tfplan\n  artifacts:  # (4)!\n    paths:\n      - ${TF_ROOT}/tfplan\n    expire_in: 1 day\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    AWS_DEFAULT_REGION: us-east-1\n  only:\n    - merge_requests\n    - main\n\n# Apply Stage\nterraform:apply:\n  stage: apply\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cd ${TF_ROOT}\n    - terraform init\n    - terraform apply tfplan\n  dependencies:\n    - terraform:plan\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    AWS_DEFAULT_REGION: us-east-1\n  environment:  # (5)!\n    name: production\n    action: start\n  when: manual  # (6)!\n  only:\n    - main\n</code></pre> <ol> <li>Define common variables for reuse</li> <li>Cache Terraform plugins for faster builds</li> <li>Allow vulnerability scans to fail without blocking pipeline</li> <li>Save plan as artifact for apply stage</li> <li>Track deployments in GitLab Environments</li> <li>Require manual approval for production deployments</li> </ol>"},{"location":"workflows/ci-cd-gitlab/#multi-cloud-deployment","title":"Multi-Cloud Deployment","text":""},{"location":"workflows/ci-cd-gitlab/#deploy-to-both-aws-and-gcp","title":"Deploy to Both AWS and GCP","text":"<pre><code>stages:\n  - deploy-aws\n  - deploy-gcp\n\ndeploy:aws:\n  stage: deploy-aws\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cd terraform/aws\n    - terraform init\n    - terraform apply -auto-approve\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    AWS_DEFAULT_REGION: us-east-1\n  environment:\n    name: aws-production\n  only:\n    - main\n\ndeploy:gcp:\n  stage: deploy-gcp\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  before_script:\n    - echo $GCP_SA_KEY | base64 -d &gt; /tmp/gcp-key.json  # (1)!\n    - export GOOGLE_APPLICATION_CREDENTIALS=/tmp/gcp-key.json\n  script:\n    - cd terraform/gcp\n    - terraform init\n    - terraform apply -auto-approve\n  after_script:\n    - rm -f /tmp/gcp-key.json  # (2)!\n  environment:\n    name: gcp-production\n  only:\n    - main\n</code></pre> <ol> <li>Decode base64-encoded service account key from GitLab variable</li> <li>Clean up sensitive files after deployment</li> </ol>"},{"location":"workflows/ci-cd-gitlab/#parallel-matrix-builds","title":"Parallel Matrix Builds","text":""},{"location":"workflows/ci-cd-gitlab/#deploy-to-multiple-environments","title":"Deploy to Multiple Environments","text":"<pre><code>stages:\n  - deploy\n\n.deploy_template: &amp;deploy_template  # (1)!\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cd terraform/${CLOUD}/${ENVIRONMENT}\n    - terraform init\n    - terraform apply -auto-approve\n  only:\n    - main\n\ndeploy:aws-dev:\n  &lt;&lt;: *deploy_template\n  variables:\n    CLOUD: aws\n    ENVIRONMENT: dev\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n  environment:\n    name: aws-dev\n\ndeploy:aws-staging:\n  &lt;&lt;: *deploy_template\n  variables:\n    CLOUD: aws\n    ENVIRONMENT: staging\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n  environment:\n    name: aws-staging\n\ndeploy:gcp-dev:\n  &lt;&lt;: *deploy_template\n  before_script:\n    - echo $GCP_SA_KEY | base64 -d &gt; /tmp/gcp-key.json\n    - export GOOGLE_APPLICATION_CREDENTIALS=/tmp/gcp-key.json\n  variables:\n    CLOUD: gcp\n    ENVIRONMENT: dev\n  environment:\n    name: gcp-dev\n</code></pre> <ol> <li>Use YAML anchors to avoid repetition</li> </ol>"},{"location":"workflows/ci-cd-gitlab/#security-scanning-pipeline","title":"Security Scanning Pipeline","text":""},{"location":"workflows/ci-cd-gitlab/#comprehensive-security-checks","title":"Comprehensive Security Checks","text":"<pre><code>stages:\n  - security\n\nsecurity:trivy:\n  stage: security\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - trivy config ./terraform --format json --output trivy-report.json\n    - trivy config ./terraform --severity HIGH,CRITICAL\n  artifacts:\n    reports:\n      container_scanning: trivy-report.json  # (1)!\n    paths:\n      - trivy-report.json\n    expire_in: 30 days\n\nsecurity:tflint:\n  stage: security\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cd terraform\n    - tflint --init\n    - tflint --format junit &gt; tflint-report.xml\n  artifacts:\n    reports:\n      junit: terraform/tflint-report.xml\n\nsecurity:cfn-lint:\n  stage: security\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - cfn-lint cloudformation/**/*.yaml\n  only:\n    changes:\n      - cloudformation/**/*.yaml\n\nsecurity:ansible-lint:\n  stage: security\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - ansible-lint ansible/\n  only:\n    changes:\n      - ansible/**/*.yml\n</code></pre> <ol> <li>GitLab displays security reports in merge requests</li> </ol>"},{"location":"workflows/ci-cd-gitlab/#kubernetes-deployment","title":"Kubernetes Deployment","text":""},{"location":"workflows/ci-cd-gitlab/#deploy-to-eksgke-with-helm","title":"Deploy to EKS/GKE with Helm","text":"<pre><code>stages:\n  - deploy\n\ndeploy:eks:\n  stage: deploy\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    # Configure kubectl\n    - aws eks update-kubeconfig --region us-east-1 --name my-eks-cluster\n\n    # Deploy with Helm\n    - |\n      helm upgrade --install myapp ./charts/myapp \\\n        --namespace production \\\n        --create-namespace \\\n        --set image.tag=${CI_COMMIT_SHORT_SHA} \\\n        --wait \\\n        --timeout 5m\n\n    # Verify deployment\n    - kubectl rollout status deployment/myapp -n production\n    - kubectl get pods -n production\n  variables:\n    AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID\n    AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY\n    AWS_DEFAULT_REGION: us-east-1\n  environment:\n    name: eks-production\n    kubernetes:  # (1)!\n      namespace: production\n  only:\n    - main\n</code></pre> <ol> <li>GitLab tracks Kubernetes deployments in the environment page</li> </ol>"},{"location":"workflows/ci-cd-gitlab/#child-pipelines","title":"Child Pipelines","text":""},{"location":"workflows/ci-cd-gitlab/#modular-pipeline-architecture","title":"Modular Pipeline Architecture","text":"<p>Main <code>.gitlab-ci.yml</code>:</p> <pre><code>stages:\n  - trigger\n\ntrigger:terraform:\n  stage: trigger\n  trigger:\n    include: .gitlab/ci/terraform-pipeline.yml\n    strategy: depend  # (1)!\n  only:\n    changes:\n      - terraform/**\n\ntrigger:ansible:\n  stage: trigger\n  trigger:\n    include: .gitlab/ci/ansible-pipeline.yml\n    strategy: depend\n  only:\n    changes:\n      - ansible/**\n</code></pre> <ol> <li>Wait for child pipeline to complete before continuing</li> </ol> <p><code>.gitlab/ci/terraform-pipeline.yml</code>:</p> <pre><code>stages:\n  - validate\n  - deploy\n\nvalidate:\n  stage: validate\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - terraform fmt -check\n    - terraform validate\n\ndeploy:\n  stage: deploy\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  script:\n    - terraform init\n    - terraform apply -auto-approve\n  when: manual\n</code></pre>"},{"location":"workflows/ci-cd-gitlab/#ai-assisted-code-review","title":"AI-Assisted Code Review","text":""},{"location":"workflows/ci-cd-gitlab/#automated-review-with-claude-cli","title":"Automated Review with Claude CLI","text":"<pre><code>stages:\n  - review\n\nai:review:\n  stage: review\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n  before_script:\n    - mkdir -p ~/.claude\n    - echo \"$CLAUDE_API_KEY\" &gt; ~/.claude/config.json\n  script:\n    # Get diff from merge request\n    - git diff origin/${CI_MERGE_REQUEST_TARGET_BRANCH_NAME}...HEAD -- terraform/ &gt; changes.diff\n\n    # Review with Claude\n    - |\n      claude \"Review this Terraform code for security issues and best practices\" \\\n        --file changes.diff \\\n        &gt; review-output.md\n\n    # Post comment to MR\n    - |\n      curl --request POST \\\n        --header \"PRIVATE-TOKEN: ${CI_JOB_TOKEN}\" \\\n        --data \"body=$(cat review-output.md)\" \\\n        \"${CI_API_V4_URL}/projects/${CI_PROJECT_ID}/merge_requests/${CI_MERGE_REQUEST_IID}/notes\"\n  only:\n    - merge_requests\n</code></pre>"},{"location":"workflows/ci-cd-gitlab/#gitlab-autodevops-integration","title":"GitLab AutoDevOps Integration","text":""},{"location":"workflows/ci-cd-gitlab/#extend-autodevops-with-custom-tools","title":"Extend AutoDevOps with Custom Tools","text":"<pre><code>include:\n  - template: Auto-DevOps.gitlab-ci.yml\n\nvariables:\n  AUTO_DEVOPS_IMAGE: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n\n# Override default test job\ntest:\n  extends: .auto-devops\n  image: $AUTO_DEVOPS_IMAGE\n  script:\n    - terraform validate\n    - trivy config .\n    - tflint\n\n# Add custom infrastructure deployment\ndeploy:infrastructure:\n  stage: deploy\n  image: $AUTO_DEVOPS_IMAGE\n  script:\n    - terraform init\n    - terraform apply -auto-approve\n  environment:\n    name: production\n  when: manual\n  only:\n    - main\n</code></pre>"},{"location":"workflows/ci-cd-gitlab/#best-practices","title":"Best Practices","text":"<p>Performance Optimisation</p> <ol> <li>Use GitLab Container Registry: Faster pulls in GitLab CI</li> <li>Cache Terraform plugins: Use <code>cache:</code> directive</li> <li>Pin image versions: Use immutable tags</li> <li>Parallel jobs: Use <code>parallel:</code> keyword for matrix builds</li> <li>Optimise artifacts: Only save necessary files</li> </ol> <p>Security Best Practices</p> <ol> <li>Use CI/CD Variables: Store secrets in project/group variables</li> <li>Protected variables: Mark sensitive variables as protected</li> <li>Masked variables: Hide secret values in job logs</li> <li>Use environments: Add approval gates for production</li> <li>SAST scanning: Enable GitLab SAST for security scanning</li> </ol> <p>Common Pitfalls</p> <ul> <li>\u274c Using <code>latest</code> tag: Non-reproducible builds</li> <li>\u274c Hardcoding secrets: Always use CI/CD variables</li> <li>\u274c No manual gates: Use <code>when: manual</code> for production</li> <li>\u274c Ignoring cache: Slow builds without caching</li> </ul>"},{"location":"workflows/ci-cd-gitlab/#gitlab-specific-features","title":"GitLab-Specific Features","text":""},{"location":"workflows/ci-cd-gitlab/#container-scanning","title":"Container Scanning","text":"<pre><code>include:\n  - template: Security/Container-Scanning.gitlab-ci.yml\n\ncontainer_scanning:\n  variables:\n    CS_IMAGE: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n</code></pre>"},{"location":"workflows/ci-cd-gitlab/#dependency-scanning","title":"Dependency Scanning","text":"<pre><code>include:\n  - template: Security/Dependency-Scanning.gitlab-ci.yml\n\ndependency_scanning:\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n</code></pre>"},{"location":"workflows/ci-cd-gitlab/#sast-static-application-security-testing","title":"SAST (Static Application Security Testing)","text":"<pre><code>include:\n  - template: Security/SAST.gitlab-ci.yml\n\nsast:\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n</code></pre>"},{"location":"workflows/ci-cd-gitlab/#troubleshooting","title":"Troubleshooting","text":"Image pull fails <p>Problem: GitLab CI can't pull the container image</p> <p>Solutions: </p><pre><code># 1. Verify image path for GitLab registry\nimage: registry.gitlab.com/jinal-shah/devops/images/all-devops:1.0.abc1234\n\n# 2. For private images, ensure CI_JOB_TOKEN has access\nbefore_script:\n  - docker login -u $CI_REGISTRY_USER -p $CI_JOB_TOKEN $CI_REGISTRY\n</code></pre><p></p> Terraform state locking conflicts <p>Problem: Multiple jobs access Terraform state simultaneously</p> <p>Solution: Use <code>resource_group</code> to serialize jobs </p><pre><code>terraform:apply:\n  resource_group: terraform-state\n  script:\n    - terraform apply -auto-approve\n</code></pre><p></p> Variables not available <p>Problem: CI/CD variables not accessible in job</p> <p>Solutions: 1. Verify variable is not marked as \"protected\" if running on non-protected branch 2. Check variable scope (project vs. group vs. instance) 3. Ensure variable key name matches exactly (case-sensitive)</p>"},{"location":"workflows/ci-cd-gitlab/#example-repository-structure","title":"Example Repository Structure","text":"<pre><code>.\n\u251c\u2500\u2500 .gitlab-ci.yml\n\u251c\u2500\u2500 .gitlab/\n\u2502   \u2514\u2500\u2500 ci/\n\u2502       \u251c\u2500\u2500 terraform-pipeline.yml\n\u2502       \u251c\u2500\u2500 ansible-pipeline.yml\n\u2502       \u2514\u2500\u2500 k8s-pipeline.yml\n\u251c\u2500\u2500 terraform/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u251c\u2500\u2500 staging/\n\u2502   \u2514\u2500\u2500 production/\n\u251c\u2500\u2500 ansible/\n\u2502   \u2514\u2500\u2500 playbooks/\n\u2514\u2500\u2500 charts/\n    \u2514\u2500\u2500 myapp/\n</code></pre>"},{"location":"workflows/ci-cd-gitlab/#next-steps","title":"Next Steps","text":"<ul> <li>GitHub Actions Integration - GitHub Actions examples</li> <li>Jenkins Integration - Jenkins pipeline examples</li> <li>CircleCI Integration - CircleCI config examples</li> <li>AI-Assisted DevOps - AI workflow automation</li> <li>Multi-Tool Patterns - Combining multiple tools</li> </ul>"},{"location":"workflows/ci-cd-jenkins/","title":"Jenkins CI/CD Integration","text":""},{"location":"workflows/ci-cd-jenkins/#jenkins-cicd-integration","title":"Jenkins CI/CD Integration","text":"<p>Complete guide to using DevOps Images in Jenkins pipelines for automated infrastructure deployment, testing, and validation.</p> <p>Why Jenkins?</p> <ul> <li>Self-hosted control and customisation</li> <li>Extensive plugin ecosystem</li> <li>Docker pipeline support</li> <li>Works with any container registry</li> </ul>"},{"location":"workflows/ci-cd-jenkins/#basic-setup","title":"Basic Setup","text":""},{"location":"workflows/ci-cd-jenkins/#prerequisites","title":"Prerequisites","text":"<p>Ensure Jenkins has Docker pipeline plugin installed:</p> <ul> <li>Docker Pipeline Plugin</li> <li>Docker Plugin</li> <li>Kubernetes Plugin (optional, for Kubernetes agents)</li> </ul>"},{"location":"workflows/ci-cd-jenkins/#declarative-pipeline","title":"Declarative Pipeline","text":""},{"location":"workflows/ci-cd-jenkins/#simple-terraform-deployment","title":"Simple Terraform Deployment","text":"<pre><code>pipeline {\n    agent {\n        docker {\n            image 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'  // (1)!\n            args '-v $HOME/.aws:/root/.aws'  // (2)!\n        }\n    }\n\n    environment {  // (3)!\n        AWS_REGION = 'us-east-1'\n    }\n\n    stages {\n        stage('Terraform Init') {\n            steps {\n                sh 'terraform init'\n            }\n        }\n\n        stage('Terraform Plan') {\n            steps {\n                sh 'terraform plan -out=tfplan'\n            }\n        }\n\n        stage('Terraform Apply') {\n            when {\n                branch 'main'  // (4)!\n            }\n            steps {\n                input message: 'Deploy to production?', ok: 'Deploy'  // (5)!\n                sh 'terraform apply tfplan'\n            }\n        }\n    }\n\n    post {  // (6)!\n        always {\n            cleanWs()\n        }\n        success {\n            echo 'Deployment successful!'\n        }\n        failure {\n            echo 'Deployment failed!'\n        }\n    }\n}\n</code></pre> <ol> <li>Use DevOps Image as agent container</li> <li>Mount AWS credentials from Jenkins host</li> <li>Define environment variables</li> <li>Only deploy from main branch</li> <li>Manual approval gate</li> <li>Post-build actions</li> </ol>"},{"location":"workflows/ci-cd-jenkins/#multi-stage-pipeline","title":"Multi-Stage Pipeline","text":""},{"location":"workflows/ci-cd-jenkins/#validate-plan-apply","title":"Validate \u2192 Plan \u2192 Apply","text":"<pre><code>pipeline {\n    agent {\n        docker {\n            image 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'\n        }\n    }\n\n    parameters {  // (1)!\n        choice(\n            name: 'ENVIRONMENT',\n            choices: ['dev', 'staging', 'production'],\n            description: 'Target environment'\n        )\n        booleanParam(\n            name: 'AUTO_APPROVE',\n            defaultValue: false,\n            description: 'Auto-approve Terraform apply'\n        )\n    }\n\n    environment {\n        TF_DIR = \"${WORKSPACE}/terraform/${params.ENVIRONMENT}\"\n        AWS_CREDENTIALS = credentials('aws-credentials')  // (2)!\n    }\n\n    stages {\n        stage('Validate') {\n            parallel {  // (3)!\n                stage('Terraform Format') {\n                    steps {\n                        dir(\"${TF_DIR}\") {\n                            sh 'terraform fmt -check -recursive'\n                        }\n                    }\n                }\n                stage('TFLint') {\n                    steps {\n                        dir(\"${TF_DIR}\") {\n                            sh 'tflint --init'\n                            sh 'tflint'\n                        }\n                    }\n                }\n                stage('Trivy Scan') {\n                    steps {\n                        sh 'trivy config ${TF_DIR} --severity HIGH,CRITICAL'\n                    }\n                }\n            }\n        }\n\n        stage('Terraform Plan') {\n            steps {\n                dir(\"${TF_DIR}\") {\n                    sh 'terraform init'\n                    sh 'terraform plan -out=tfplan'\n                }\n            }\n        }\n\n        stage('Approval') {\n            when {\n                expression { !params.AUTO_APPROVE }\n            }\n            steps {\n                input message: \"Deploy to ${params.ENVIRONMENT}?\", ok: 'Deploy'\n            }\n        }\n\n        stage('Terraform Apply') {\n            steps {\n                dir(\"${TF_DIR}\") {\n                    sh 'terraform apply tfplan'\n                }\n            }\n        }\n    }\n\n    post {\n        always {\n            archiveArtifacts artifacts: '**/tfplan', allowEmptyArchive: true\n            cleanWs()\n        }\n        success {\n            emailext (\n                subject: \"SUCCESS: Terraform deployment to ${params.ENVIRONMENT}\",\n                body: \"Terraform deployment completed successfully.\",\n                to: '$DEFAULT_RECIPIENTS'\n            )\n        }\n        failure {\n            emailext (\n                subject: \"FAILED: Terraform deployment to ${params.ENVIRONMENT}\",\n                body: \"Terraform deployment failed. Check console output.\",\n                to: '$DEFAULT_RECIPIENTS'\n            )\n        }\n    }\n}\n</code></pre> <ol> <li>Pipeline parameters for user input</li> <li>Jenkins credentials binding</li> <li>Run validation stages in parallel</li> </ol>"},{"location":"workflows/ci-cd-jenkins/#scripted-pipeline","title":"Scripted Pipeline","text":""},{"location":"workflows/ci-cd-jenkins/#advanced-multi-cloud-deployment","title":"Advanced Multi-Cloud Deployment","text":"<pre><code>node {\n    def dockerImage = 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'\n\n    stage('Checkout') {\n        checkout scm\n    }\n\n    docker.image(dockerImage).inside('-v $HOME/.aws:/root/.aws -v $HOME/.config/gcloud:/root/.config/gcloud') {\n        try {\n            stage('AWS Deployment') {\n                withCredentials([\n                    string(credentialsId: 'aws-access-key', variable: 'AWS_ACCESS_KEY_ID'),\n                    string(credentialsId: 'aws-secret-key', variable: 'AWS_SECRET_ACCESS_KEY')\n                ]) {\n                    dir('terraform/aws') {\n                        sh 'terraform init'\n                        sh 'terraform plan -out=aws-tfplan'\n                        sh 'terraform apply aws-tfplan'\n                    }\n                }\n            }\n\n            stage('GCP Deployment') {\n                withCredentials([file(credentialsId: 'gcp-sa-key', variable: 'GCP_KEY_FILE')]) {\n                    sh 'export GOOGLE_APPLICATION_CREDENTIALS=${GCP_KEY_FILE}'\n                    dir('terraform/gcp') {\n                        sh 'terraform init'\n                        sh 'terraform plan -out=gcp-tfplan'\n                        sh 'terraform apply gcp-tfplan'\n                    }\n                }\n            }\n\n        } catch (Exception e) {\n            currentBuild.result = 'FAILURE'\n            throw e\n        } finally {\n            cleanWs()\n        }\n    }\n}\n</code></pre>"},{"location":"workflows/ci-cd-jenkins/#shared-library-integration","title":"Shared Library Integration","text":""},{"location":"workflows/ci-cd-jenkins/#reusable-pipeline-functions","title":"Reusable Pipeline Functions","text":"<p><code>vars/terraformDeploy.groovy</code>:</p> <pre><code>def call(Map config) {\n    pipeline {\n        agent {\n            docker {\n                image config.image ?: 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'\n            }\n        }\n\n        stages {\n            stage('Terraform Deploy') {\n                steps {\n                    script {\n                        withCredentials([\n                            string(credentialsId: config.awsKeyId, variable: 'AWS_ACCESS_KEY_ID'),\n                            string(credentialsId: config.awsSecretKey, variable: 'AWS_SECRET_ACCESS_KEY')\n                        ]) {\n                            dir(config.terraformDir) {\n                                sh 'terraform init'\n                                sh \"terraform plan -out=tfplan\"\n                                if (config.autoApprove) {\n                                    sh 'terraform apply tfplan'\n                                } else {\n                                    input message: 'Deploy?', ok: 'Deploy'\n                                    sh 'terraform apply tfplan'\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Using the shared library:</p> <pre><code>@Library('devops-pipeline') _\n\nterraformDeploy(\n    terraformDir: 'terraform/production',\n    awsKeyId: 'aws-access-key',\n    awsSecretKey: 'aws-secret-key',\n    autoApprove: false\n)\n</code></pre>"},{"location":"workflows/ci-cd-jenkins/#kubernetes-deployment","title":"Kubernetes Deployment","text":""},{"location":"workflows/ci-cd-jenkins/#deploy-to-eksgke-with-helm","title":"Deploy to EKS/GKE with Helm","text":"<pre><code>pipeline {\n    agent {\n        docker {\n            image 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'\n            args '-v $HOME/.kube:/root/.kube'\n        }\n    }\n\n    environment {\n        AWS_REGION = 'us-east-1'\n        CLUSTER_NAME = 'my-eks-cluster'\n        NAMESPACE = 'production'\n    }\n\n    stages {\n        stage('Configure kubectl') {\n            steps {\n                withAWS(credentials: 'aws-credentials', region: env.AWS_REGION) {\n                    sh \"\"\"\n                        aws eks update-kubeconfig \\\n                            --region ${AWS_REGION} \\\n                            --name ${CLUSTER_NAME}\n                    \"\"\"\n                }\n            }\n        }\n\n        stage('Deploy with Helm') {\n            steps {\n                sh \"\"\"\n                    helm upgrade --install myapp ./charts/myapp \\\n                        --namespace ${NAMESPACE} \\\n                        --create-namespace \\\n                        --set image.tag=${env.BUILD_NUMBER} \\\n                        --wait \\\n                        --timeout 5m\n                \"\"\"\n            }\n        }\n\n        stage('Verify Deployment') {\n            steps {\n                sh \"kubectl rollout status deployment/myapp -n ${NAMESPACE}\"\n                sh \"kubectl get pods -n ${NAMESPACE}\"\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"workflows/ci-cd-jenkins/#security-scanning-pipeline","title":"Security Scanning Pipeline","text":""},{"location":"workflows/ci-cd-jenkins/#comprehensive-security-checks","title":"Comprehensive Security Checks","text":"<pre><code>pipeline {\n    agent {\n        docker {\n            image 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'\n        }\n    }\n\n    stages {\n        stage('Security Scans') {\n            parallel {\n                stage('Trivy IaC Scan') {\n                    steps {\n                        sh '''\n                            trivy config ./terraform \\\n                                --format json \\\n                                --output trivy-report.json\n                            trivy config ./terraform \\\n                                --severity HIGH,CRITICAL \\\n                                --exit-code 1\n                        '''\n                    }\n                }\n\n                stage('TFLint') {\n                    steps {\n                        dir('terraform') {\n                            sh 'tflint --init'\n                            sh 'tflint --minimum-failure-severity=error'\n                        }\n                    }\n                }\n\n                stage('CloudFormation Lint') {\n                    when {\n                        expression {\n                            fileExists('cloudformation')\n                        }\n                    }\n                    steps {\n                        sh 'cfn-lint cloudformation/**/*.yaml'\n                    }\n                }\n\n                stage('Ansible Lint') {\n                    when {\n                        expression {\n                            fileExists('ansible')\n                        }\n                    }\n                    steps {\n                        sh 'ansible-lint ansible/'\n                    }\n                }\n            }\n        }\n    }\n\n    post {\n        always {\n            publishHTML([\n                reportDir: '.',\n                reportFiles: 'trivy-report.json',\n                reportName: 'Trivy Security Report'\n            ])\n        }\n    }\n}\n</code></pre>"},{"location":"workflows/ci-cd-jenkins/#multi-branch-pipeline","title":"Multi-Branch Pipeline","text":""},{"location":"workflows/ci-cd-jenkins/#automatic-branch-detection","title":"Automatic Branch Detection","text":"<p>Jenkinsfile:</p> <pre><code>pipeline {\n    agent {\n        docker {\n            image 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'\n        }\n    }\n\n    stages {\n        stage('Determine Environment') {\n            steps {\n                script {\n                    if (env.BRANCH_NAME == 'main') {\n                        env.DEPLOY_ENV = 'production'\n                    } else if (env.BRANCH_NAME == 'staging') {\n                        env.DEPLOY_ENV = 'staging'\n                    } else {\n                        env.DEPLOY_ENV = 'dev'\n                    }\n                    echo \"Deploying to: ${env.DEPLOY_ENV}\"\n                }\n            }\n        }\n\n        stage('Deploy') {\n            steps {\n                dir(\"terraform/${env.DEPLOY_ENV}\") {\n                    sh 'terraform init'\n                    sh 'terraform apply -auto-approve'\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Jenkins Configuration:</p> <ol> <li>Create a Multibranch Pipeline job</li> <li>Configure branch sources (Git)</li> <li>Set scan triggers</li> <li>Jenkins automatically creates jobs for each branch</li> </ol>"},{"location":"workflows/ci-cd-jenkins/#ai-assisted-code-review","title":"AI-Assisted Code Review","text":""},{"location":"workflows/ci-cd-jenkins/#automated-review-with-claude-cli","title":"Automated Review with Claude CLI","text":"<pre><code>pipeline {\n    agent {\n        docker {\n            image 'ghcr.io/jinalshah/devops/images/all-devops:1.0.abc1234'\n        }\n    }\n\n    environment {\n        CLAUDE_API_KEY = credentials('claude-api-key')\n    }\n\n    stages {\n        stage('AI Code Review') {\n            when {\n                changeRequest()  // Only on pull requests\n            }\n            steps {\n                script {\n                    // Get changed files\n                    sh 'git diff origin/main...HEAD -- terraform/ &gt; changes.diff'\n\n                    // Setup Claude CLI\n                    sh '''\n                        mkdir -p ~/.claude\n                        echo \"${CLAUDE_API_KEY}\" &gt; ~/.claude/config.json\n                    '''\n\n                    // Review with Claude\n                    sh '''\n                        claude \"Review this Terraform code for security issues and best practices\" \\\n                            --file changes.diff \\\n                            &gt; review-output.md\n                    '''\n\n                    // Archive review\n                    archiveArtifacts artifacts: 'review-output.md'\n\n                    // Post as comment (if using GitHub)\n                    sh '''\n                        curl -X POST \\\n                            -H \"Authorization: token ${GITHUB_TOKEN}\" \\\n                            -d \"{\\\\\"body\\\\\": \\\\\"$(cat review-output.md)\\\\\"}\" \\\n                            https://api.github.com/repos/owner/repo/issues/${CHANGE_ID}/comments\n                    '''\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"workflows/ci-cd-jenkins/#best-practices","title":"Best Practices","text":"<p>Performance Optimisation</p> <ol> <li>Reuse Docker agents: Use <code>reuseNode true</code> to avoid creating new containers</li> <li>Cache Docker images: Configure Docker to cache pulled images</li> <li>Use shared libraries: Avoid duplicating pipeline code</li> <li>Parallel stages: Run independent stages in parallel</li> <li>Workspace cleanup: Use <code>cleanWs()</code> to free disk space</li> </ol> <p>Security Best Practices</p> <ol> <li>Use Jenkins Credentials: Store secrets in Jenkins credential store</li> <li>Limit credential scope: Use folder-level credentials when possible</li> <li>Audit credential usage: Review credential access logs regularly</li> <li>Use approval gates: Add <code>input</code> steps for production deployments</li> <li>Mask sensitive output: Use <code>wrap([$class: 'MaskPasswordsBuildWrapper'])</code></li> </ol> <p>Common Pitfalls</p> <ul> <li>\u274c Hardcoding credentials: Always use Jenkins credentials</li> <li>\u274c No workspace cleanup: Can fill up disk space</li> <li>\u274c Using <code>latest</code> tag: Non-reproducible builds</li> <li>\u274c No error handling: Use try/catch in scripted pipelines</li> </ul>"},{"location":"workflows/ci-cd-jenkins/#credentials-management","title":"Credentials Management","text":""},{"location":"workflows/ci-cd-jenkins/#storing-credentials","title":"Storing Credentials","text":"<p>Via Jenkins UI:</p> <ol> <li>Navigate to: <code>Manage Jenkins \u2192 Manage Credentials</code></li> <li>Add credential:</li> <li>Secret text: For API keys, tokens</li> <li>Secret file: For service account keys</li> <li>Username with password: For cloud credentials</li> </ol> <p>Using credentials in pipeline:</p> <pre><code>withCredentials([\n    string(credentialsId: 'aws-access-key', variable: 'AWS_ACCESS_KEY_ID'),\n    string(credentialsId: 'aws-secret-key', variable: 'AWS_SECRET_ACCESS_KEY')\n]) {\n    sh 'terraform apply'\n}\n</code></pre>"},{"location":"workflows/ci-cd-jenkins/#troubleshooting","title":"Troubleshooting","text":"Docker agent fails to start <p>Problem: Jenkins can't start Docker agent</p> <p>Solutions: 1. Verify Jenkins has Docker permissions:    </p><pre><code>sudo usermod -aG docker jenkins\nsudo systemctl restart jenkins\n</code></pre> 2. Check Docker daemon is running:    <pre><code>sudo systemctl status docker\n</code></pre><p></p> Credentials not available in container <p>Problem: Environment variables not accessible inside Docker container</p> <p>Solution: Use <code>withCredentials</code> block inside Docker agent: </p><pre><code>docker.image('...').inside() {\n    withCredentials([...]) {\n        sh 'terraform apply'\n    }\n}\n</code></pre><p></p> Workspace permissions issues <p>Problem: Permission denied errors in workspace</p> <p>Solution: Run container with correct user: </p><pre><code>agent {\n    docker {\n        image '...'\n        args '-u root'  // Run as root if needed\n    }\n}\n</code></pre><p></p>"},{"location":"workflows/ci-cd-jenkins/#example-repository-structure","title":"Example Repository Structure","text":"<pre><code>.\n\u251c\u2500\u2500 Jenkinsfile                    # Main pipeline\n\u251c\u2500\u2500 Jenkinsfile.security           # Security scan pipeline\n\u251c\u2500\u2500 vars/\n\u2502   \u251c\u2500\u2500 terraformDeploy.groovy     # Shared library\n\u2502   \u2514\u2500\u2500 helmDeploy.groovy          # Shared library\n\u251c\u2500\u2500 terraform/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u251c\u2500\u2500 staging/\n\u2502   \u2514\u2500\u2500 production/\n\u251c\u2500\u2500 ansible/\n\u2502   \u2514\u2500\u2500 playbooks/\n\u2514\u2500\u2500 charts/\n    \u2514\u2500\u2500 myapp/\n</code></pre>"},{"location":"workflows/ci-cd-jenkins/#next-steps","title":"Next Steps","text":"<ul> <li>GitHub Actions Integration - GitHub Actions examples</li> <li>GitLab CI Integration - GitLab CI examples</li> <li>CircleCI Integration - CircleCI config examples</li> <li>AI-Assisted DevOps - AI workflow automation</li> <li>Multi-Tool Patterns - Combining multiple tools</li> </ul>"},{"location":"workflows/multi-tool-patterns/","title":"Multi-Tool Workflow Patterns","text":""},{"location":"workflows/multi-tool-patterns/#multi-tool-workflow-patterns","title":"Multi-Tool Workflow Patterns","text":"<p>Learn how to combine multiple DevOps tools for powerful, automated workflows.</p>"},{"location":"workflows/multi-tool-patterns/#pattern-1-terraform-helm-ansible","title":"Pattern 1: Terraform \u2192 Helm \u2192 Ansible","text":"<p>Deploy infrastructure, then Kubernetes apps, then configure VMs - all in sequence.</p>"},{"location":"workflows/multi-tool-patterns/#workflow-diagram","title":"Workflow Diagram","text":"<pre><code>sequenceDiagram\n    participant Dev as Developer\n    participant CI as CI Pipeline\n    participant TF as Terraform\n    participant K8s as Kubernetes\n    participant Helm as Helm\n    participant VM as VM Instances\n    participant Ansible as Ansible\n\n    Dev-&gt;&gt;CI: Push code\n    CI-&gt;&gt;TF: terraform apply\n    TF-&gt;&gt;K8s: Create EKS/GKE cluster\n    TF-&gt;&gt;VM: Provision EC2/GCE instances\n\n    TF--&gt;&gt;CI: Infrastructure ready\n\n    CI-&gt;&gt;Helm: helm install\n    Helm-&gt;&gt;K8s: Deploy applications\n\n    CI-&gt;&gt;Ansible: ansible-playbook run\n    Ansible-&gt;&gt;VM: Configure instances\n\n    Ansible--&gt;&gt;CI: Deployment complete\n    CI--&gt;&gt;Dev: Success notification</code></pre>"},{"location":"workflows/multi-tool-patterns/#complete-example","title":"Complete Example","text":"<pre><code>#!/bin/bash\nset -e\n\necho \"\ud83d\ude80 Starting full-stack deployment...\"\n\n# Step 1: Initialize and apply Terraform\necho \"\ud83d\udce6 Provisioning infrastructure with Terraform...\"\ncd terraform/\nterraform init\nterraform plan -out=plan.tfplan\nterraform apply plan.tfplan\n\n# Export cluster config for kubectl\nexport KUBECONFIG=$(terraform output -raw kubeconfig_path)\n\n# Step 2: Deploy applications with Helm\necho \"\u2638\ufe0f  Deploying applications to Kubernetes...\"\ncd ../helm/\nhelm dependency update ./my-app\nhelm upgrade --install my-app ./my-app \\\n  --namespace production \\\n  --create-namespace \\\n  --values values-prod.yaml \\\n  --wait \\\n  --timeout 10m\n\n# Step 3: Configure VMs with Ansible\necho \"\u2699\ufe0f  Configuring VM instances with Ansible...\"\ncd ../ansible/\n# Get inventory from Terraform outputs\nterraform -chdir=../terraform output -json vm_ips &gt; inventory.json\n\nansible-playbook -i inventory.json site.yml \\\n  --extra-vars \"environment=production\"\n\necho \"\u2705 Deployment complete!\"\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#docker-run-equivalent","title":"Docker Run Equivalent","text":"<pre><code>docker run --rm -it \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.ssh:/root/.ssh \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  bash deploy.sh\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#use-cases","title":"Use Cases","text":"<ul> <li>\u2705 Full-stack cloud deployment: Infrastructure + apps + configuration</li> <li>\u2705 Disaster recovery: Rebuild entire environment from code</li> <li>\u2705 Multi-environment setup: Deploy to dev/staging/prod sequentially</li> <li>\u2705 Hybrid cloud: Mix cloud-managed K8s with self-managed VMs</li> </ul>"},{"location":"workflows/multi-tool-patterns/#pattern-2-security-first-workflow","title":"Pattern 2: Security-First Workflow","text":"<p>Scan everything before deployment to catch vulnerabilities early.</p>"},{"location":"workflows/multi-tool-patterns/#workflow-diagram_1","title":"Workflow Diagram","text":"<pre><code>flowchart LR\n    CODE[Code Changes] --&gt; SCAN1[Trivy:&lt;br/&gt;Scan Dockerfile]\n    SCAN1 --&gt; BUILD[Build Image]\n    BUILD --&gt; SCAN2[Trivy:&lt;br/&gt;Scan Built Image]\n    SCAN2 --&gt; TFLINT[TFLint:&lt;br/&gt;Validate IaC]\n    TFLINT --&gt; ALINT[ansible-lint:&lt;br/&gt;Validate Playbooks]\n    ALINT --&gt; PLAN[Terraform Plan]\n    PLAN --&gt; REVIEW[AI CLI:&lt;br/&gt;Code Review]\n    REVIEW --&gt; APPROVE{Manual&lt;br/&gt;Approval?}\n    APPROVE --&gt;|Yes| DEPLOY[Deploy]\n    APPROVE --&gt;|No| REJECT[Reject]\n\n    style SCAN1 fill:#E74C3C,color:#fff\n    style SCAN2 fill:#E74C3C,color:#fff\n    style DEPLOY fill:#48C774,color:#fff</code></pre>"},{"location":"workflows/multi-tool-patterns/#complete-example_1","title":"Complete Example","text":"<pre><code>#!/bin/bash\nset -e\n\nEXIT_CODE=0\n\necho \"\ud83d\udd12 Starting security validation pipeline...\"\n\n# Step 1: Scan Dockerfile\necho \"\ud83d\udd0d Scanning Dockerfile...\"\ntrivy config Dockerfile || EXIT_CODE=$?\n\n# Step 2: Scan filesystem for secrets\necho \"\ud83d\udd0d Scanning for secrets...\"\ntrivy fs . --scanners secret || EXIT_CODE=$?\n\n# Step 3: Lint Terraform\necho \"\ud83d\udccb Linting Terraform code...\"\ncd terraform/\ntflint --recursive || EXIT_CODE=$?\n\n# Step 4: Validate Terraform\necho \"\u2705 Validating Terraform...\"\nterraform init -backend=false\nterraform validate || EXIT_CODE=$?\n\n# Step 5: Lint Ansible playbooks\necho \"\ud83d\udccb Linting Ansible playbooks...\"\ncd ../ansible/\nansible-lint *.yml || EXIT_CODE=$?\n\n# Step 6: AI code review (optional but recommended)\necho \"\ud83e\udd16 AI code review...\"\nif [ -f ~/.claude/config.json ]; then\n  cd ../terraform/\n  claude \"Review this Terraform code for security issues and best practices\" \\\n    --file main.tf \\\n    &gt; ../reports/ai-review.txt || EXIT_CODE=$?\n  echo \"AI review saved to reports/ai-review.txt\"\nfi\n\n# Final result\nif [ $EXIT_CODE -eq 0 ]; then\n  echo \"\u2705 All security checks passed!\"\nelse\n  echo \"\u274c Security checks failed with exit code: $EXIT_CODE\"\n  exit $EXIT_CODE\nfi\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#cicd-integration","title":"CI/CD Integration","text":"GitHub ActionsGitLab CI <pre><code>name: Security Validation\n\non: [push, pull_request]\n\njobs:\n  security-scan:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:latest\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Trivy Filesystem Scan\n        run: trivy fs . --exit-code 1 --severity CRITICAL,HIGH\n\n      - name: Trivy Config Scan\n        run: trivy config . --exit-code 1\n\n      - name: TFLint\n        run: |\n          cd terraform\n          tflint --recursive\n\n      - name: Ansible Lint\n        run: |\n          cd ansible\n          ansible-lint\n\n      - name: Terraform Validate\n        run: |\n          cd terraform\n          terraform init -backend=false\n          terraform validate\n</code></pre> <pre><code>stages:\n  - security\n\nsecurity:scan:\n  stage: security\n  image: registry.gitlab.com/jinal-shah/devops/images/all-devops:latest\n  script:\n    - trivy fs . --exit-code 1 --severity CRITICAL,HIGH\n    - trivy config . --exit-code 1\n    - cd terraform &amp;&amp; tflint --recursive\n    - cd ../ansible &amp;&amp; ansible-lint\n    - cd ../terraform &amp;&amp; terraform init -backend=false &amp;&amp; terraform validate\n  allow_failure: false\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#use-cases_1","title":"Use Cases","text":"<ul> <li>\u2705 Pre-deployment validation: Catch issues before production</li> <li>\u2705 Pull request checks: Automated security gates</li> <li>\u2705 Compliance auditing: Evidence of security scanning</li> <li>\u2705 Shift-left security: Find vulnerabilities early</li> </ul>"},{"location":"workflows/multi-tool-patterns/#pattern-3-pre-commit-hooks-for-infrastructure-code","title":"Pattern 3: Pre-Commit Hooks for Infrastructure Code","text":"<p>Enforce code quality standards before commits reach the repository.</p>"},{"location":"workflows/multi-tool-patterns/#setup","title":"Setup","text":"<pre><code># Install pre-commit hooks\ncd your-project/\ncat &gt; .pre-commit-config.yaml &lt;&lt;'EOF'\nrepos:\n  - repo: https://github.com/antonbabenko/pre-commit-terraform\n    rev: v1.83.5\n    hooks:\n      - id: terraform_fmt\n      - id: terraform_validate\n      - id: terraform_tflint\n      - id: terraform_docs\n\n  - repo: https://github.com/ansible/ansible-lint\n    rev: v6.20.0\n    hooks:\n      - id: ansible-lint\n\n  - repo: https://github.com/pre-commit/pre-commit-hooks\n    rev: v4.5.0\n    hooks:\n      - id: trailing-whitespace\n      - id: end-of-file-fixer\n      - id: check-yaml\n      - id: check-added-large-files\n      - id: detect-private-key\nEOF\n\n# Install hooks\ndocker run --rm -it \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  pre-commit install\n\n# Run on all files\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  pre-commit run --all-files\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#workflow","title":"Workflow","text":"<pre><code>sequenceDiagram\n    participant Dev as Developer\n    participant Git as Git (pre-commit)\n    participant Hooks as Pre-commit Hooks\n    participant Remote as Remote Repo\n\n    Dev-&gt;&gt;Git: git commit -m \"msg\"\n    Git-&gt;&gt;Hooks: Trigger hooks\n\n    Hooks-&gt;&gt;Hooks: terraform fmt\n    Hooks-&gt;&gt;Hooks: terraform validate\n    Hooks-&gt;&gt;Hooks: tflint\n    Hooks-&gt;&gt;Hooks: ansible-lint\n    Hooks-&gt;&gt;Hooks: check secrets\n\n    alt Checks Pass\n        Hooks--&gt;&gt;Git: \u2705 Success\n        Git-&gt;&gt;Remote: Push allowed\n        Remote--&gt;&gt;Dev: Commit successful\n    else Checks Fail\n        Hooks--&gt;&gt;Git: \u274c Failure\n        Git--&gt;&gt;Dev: Fix issues and retry\n    end</code></pre>"},{"location":"workflows/multi-tool-patterns/#use-cases_2","title":"Use Cases","text":"<ul> <li>\u2705 Prevent bad commits: Stop issues at development time</li> <li>\u2705 Enforce formatting: Consistent code style</li> <li>\u2705 Catch secrets: Prevent credential leaks</li> <li>\u2705 Documentation: Auto-generate terraform-docs</li> </ul>"},{"location":"workflows/multi-tool-patterns/#pattern-4-terragrunt-multi-account-aws-workflow","title":"Pattern 4: Terragrunt Multi-Account AWS Workflow","text":"<p>Manage infrastructure across multiple AWS accounts with DRY configurations.</p>"},{"location":"workflows/multi-tool-patterns/#directory-structure","title":"Directory Structure","text":"<pre><code>infrastructure/\n\u251c\u2500\u2500 terragrunt.hcl                 # Root config\n\u251c\u2500\u2500 _envcommon/                    # Shared configurations\n\u2502   \u251c\u2500\u2500 vpc.hcl\n\u2502   \u251c\u2500\u2500 eks.hcl\n\u2502   \u2514\u2500\u2500 rds.hcl\n\u251c\u2500\u2500 dev/\n\u2502   \u251c\u2500\u2500 account.hcl                # AWS account: 111111111111\n\u2502   \u251c\u2500\u2500 us-east-1/\n\u2502   \u2502   \u251c\u2500\u2500 region.hcl\n\u2502   \u2502   \u251c\u2500\u2500 vpc/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 terragrunt.hcl\n\u2502   \u2502   \u2514\u2500\u2500 eks/\n\u2502   \u2502       \u2514\u2500\u2500 terragrunt.hcl\n\u2502   \u2514\u2500\u2500 us-west-2/\n\u2502       \u2514\u2500\u2500 vpc/\n\u2502           \u2514\u2500\u2500 terragrunt.hcl\n\u251c\u2500\u2500 staging/\n\u2502   \u251c\u2500\u2500 account.hcl                # AWS account: 222222222222\n\u2502   \u2514\u2500\u2500 us-east-1/\n\u2502       \u251c\u2500\u2500 vpc/terragrunt.hcl\n\u2502       \u2514\u2500\u2500 eks/terragrunt.hcl\n\u2514\u2500\u2500 prod/\n    \u251c\u2500\u2500 account.hcl                # AWS account: 333333333333\n    \u2514\u2500\u2500 us-east-1/\n        \u251c\u2500\u2500 vpc/terragrunt.hcl\n        \u2514\u2500\u2500 eks/terragrunt.hcl\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#commands","title":"Commands","text":"<pre><code># Run all for specific environment\ndocker run --rm -it \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace/infrastructure/dev/us-east-1 \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terragrunt run-all plan\n\n# Apply to specific component\ndocker run --rm -it \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace/infrastructure/prod/us-east-1/vpc \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terragrunt apply\n\n# Plan everything across all environments (dry-run)\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace/infrastructure \\\n  ghcr.io/jinalshah/devops/images/aws-devops:latest \\\n  terragrunt run-all plan --terragrunt-non-interactive\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#use-cases_3","title":"Use Cases","text":"<ul> <li>\u2705 Multi-account AWS: Separate dev/staging/prod accounts</li> <li>\u2705 DRY configurations: Reuse common patterns</li> <li>\u2705 Multi-region: Deploy to multiple regions consistently</li> <li>\u2705 State management: Automatic remote state configuration</li> </ul>"},{"location":"workflows/multi-tool-patterns/#pattern-5-kubernetes-deployment-with-validation","title":"Pattern 5: Kubernetes Deployment with Validation","text":"<p>Deploy to Kubernetes with pre-deployment validation and post-deployment verification.</p>"},{"location":"workflows/multi-tool-patterns/#workflow_1","title":"Workflow","text":"<pre><code>#!/bin/bash\nset -e\n\nNAMESPACE=\"production\"\nRELEASE=\"my-app\"\nCHART=\"./charts/my-app\"\n\necho \"\u2638\ufe0f  Starting Kubernetes deployment...\"\n\n# Step 1: Validate Helm chart\necho \"\ud83d\udccb Validating Helm chart...\"\nhelm lint $CHART\nhelm template $RELEASE $CHART --namespace $NAMESPACE &gt; /tmp/rendered.yaml\n\n# Step 2: Validate rendered YAML\necho \"\u2705 Validating Kubernetes manifests...\"\nkubectl apply --dry-run=client -f /tmp/rendered.yaml\nkubectl apply --dry-run=server -f /tmp/rendered.yaml\n\n# Step 3: Check cluster connectivity\necho \"\ud83d\udd0c Checking cluster connectivity...\"\nkubectl cluster-info\nkubectl get nodes\n\n# Step 4: Deploy with Helm\necho \"\ud83d\ude80 Deploying to $NAMESPACE...\"\nhelm upgrade --install $RELEASE $CHART \\\n  --namespace $NAMESPACE \\\n  --create-namespace \\\n  --values values-prod.yaml \\\n  --wait \\\n  --timeout 10m \\\n  --atomic\n\n# Step 5: Verify deployment\necho \"\ud83d\udd0d Verifying deployment...\"\nkubectl rollout status deployment/$RELEASE -n $NAMESPACE\nkubectl get pods -n $NAMESPACE -l app=$RELEASE\n\n# Step 6: Run smoke tests\necho \"\ud83e\uddea Running smoke tests...\"\nPOD=$(kubectl get pod -n $NAMESPACE -l app=$RELEASE -o jsonpath='{.items[0].metadata.name}')\nkubectl exec -n $NAMESPACE $POD -- curl -f http://localhost:8080/health\n\necho \"\u2705 Deployment successful!\"\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#docker-run","title":"Docker Run","text":"<pre><code>docker run --rm -it \\\n  -v $PWD:/workspace \\\n  -v ~/.kube:/root/.kube \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  bash deploy-k8s.sh\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#use-cases_4","title":"Use Cases","text":"<ul> <li>\u2705 Safe deployments: Validate before deploying</li> <li>\u2705 Atomic rollbacks: Automatic rollback on failure</li> <li>\u2705 Smoke testing: Verify health after deployment</li> <li>\u2705 Blue-green deployments: Zero-downtime updates</li> </ul>"},{"location":"workflows/multi-tool-patterns/#pattern-6-infrastructure-testing-with-terratest","title":"Pattern 6: Infrastructure Testing with Terratest","text":"<p>Test Terraform modules before deploying to production.</p>"},{"location":"workflows/multi-tool-patterns/#test-script","title":"Test Script","text":"<pre><code>#!/bin/bash\nset -e\n\necho \"\ud83e\uddea Testing Terraform modules...\"\n\n# Step 1: Run Go-based Terratest (if available)\nif [ -d \"test/\" ]; then\n  cd test/\n  go test -v -timeout 30m\n  cd ..\nfi\n\n# Step 2: Alternative: Simple validation test\necho \"\ud83d\udccb Running validation tests...\"\n\n# Initialize in test directory\ncd examples/complete/\nterraform init\n\n# Validate syntax\nterraform validate\n\n# Plan (don't apply)\nterraform plan -out=test.tfplan\n\n# Check plan output\nterraform show -json test.tfplan | jq '.resource_changes | length'\n\n# Cleanup\nrm test.tfplan\n\necho \"\u2705 Tests passed!\"\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#use-cases_5","title":"Use Cases","text":"<ul> <li>\u2705 Module testing: Validate reusable Terraform modules</li> <li>\u2705 Integration testing: Test complete infrastructure stacks</li> <li>\u2705 Regression prevention: Catch breaking changes</li> <li>\u2705 CI/CD validation: Automated testing in pipelines</li> </ul>"},{"location":"workflows/multi-tool-patterns/#pattern-7-gitops-with-ai-code-review","title":"Pattern 7: GitOps with AI Code Review","text":"<p>Automate infrastructure changes with AI-powered review gates.</p>"},{"location":"workflows/multi-tool-patterns/#workflow_2","title":"Workflow","text":"<pre><code>sequenceDiagram\n    participant Dev as Developer\n    participant PR as Pull Request\n    participant AI as Claude CLI\n    participant CI as CI Pipeline\n    participant Approve as Approver\n    participant Deploy as Deployment\n\n    Dev-&gt;&gt;PR: Create PR with IaC changes\n    PR-&gt;&gt;AI: Trigger AI review\n    AI-&gt;&gt;AI: Analyze Terraform/Ansible code\n    AI--&gt;&gt;PR: Post review comments\n\n    PR-&gt;&gt;CI: Run validation\n    CI-&gt;&gt;CI: terraform validate\n    CI-&gt;&gt;CI: tflint\n    CI-&gt;&gt;CI: trivy scan\n    CI--&gt;&gt;PR: Post CI results\n\n    Approve-&gt;&gt;PR: Review AI + CI feedback\n    Approve-&gt;&gt;PR: Approve if acceptable\n\n    PR-&gt;&gt;Deploy: Merge to main\n    Deploy-&gt;&gt;Deploy: terraform apply\n    Deploy--&gt;&gt;Dev: Deployment complete</code></pre>"},{"location":"workflows/multi-tool-patterns/#github-actions-implementation","title":"GitHub Actions Implementation","text":"<pre><code>name: AI Code Review\n\non:\n  pull_request:\n    paths:\n      - 'terraform/**'\n      - 'ansible/**'\n\njobs:\n  ai-review:\n    runs-on: ubuntu-latest\n    container:\n      image: ghcr.io/jinalshah/devops/images/all-devops:latest\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: AI Code Review with Claude\n        env:\n          CLAUDE_API_KEY: ${{ secrets.CLAUDE_API_KEY }}\n        run: |\n          # Review Terraform files\n          for file in $(git diff --name-only origin/main...HEAD | grep '\\.tf$'); do\n            echo \"Reviewing $file...\"\n            claude \"Review this Terraform code for security, best practices, and potential issues\" \\\n              --file \"$file\" \\\n              &gt;&gt; ai-review-report.md\n          done\n\n          # Review Ansible files\n          for file in $(git diff --name-only origin/main...HEAD | grep '\\.yml$'); do\n            echo \"Reviewing $file...\"\n            claude \"Review this Ansible playbook for security and best practices\" \\\n              --file \"$file\" \\\n              &gt;&gt; ai-review-report.md\n          done\n\n      - name: Post AI Review\n        uses: actions/github-script@v7\n        with:\n          script: |\n            const fs = require('fs');\n            const review = fs.readFileSync('ai-review-report.md', 'utf8');\n            github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: `## \ud83e\udd16 AI Code Review\\n\\n${review}`\n            });\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#use-cases_6","title":"Use Cases","text":"<ul> <li>\u2705 Automated reviews: AI reviews every PR</li> <li>\u2705 Security suggestions: Catch security issues early</li> <li>\u2705 Best practices: Enforce standards automatically</li> <li>\u2705 Knowledge sharing: AI explains complex changes</li> </ul>"},{"location":"workflows/multi-tool-patterns/#combining-multiple-patterns","title":"Combining Multiple Patterns","text":""},{"location":"workflows/multi-tool-patterns/#ultimate-devops-pipeline","title":"Ultimate DevOps Pipeline","text":"<p>Combine all patterns for a comprehensive workflow:</p> <ol> <li>Pre-commit hooks \u2192 Catch issues before commit</li> <li>AI code review \u2192 Automated PR feedback</li> <li>Security scanning \u2192 Trivy + TFLint + ansible-lint</li> <li>Infrastructure testing \u2192 Validate Terraform modules</li> <li>Multi-tool deployment \u2192 Terraform + Helm + Ansible</li> <li>Post-deployment verification \u2192 Smoke tests and monitoring</li> </ol> <pre><code># Complete pipeline in one container\ndocker run --rm -it \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -v ~/.kube:/root/.kube \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  bash -c \"\n    # Security scan\n    trivy fs . --exit-code 1 --severity HIGH,CRITICAL &amp;&amp;\n    tflint --recursive &amp;&amp;\n\n    # Deploy infrastructure\n    cd terraform &amp;&amp; terraform init &amp;&amp; terraform apply -auto-approve &amp;&amp;\n\n    # Deploy apps\n    cd ../helm &amp;&amp; helm upgrade --install myapp ./myapp --wait &amp;&amp;\n\n    # Configure VMs\n    cd ../ansible &amp;&amp; ansible-playbook site.yml\n  \"\n</code></pre>"},{"location":"workflows/multi-tool-patterns/#next-steps","title":"Next Steps","text":"<ul> <li>AI-Assisted DevOps Guide - Deep dive into AI CLI usage</li> <li>GitHub Actions Examples - Complete CI/CD configurations</li> <li>Terraform Workflows - Advanced Terraform patterns</li> <li>Tool Basics - Individual tool references</li> </ul>"},{"location":"workflows/terraform-workflows/","title":"Terraform Workflows &amp; Patterns","text":""},{"location":"workflows/terraform-workflows/#terraform-workflows-patterns","title":"Terraform Workflows &amp; Patterns","text":"<p>Advanced Terraform workflow patterns using DevOps Images for infrastructure as code management, state handling, and multi-environment deployments.</p>"},{"location":"workflows/terraform-workflows/#basic-terraform-workflow","title":"Basic Terraform Workflow","text":""},{"location":"workflows/terraform-workflows/#standard-development-cycle","title":"Standard Development Cycle","text":"<pre><code># Interactive container with project mounted\ndocker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Inside container\nterraform init\nterraform validate\nterraform plan\nterraform apply\n</code></pre>"},{"location":"workflows/terraform-workflows/#multi-environment-management","title":"Multi-Environment Management","text":""},{"location":"workflows/terraform-workflows/#directory-structure","title":"Directory Structure","text":"<pre><code>terraform/\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u2514\u2500\u2500 terraform.tfvars\n\u2502   \u251c\u2500\u2500 staging/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u2514\u2500\u2500 terraform.tfvars\n\u2502   \u2514\u2500\u2500 production/\n\u2502       \u251c\u2500\u2500 main.tf\n\u2502       \u251c\u2500\u2500 variables.tf\n\u2502       \u2514\u2500\u2500 terraform.tfvars\n\u2514\u2500\u2500 modules/\n    \u251c\u2500\u2500 vpc/\n    \u251c\u2500\u2500 eks/\n    \u2514\u2500\u2500 rds/\n</code></pre>"},{"location":"workflows/terraform-workflows/#deploy-all-environments","title":"Deploy All Environments","text":"<pre><code>#!/bin/bash\n# deploy-all.sh\n\nENVIRONMENTS=(\"dev\" \"staging\" \"production\")\n\nfor ENV in \"${ENVIRONMENTS[@]}\"; do\n  echo \"Deploying to $ENV...\"\n\n  docker run --rm \\\n    -v $PWD:/workspace \\\n    -v ~/.aws:/root/.aws \\\n    -w /workspace/environments/$ENV \\\n    ghcr.io/jinalshah/devops/images/all-devops:latest \\\n    sh -c \"\n      terraform init\n      terraform plan -out=tfplan\n      terraform apply tfplan\n    \"\ndone\n</code></pre>"},{"location":"workflows/terraform-workflows/#terragrunt-patterns","title":"Terragrunt Patterns","text":""},{"location":"workflows/terraform-workflows/#dry-configuration-with-terragrunt","title":"DRY Configuration with Terragrunt","text":"<p>Project structure:</p> <pre><code>infrastructure/\n\u251c\u2500\u2500 terragrunt.hcl          # Root config\n\u251c\u2500\u2500 dev/\n\u2502   \u2514\u2500\u2500 terragrunt.hcl\n\u251c\u2500\u2500 staging/\n\u2502   \u2514\u2500\u2500 terragrunt.hcl\n\u2514\u2500\u2500 production/\n    \u2514\u2500\u2500 terragrunt.hcl\n</code></pre> <p>Root <code>terragrunt.hcl</code>:</p> <pre><code>remote_state {\n  backend = \"s3\"\n  config = {\n    bucket         = \"my-terraform-state-${get_aws_account_id()}\"\n    key            = \"${path_relative_to_include()}/terraform.tfstate\"\n    region         = \"us-east-1\"\n    encrypt        = true\n    dynamodb_table = \"terraform-locks\"\n  }\n}\n</code></pre> <p>Deploy with Terragrunt:</p> <pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    cd dev\n    terragrunt run-all plan\n    terragrunt run-all apply\n  \"\n</code></pre>"},{"location":"workflows/terraform-workflows/#state-management","title":"State Management","text":""},{"location":"workflows/terraform-workflows/#remote-state-with-s3-backend","title":"Remote State with S3 Backend","text":"<p>backend.tf:</p> <pre><code>terraform {\n  backend \"s3\" {\n    bucket         = \"my-terraform-state\"\n    key            = \"production/terraform.tfstate\"\n    region         = \"us-east-1\"\n    encrypt        = true\n    dynamodb_table = \"terraform-locks\"\n  }\n}\n</code></pre>"},{"location":"workflows/terraform-workflows/#state-operations","title":"State Operations","text":"<pre><code># View current state\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform show\n\n# List resources in state\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform state list\n\n# Move resource in state\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform state mv aws_instance.old aws_instance.new\n</code></pre>"},{"location":"workflows/terraform-workflows/#version-management-with-tfswitch","title":"Version Management with tfswitch","text":""},{"location":"workflows/terraform-workflows/#switch-terraform-versions","title":"Switch Terraform Versions","text":"<p>The DevOps Image includes <code>tfswitch</code> for managing multiple Terraform versions:</p> <pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    # Switch to specific version\n    tfswitch 1.6.0\n\n    # Verify version\n    terraform version\n\n    # Run Terraform\n    terraform init\n    terraform plan\n  \"\n</code></pre> <p>Using <code>.terraform-version</code> file:</p> <pre><code># Create version file\necho \"1.6.0\" &gt; .terraform-version\n\n# tfswitch automatically uses version from file\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    tfswitch  # Reads .terraform-version\n    terraform version\n  \"\n</code></pre>"},{"location":"workflows/terraform-workflows/#testing-infrastructure","title":"Testing Infrastructure","text":""},{"location":"workflows/terraform-workflows/#validation-and-linting","title":"Validation and Linting","text":"<pre><code>#!/bin/bash\n# validate.sh - Comprehensive Terraform validation\n\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    # Format check\n    echo '==&gt; Checking Terraform formatting...'\n    terraform fmt -check -recursive\n\n    # Validate configuration\n    echo '==&gt; Validating Terraform configuration...'\n    terraform init -backend=false\n    terraform validate\n\n    # Run TFLint\n    echo '==&gt; Running TFLint...'\n    tflint --init\n    tflint --recursive\n\n    # Security scan with Trivy\n    echo '==&gt; Scanning for security issues...'\n    trivy config . --severity HIGH,CRITICAL\n  \"\n</code></pre>"},{"location":"workflows/terraform-workflows/#pre-commit-hooks","title":"Pre-commit Hooks","text":"<p><code>.pre-commit-config.yaml</code>:</p> <pre><code>repos:\n  - repo: local\n    hooks:\n      - id: terraform-fmt\n        name: Terraform Format\n        entry: docker run --rm -v $PWD:/workspace -w /workspace ghcr.io/jinalshah/devops/images/all-devops:latest terraform fmt -check -recursive\n        language: system\n        files: \\.tf$\n        pass_filenames: false\n\n      - id: terraform-validate\n        name: Terraform Validate\n        entry: docker run --rm -v $PWD:/workspace -w /workspace ghcr.io/jinalshah/devops/images/all-devops:latest sh -c \"terraform init -backend=false &amp;&amp; terraform validate\"\n        language: system\n        files: \\.tf$\n        pass_filenames: false\n\n      - id: tflint\n        name: TFLint\n        entry: docker run --rm -v $PWD:/workspace -w /workspace ghcr.io/jinalshah/devops/images/all-devops:latest sh -c \"tflint --init &amp;&amp; tflint\"\n        language: system\n        files: \\.tf$\n        pass_filenames: false\n</code></pre> <p>Install and run:</p> <pre><code># Install pre-commit\npip install pre-commit\n\n# Install hooks\npre-commit install\n\n# Run manually\npre-commit run --all-files\n</code></pre>"},{"location":"workflows/terraform-workflows/#module-development","title":"Module Development","text":""},{"location":"workflows/terraform-workflows/#testing-terraform-modules","title":"Testing Terraform Modules","text":"<p>Directory structure:</p> <pre><code>terraform-aws-vpc/\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 variables.tf\n\u251c\u2500\u2500 outputs.tf\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 examples/\n    \u251c\u2500\u2500 basic/\n    \u2502   \u251c\u2500\u2500 main.tf\n    \u2502   \u2514\u2500\u2500 outputs.tf\n    \u2514\u2500\u2500 advanced/\n        \u251c\u2500\u2500 main.tf\n        \u2514\u2500\u2500 outputs.tf\n</code></pre> <p>Test module example:</p> <pre><code>#!/bin/bash\n# test-module.sh\n\ncd examples/basic\n\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    # Validate example\n    terraform init\n    terraform validate\n    terraform plan\n\n    # Deploy for testing\n    terraform apply -auto-approve\n\n    # Run tests (if using Terratest)\n    # go test -v -timeout 30m\n\n    # Cleanup\n    terraform destroy -auto-approve\n  \"\n</code></pre>"},{"location":"workflows/terraform-workflows/#cost-estimation","title":"Cost Estimation","text":""},{"location":"workflows/terraform-workflows/#estimate-infrastructure-costs","title":"Estimate Infrastructure Costs","text":"<pre><code># Using Infracost (if installed in custom image)\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    terraform init\n    terraform plan -out=tfplan\n\n    # Generate cost breakdown\n    # infracost breakdown --path tfplan\n  \"\n</code></pre>"},{"location":"workflows/terraform-workflows/#import-existing-resources","title":"Import Existing Resources","text":""},{"location":"workflows/terraform-workflows/#import-aws-resources","title":"Import AWS Resources","text":"<pre><code># Import existing EC2 instance\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform import aws_instance.example i-1234567890abcdef0\n\n# Import VPC\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform import aws_vpc.main vpc-12345678\n</code></pre>"},{"location":"workflows/terraform-workflows/#workspace-management","title":"Workspace Management","text":""},{"location":"workflows/terraform-workflows/#using-terraform-workspaces","title":"Using Terraform Workspaces","text":"<pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Inside container\nterraform workspace list\nterraform workspace new dev\nterraform workspace new staging\nterraform workspace new production\n\n# Switch workspace\nterraform workspace select dev\nterraform plan\n\nterraform workspace select production\nterraform plan\n</code></pre>"},{"location":"workflows/terraform-workflows/#drift-detection","title":"Drift Detection","text":""},{"location":"workflows/terraform-workflows/#detect-configuration-drift","title":"Detect Configuration Drift","text":"<pre><code>#!/bin/bash\n# detect-drift.sh\n\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    terraform init\n    terraform plan -detailed-exitcode\n    EXIT_CODE=\\$?\n\n    if [ \\$EXIT_CODE -eq 0 ]; then\n      echo 'No drift detected'\n    elif [ \\$EXIT_CODE -eq 2 ]; then\n      echo 'Drift detected! Run terraform apply to sync.'\n      exit 1\n    else\n      echo 'Error running terraform plan'\n      exit \\$EXIT_CODE\n    fi\n  \"\n</code></pre> <p>Schedule with cron:</p> <pre><code># Run drift detection daily at 9am\n0 9 * * * /path/to/detect-drift.sh\n</code></pre>"},{"location":"workflows/terraform-workflows/#ai-assisted-terraform","title":"AI-Assisted Terraform","text":""},{"location":"workflows/terraform-workflows/#code-generation-with-claude","title":"Code Generation with Claude","text":"<pre><code>docker run -it --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest\n\n# Inside container\nclaude \"Generate Terraform code to create an AWS VPC with 3 public and 3 private subnets across 3 availability zones\" \\\n  &gt; vpc.tf\n\n# Review generated code\ncat vpc.tf\n\n# Validate\nterraform init\nterraform validate\n</code></pre>"},{"location":"workflows/terraform-workflows/#infrastructure-review","title":"Infrastructure Review","text":"<pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.claude:/root/.claude \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    claude 'Review this Terraform code for security issues, best practices, and cost optimization' \\\n      --file main.tf \\\n      &gt; review-report.md\n\n    cat review-report.md\n  \"\n</code></pre>"},{"location":"workflows/terraform-workflows/#documentation-generation","title":"Documentation Generation","text":""},{"location":"workflows/terraform-workflows/#auto-generate-module-docs","title":"Auto-Generate Module Docs","text":"<pre><code># Using terraform-docs (if installed in custom image)\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  sh -c \"\n    # Generate README.md\n    # terraform-docs markdown table . &gt; README.md\n\n    # Or use Claude to generate docs\n    claude 'Generate comprehensive documentation for this Terraform module' \\\n      --file main.tf \\\n      --file variables.tf \\\n      --file outputs.tf \\\n      &gt; README.md\n  \"\n</code></pre>"},{"location":"workflows/terraform-workflows/#best-practices","title":"Best Practices","text":"<p>State Management</p> <ol> <li>Always use remote state: Use S3, GCS, or Terraform Cloud</li> <li>Enable state locking: Prevent concurrent modifications</li> <li>Encrypt state: Enable encryption at rest</li> <li>Version state files: Use S3 versioning or equivalent</li> <li>Backup state regularly: Automated backups of state files</li> </ol> <p>Code Organisation</p> <ol> <li>Use modules: Reusable, testable components</li> <li>Separate environments: Use workspaces or directories</li> <li>Version pin providers: Ensure reproducible deployments</li> <li>Use variables: Make code configurable</li> <li>Document everything: README, variables descriptions, outputs</li> </ol> <p>Security</p> <ol> <li>Never commit secrets: Use variables, Vault, or parameter stores</li> <li>Scan for vulnerabilities: Use Trivy, Checkov, or tfsec</li> <li>Least privilege: Use minimal IAM permissions</li> <li>Review plans: Always review before apply</li> <li>Audit changes: Track who deploys what</li> </ol> <p>Common Pitfalls</p> <ul> <li>\u274c No state locking: Can lead to corrupted state</li> <li>\u274c Hardcoded values: Makes code inflexible</li> <li>\u274c No validation: Catch errors early with <code>terraform validate</code></li> <li>\u274c Large state files: Break into smaller modules</li> <li>\u274c No version pinning: Can break on provider updates</li> </ul>"},{"location":"workflows/terraform-workflows/#troubleshooting","title":"Troubleshooting","text":"State lock timeout <p>Problem: DynamoDB table locked by another process</p> <p>Solution: Force unlock (use with caution) </p><pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.aws:/root/.aws \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform force-unlock &lt;LOCK_ID&gt;\n</code></pre><p></p> Provider registry unreachable <p>Problem: Cannot download providers</p> <p>Solution: Use provider mirror or cache </p><pre><code># Create provider mirror\nmkdir -p ~/.terraform.d/plugin-cache\n\ndocker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.terraform.d:/root/.terraform.d \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform providers mirror ~/.terraform.d/plugin-cache\n</code></pre><p></p> Module not found <p>Problem: Git-based module cannot be cloned</p> <p>Solution: Mount SSH keys </p><pre><code>docker run --rm \\\n  -v $PWD:/workspace \\\n  -v ~/.ssh:/root/.ssh \\\n  -w /workspace \\\n  ghcr.io/jinalshah/devops/images/all-devops:latest \\\n  terraform init\n</code></pre><p></p>"},{"location":"workflows/terraform-workflows/#advanced-patterns","title":"Advanced Patterns","text":""},{"location":"workflows/terraform-workflows/#blue-green-deployments","title":"Blue-Green Deployments","text":"<pre><code># main.tf\nresource \"aws_instance\" \"blue\" {\n  count         = var.active_environment == \"blue\" ? var.instance_count : 0\n  ami           = var.blue_ami\n  instance_type = var.instance_type\n  tags = {\n    Environment = \"blue\"\n  }\n}\n\nresource \"aws_instance\" \"green\" {\n  count         = var.active_environment == \"green\" ? var.instance_count : 0\n  ami           = var.green_ami\n  instance_type = var.instance_type\n  tags = {\n    Environment = \"green\"\n  }\n}\n</code></pre>"},{"location":"workflows/terraform-workflows/#canary-deployments","title":"Canary Deployments","text":"<pre><code># main.tf\nresource \"aws_instance\" \"stable\" {\n  count         = var.stable_count\n  ami           = var.stable_ami\n  instance_type = var.instance_type\n}\n\nresource \"aws_instance\" \"canary\" {\n  count         = var.canary_count\n  ami           = var.canary_ami\n  instance_type = var.instance_type\n}\n</code></pre>"},{"location":"workflows/terraform-workflows/#next-steps","title":"Next Steps","text":"<ul> <li>Multi-Tool Patterns - Combining Terraform with Ansible, Helm</li> <li>CI/CD Integration - Automate Terraform in CI/CD</li> <li>AI-Assisted DevOps - Use AI for infrastructure code</li> <li>Authentication Guide - Configure cloud credentials</li> </ul>"}]}